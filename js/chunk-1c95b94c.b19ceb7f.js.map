{"version":3,"sources":["webpack:///./src/views/emotion.vue","webpack:///src/views/emotion.vue","webpack:///./src/views/emotion.vue?c1b7","webpack:///./src/views/emotion.vue?0d1b","webpack:///./src/service/decoration.js","webpack:///./src/views/emotion.vue?7275"],"names":["render","_vm","this","_c","_self","staticClass","attrs","tabList","scopedSlots","_u","key","fn","_v","proxy","_l","emotions","item","group_id","class","isUsing","group_name","disabled","isDisabled","hidden","isHidden","on","$event","stopPropagation","handleEmotionClick","imgSrc","_s","loading","handleSave","staticRenderFns","name","props","data","themeTab","emotionList","active","computed","methods","loadDecoration","_this","getDecoration","type","then","res","filter","using","map","val","_emotionList","sort","a","b","aUsing","includes","bUsing","getEmotion","_this2","_emotions","JSON","parse","sessionStorage","getItem","setItem","stringify","e","_group$items","group","find","defaultEmo","items","__imgPath","filename","length","$message","error","push","_this3","setDecoration","success","mounted","components","uc","component","params","$cms","get","post","getDecorationJson","url","__cdn","concat","Date","now","axios","__dataPath","receive","user_id","updateAvatarFrame","put","getHonor","getUserHonors","uid","$next","mute","setHonor","honor_id","cancelHonor","delete","getUserMedals","getMedals"],"mappings":"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","file":"js/chunk-1c95b94c.b19ceb7f.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('uc',{staticClass:\"m-dashboard-emotion m-dashboard-skin\",attrs:{\"icon\":\"el-icon-brush\",\"title\":\"主题装扮\",\"tabList\":_vm.tabList},scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('a',{staticClass:\"u-link el-button el-button--default el-button--mini is-round is-plain\",attrs:{\"href\":\"/vip/mall?category=virtual\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-shopping-cart-2\"}),_vm._v(\" 前往获取装扮\")])]},proxy:true}])},[_c('div',{staticClass:\"u-tips\"},[_c('i',{staticClass:\"el-icon-warning-outline\"}),_vm._v(\"自定义表情包最多只能同时激活五个。 \")]),_c('div',{staticClass:\"u-list\"},_vm._l((_vm.emotions),function(item){return _c('div',{key:item.group_id,staticClass:\"u-item\",class:{\n                'is-using': _vm.isUsing(item.group_name),\n                disabled: _vm.isDisabled(item.group_name),\n                hidden: _vm.isHidden(item.group_name),\n            },on:{\"click\":function($event){$event.stopPropagation();return _vm.handleEmotionClick(item)}}},[_c('img',{staticClass:\"u-img\",attrs:{\"src\":_vm.imgSrc(item.group_name),\"alt\":item.group_name}}),_c('div',{staticClass:\"u-title\"},[_vm._v(_vm._s(item.group_name))])])}),0),_c('div',{staticClass:\"u-actions\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-circle-check\",\"loading\":_vm.loading},on:{\"click\":_vm.handleSave}},[_vm._v(\"保存\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <uc class=\"m-dashboard-emotion m-dashboard-skin\" icon=\"el-icon-brush\" title=\"主题装扮\" :tabList=\"tabList\">\n        <template #header>\n            <a\n                class=\"u-link el-button el-button--default el-button--mini is-round is-plain\"\n                href=\"/vip/mall?category=virtual\"\n                target=\"_blank\"\n                ><i class=\"el-icon-shopping-cart-2\"></i> 前往获取装扮</a\n            >\n        </template>\n        <div class=\"u-tips\">\n            <i class=\"el-icon-warning-outline\"></i>自定义表情包最多只能同时激活五个。\n        </div>\n        <div class=\"u-list\">\n            <div\n                class=\"u-item\"\n                v-for=\"item in emotions\"\n                :key=\"item.group_id\"\n                :class=\"{\n                    'is-using': isUsing(item.group_name),\n                    disabled: isDisabled(item.group_name),\n                    hidden: isHidden(item.group_name),\n                }\"\n                @click.stop=\"handleEmotionClick(item)\"\n            >\n                <img class=\"u-img\" :src=\"imgSrc(item.group_name)\" :alt=\"item.group_name\" />\n                <div class=\"u-title\">{{ item.group_name }}</div>\n            </div>\n        </div>\n\n        <div class=\"u-actions\">\n            <el-button type=\"primary\" @click=\"handleSave\" icon=\"el-icon-circle-check\" :loading=\"loading\"\n                >保存</el-button\n            >\n        </div>\n    </uc>\n</template>\n\n<script>\nimport uc from \"@/components/uc.vue\";\nimport { getDecoration, getEmotion, setDecoration } from \"@/service/decoration\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport { themeTab } from \"@/assets/data/tabs.json\";\nexport default {\n    name: \"emotion\",\n    props: [],\n    data: function () {\n        return {\n            tabList: themeTab,\n\n            emotionList: [],\n            emotions: [],\n            active: [],\n            loading: false,\n        };\n    },\n    computed: {},\n    methods: {\n        loadDecoration() {\n            getDecoration({ type: \"emotion\" }).then((res) => {\n                this.emotionList = res.data.data;\n                this.active = this.emotionList.filter((item) => item.using).map((item) => item.val);\n                const _emotionList = this.emotionList.map((item) => item.val);\n                // 已购买的表情包排在前列\n                this.emotions.sort((a, b) => {\n                    const aUsing = _emotionList.includes(a.group_name);\n                    const bUsing = _emotionList.includes(b.group_name);\n                    if (aUsing && !bUsing) {\n                        return -1;\n                    } else if (!aUsing && bUsing) {\n                        return 1;\n                    } else {\n                        return 0;\n                    }\n                });\n            });\n        },\n        getEmotion() {\n            try {\n                const _emotions = JSON.parse(sessionStorage.getItem(\"jx3_emotion\"));\n\n                if (_emotions) {\n                    this.emotions = _emotions;\n                    return;\n                } else {\n                    getEmotion().then((res) => {\n                        this.emotions = res.data;\n                        sessionStorage.setItem(\"jx3_emotion\", JSON.stringify(res.data));\n                    });\n                }\n            } catch (e) {\n                this.emotions = [];\n            } finally {\n                this.loadDecoration();\n            }\n        },\n        imgSrc(val) {\n            const group = this.emotions.find((item) => item.group_name === val);\n            const defaultEmo = group.items?.[0];\n            return __imgPath + \"emotion/output/\" + defaultEmo?.filename;\n        },\n        isUsing(val) {\n            return this.active.includes(val) || val === \"默认\";\n        },\n        isDisabled(val) {\n            return !this.emotionList.map((item) => item.val).includes(val) && val !== \"默认\";\n        },\n        isHidden(val) {\n            return val === \"默认\";\n        },\n        handleEmotionClick(item) {\n            if (this.isDisabled(item.group_name)) {\n                return;\n            }\n            // 最多只能选择五个\n            if (this.active.length >= 5 && !this.isUsing(item.group_name)) {\n                this.$message.error(\"最多只能选择五个表情包\");\n                return;\n            } else {\n                if (this.isUsing(item.group_name)) {\n                    this.active = this.active.filter((val) => val !== item.group_name);\n                } else {\n                    this.active.push(item.group_name);\n                }\n            }\n        },\n        handleSave() {\n            this.loading = true;\n            const data = this.emotionList.map((item) => {\n                return {\n                    type: \"emotion\",\n                    val: item.val,\n                    using: this.active.includes(item.val),\n                };\n            });\n            setDecoration(data).then((res) => {\n                this.$message.success(\"保存成功\");\n                this.loading = false;\n            });\n        },\n    },\n    mounted: function () {\n        this.getEmotion();\n    },\n    components: {\n        uc,\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-dashboard-emotion {\n    .u-tips {\n        margin-bottom: 16px;\n        .fz(13px);\n        i {\n            .mr(2px);\n        }\n        a:hover {\n            text-decoration: underline;\n        }\n    }\n    .u-list {\n        .flex;\n        flex-wrap: wrap;\n    }\n    .u-item {\n        .flex;\n        .pointer;\n        align-items: center;\n        border: 1px solid #e6e6e6;\n        border-radius: 3px;\n        padding: 4px 8px;\n        margin: 4px;\n        .u-img {\n            .size(20px, 20px);\n        }\n        .u-title {\n            margin-left: 4px;\n            .fz(13px);\n        }\n\n        &.hidden {\n            .none;\n        }\n\n        &.is-using {\n            border-color: #409eff;\n            position: relative;\n\n            // 倒三角标\n            &::before {\n                content: \"\";\n                .pa;\n                right: 0;\n                bottom: 0;\n                border: 12px solid #4abe84;\n                border-top-color: transparent;\n                border-left-color: transparent;\n                border-bottom-right-radius: 3px;\n            }\n            &::after {\n                content: \"\";\n                width: 2px;\n                height: 8px;\n                .pa;\n                right: 4px;\n                bottom: 4px;\n                border: 2px solid #fff;\n                border-top-color: transparent;\n                border-left-color: transparent;\n                transform: rotate(45deg);\n            }\n        }\n        &.disabled {\n            opacity: 0.5;\n            cursor: not-allowed;\n        }\n    }\n    .u-actions {\n        margin-top: 16px;\n        text-align: center;\n    }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./emotion.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./emotion.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./emotion.vue?vue&type=template&id=3ed095cc\"\nimport script from \"./emotion.vue?vue&type=script&lang=js\"\nexport * from \"./emotion.vue?vue&type=script&lang=js\"\nimport style0 from \"./emotion.vue?vue&type=style&index=0&id=3ed095cc&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { $cms, $next } from \"@jx3box/jx3box-common/js/https.js\";\nimport axios from \"axios\";\nimport { __imgPath, __dataPath, __cdn } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\nfunction getDecoration(params) {\n    return $cms().get(`/api/cms/user/decoration`, {\n        params,\n    });\n}\n\nfunction setDecoration(data) {\n    return $cms().post(`/api/cms/user/decoration`, data);\n}\n\nfunction getDecorationJson() {\n    let url = __cdn + `design/decoration/index.json?${Date.now()}`;\n    return axios.get(url);\n}\n\nfunction getEmotion() {\n    return axios.get(`${__dataPath}emotion/output/catalog.json?${Date.now()}`);\n}\n\nfunction receive(user_id, val) {\n    return $cms().post(`/api/cms/user/decoration/check-suit/${user_id}/${val}/for/avatar`);\n}\n\nfunction updateAvatarFrame(data) {\n    return $cms().put(\"/api/cms/user/my/avatar-frame\", data);\n}\n\nfunction getHonor() {\n    // return axios.get(`${__imgPath}decoration/honor.json?${Date.now()}`);\n    return $cms().get(\"/api/cms/user/config/honor\");\n}\n\nfunction getUserHonors(uid) {\n    return $next({ mute: true })\n        .get(\"/api/next2/user/\" + uid + \"/honors\")\n        .then((res) => {\n            return res.data.data;\n        });\n}\nfunction setHonor(honor_id) {\n    return $cms().put(`/api/cms/user/honor/use/${honor_id}`);\n}\nfunction cancelHonor() {\n    return $cms().delete(`/api/cms/user/honor/use`);\n}\n\n// 获取用户勋章\nfunction getUserMedals(uid) {\n    return $next({ mute: true }).get(\"/api/next2/user/\" + uid + \"/medals\");\n}\n\n// 获取所有勋章\nfunction getMedals(params) {\n    return $cms().get(\"/api/cms/config/medal\", {params});\n}\nexport {\n    getDecoration,\n    setDecoration,\n    getDecorationJson,\n    getEmotion,\n    receive,\n    updateAvatarFrame,\n    getHonor,\n    getUserHonors,\n    setHonor,\n    cancelHonor,\n    getUserMedals,\n    getMedals,\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./emotion.vue?vue&type=style&index=0&id=3ed095cc&prod&lang=less\""],"sourceRoot":""}