(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d9748b2"],{1419:function(t,e,a){"use strict";var s=a("521f"),i=a.n(s);i.a},"521f":function(t,e,a){},"69ff":function(t,e,a){"use strict";var s=a("872f"),i=a.n(s);i.a},"872f":function(t,e,a){},bfda:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-album"},[a("el-upload",{ref:"uploadbox",attrs:{action:t.API,"with-credentials":"","list-type":"picture-card","auto-upload":!1,accept:t.accept,limit:10,multiple:"","file-list":t.fileList,"on-change":t.change,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},i=[],o=(a("4160"),a("a434"),a("159b"),a("2d81")),n=a("64c7"),l=a("2777"),r=n["__server"]+"upload",u={name:"album",props:["imgList"],data:function(){return{API:r,fileList:this.imgList||[],accept:o.accept,sizeLimit:o.sizeLimit,dialogImageUrl:"",dialogVisible:!1}},computed:{},methods:{change:function(t,e){var a=this;if("success"!=t.status){if(t.size>this.sizeLimit)return this.$message.error("文件超出大小限制"),void this.removeFile(e,t.uid);var s=new FormData;s.append("file",t.raw),l["b"].post(r,s,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then((function(e){a.$message({message:"上传成功",type:"success"}),t.url=e.data.data.list[0],t.status="success",a.fileList.push(t),a.$emit("albumChange",a.fileList)}))}},handleRemove:function(t,e){this.fileList=e,this.$emit("albumChange",this.fileList)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},removeFile:function(t,e){t.forEach((function(a,s){a.uid==e&&t.splice(s,1)}))}},mounted:function(){},components:{}},c=u,p=(a("69ff"),a("2877")),d=Object(p["a"])(c,s,i,!1,null,null,null);e["a"]=d.exports},fb07:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-dashboard-publish-share"},[t.loaded?a("boilerplate",{attrs:{name:t.name,type:t.type,post:t.post,meta:t.meta,extend:t.extend,infoEnable:!0,contentEnable:!1,markdownEnable:!1,excerptEnable:!1,tagEnable:!1,notifyEnable:!1,bannerEnable:!1},on:{publish:t.toPublish,draft:t.toDraft}},[[a("el-form-item",{attrs:{label:"原创"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.post.original,callback:function(e){t.$set(t.post,"original",e)},expression:"post.original"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{model:{value:t.post.post_subtype,callback:function(e){t.$set(t.post,"post_subtype",e)},expression:"post.post_subtype"}},t._l(t.options.types,(function(e,s){return a("el-radio",{key:s,attrs:{border:"",label:e}},[t._v(t._s(e))])})),1)],1),a("el-form-item",{attrs:{label:"作者"}},[a("el-input",{attrs:{placeholder:"请注明原作者"},model:{value:t.post.post_meta.author,callback:function(e){t.$set(t.post.post_meta,"author",e)},expression:"post.post_meta.author"}})],1),a("el-form-item",{attrs:{label:"图册"}},[a("album",{attrs:{imgList:t.post.post_meta.pics},on:{albumChange:t.updateAlbum}})],1),a("el-form-item",{attrs:{label:"数据"}},[a("input",{staticClass:"u-data-input",attrs:{type:"file",id:"face_file"},on:{change:t.uploadData}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:t.selectData}},[t._v("上传脸型数据")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.post.post_meta.file,expression:"post.post_meta.file"}],staticClass:"u-data-ready"},[a("i",{staticClass:"el-icon-success"}),t._v(" 已上传 ")])],1),a("el-form-item",{attrs:{label:"分析结果"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:t.post.post_meta.data,callback:function(e){t.$set(t.post.post_meta,"data",e)},expression:"post.post_meta.data"}})],1)]],2):t._e()],1)},i=[],o=(a("4160"),a("b0c0"),a("159b"),a("c202")),n=a("64c7"),l=a("bfda"),r=a("2777");function u(t,e){return r["a"].post(__server+"upload/data",t)}function c(t,e){return r["a"].post(n["__node"]+"facedat",{raw:t})}var p=["成男","成女","正太","萝莉"],d={name:"share",props:[],data:function(){return{type:"share",name:"捏脸分享",loaded:!1,options:{types:p},meta:{},post:{ID:"",post_subtype:"成男",post_title:"",post_content:"",post_meta:{author:"",pics:[],file:"",data:""},post_excerpt:"",post_mode:"tinymce",post_banner:"",post_status:"",original:0},extend:{feedEnable:!1,followEnable:!1,tencentEnable:!1,weiboEnable:!1,tuilanEnable:!1}}},computed:{},methods:{toPublish:function(){this.doPublish(this.build(),this).then((function(t){}))},toDraft:function(){this.doDraft(this.build(),this).then((function(t){}))},build:function(){var t=this.$store.state;return t.post.meta_1=t.post.post_meta.author,t},init:function(){return this.doLoad(this).then((function(t){}))},updateAlbum:function(t){var e=[];t.forEach((function(t){e.push({name:t.name,url:t.url})})),this.post.post_meta.pics=e},selectData:function(t){var e=document.getElementById("face_file");e.dispatchEvent(new MouseEvent("click"))},uploadData:function(t){var e=this,a=new FormData,s=t.target.files[0];a.append("file",s),u(a,this).then((function(t){e.post.post_meta.file=t.data.data.list[0],e.$message({message:t.data.msg,type:"success"})})),this.parseData(s)},parseData:function(t){if(FileReader){var e=this,a=new FileReader;a.readAsText(t),a.onload=function(t){console.log("读取成功...开始执行分析..."),c(t.target.result,e).then((function(t){return e.post.post_meta.data=JSON.stringify(t.data.data),t.data.status})).then((function(t){t?e.$notify({title:"成功",message:"脸型数据解析成功",type:"success"}):e.$notify.error({title:"错误",message:"无法解析脸型数据"})}))},a.onerror=function(t){e.$notify.error({title:"错误",message:"无法解析脸型数据"})}}}},filters:{},mounted:function(){var t=this;this.init().then((function(){console.log("Init Post:",t.post)}))},components:{boilerplate:o["a"],album:l["a"]}},f=d,m=(a("1419"),a("2877")),h=Object(m["a"])(f,s,i,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-4d9748b2.2b9d861c.js.map