(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c91fe1e"],{"1c41":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-publish-jx3dat"},[t.loaded?a("boilerplate",{attrs:{name:t.name,type:t.type,post:t.post,meta:t.meta,extend:t.extend,infoEnable:!0,contentEnable:!0,markdownEnable:!1,excerptEnable:!0,tagEnable:!1,notifyEnable:!0,bannerEnable:!0,publish_text:"发布为公开",draft_text:"发布为私有"},on:{publish:t.toPublish,draft:t.toDraft}},[[a("el-form-item",{attrs:{label:"原创"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.post.original,callback:function(e){t.$set(t.post,"original",e)},expression:"post.original"}})],1),a("el-form-item",{attrs:{label:"语言"}},[a("el-radio-group",{model:{value:t.post.post_meta.lang,callback:function(e){t.$set(t.post.post_meta,"lang",e)},expression:"post.post_meta.lang"}},[a("el-radio",{attrs:{label:"cn"}},[t._v("简体中文")]),a("el-radio",{attrs:{label:"tr"}},[t._v("繁體中文")])],1)],1),a("el-form-item",{staticClass:"m-jx3dat-subtypes",attrs:{label:"类型"}},t._l(t.options.type_map,(function(e,s){return a("el-radio",{key:s,attrs:{label:s,border:""},on:{change:function(e){return t.changeSubtype(t.post.post_meta.type)}},model:{value:t.post.post_meta.type,callback:function(e){t.$set(t.post.post_meta,"type",e)},expression:"post.post_meta.type"}},[t._v(t._s(e))])})),1),1==t.post.post_meta.type?a("el-form-item",{attrs:{label:"标签"}},[a("el-checkbox-group",{model:{value:t.post.post_meta.tag,callback:function(e){t.$set(t.post.post_meta,"tag",e)},expression:"post.post_meta.tag"}},t._l(t.options.tag_list,(function(t){return a("el-checkbox",{key:t,attrs:{label:t}})})),1)],1):t._e(),1==t.post.post_meta.type?[a("el-divider",{attrs:{"content-position":"left"}},[t._v("数据")]),a("div",{staticClass:"m-data-box"},[a("div",{staticClass:"m-data-header"},[a("el-button",{staticClass:"m-data-addbutton",attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:t.addDBM}},[t._v("添加数据")]),a("a",{staticClass:"m-data-help el-button el-button--success is-plain el-button--small",attrs:{href:"https://www.jx3box.com/tool/?pid=13912",target:"_blank"}},[a("i",{staticClass:"el-icon-info"}),t._v(" 点击查看发布帮助 ")])],1),a("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":t.delDBM},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},t._l(t.post.post_meta.data,(function(e,s){return a("el-tab-pane",{key:s,attrs:{name:s+1+""}},[a("span",{staticClass:"m-data-tab-label",attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-box"}),t._v(t._s(e.name))]),a("div",{staticClass:"m-data-item"},[a("h5",{staticClass:"u-title"},[t._v("订阅名")]),a("div",{staticClass:"u-group"},[a("div",{staticClass:"u-subblock"},[a("el-input",{attrs:{minlength:1,maxlength:10,"show-word-limit":"",disabled:0==s,placeholder:0==s?"默认版":"版本名称"},on:{change:function(a){return t.checkDataName(e)}},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}},[a("template",{slot:"prepend"},[a("b",{staticClass:"u-feed"},[t._v(t._s(t.user.name)+t._s("默认版"==e.name?"":"#"+e.name))])])],2)],1),a("div",{staticClass:"u-subblock u-status-wrapper"},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"item.status"}}),a("el-tooltip",{attrs:{effect:"dark",content:"设置不公开后,仍然可以通过订阅名下载,仅不做展示",placement:"top"}},[a("span",{staticClass:"u-status"},[t._v(t._s(e.status?"公开":"私有"))])])],1)])]),a("div",{staticClass:"m-data-item"},[a("h5",{staticClass:"u-title"},[t._v("数据标题")]),a("el-input",{attrs:{placeholder:"数据描述",maxlength:"50","show-word-limit":""},model:{value:e.desc,callback:function(a){t.$set(e,"desc",a)},expression:"item.desc"}})],1),a("div",{staticClass:"m-data-item m-data-jx3dat"},[a("h5",{staticClass:"u-title"},[t._v("数据文件")]),a("input",{staticClass:"u-data-input",attrs:{type:"file",id:"jx3dat_"+s}}),a("el-button",{attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-s-promotion"},on:{click:function(a){return t.uploadDBM(e,s)}}},[t._v("开始上传")]),e.file?a("el-input",{staticClass:"u-fileurl",attrs:{placeholder:"数据地址",disabled:!0,value:e.file}},[a("template",{slot:"prepend"},[a("span",{staticClass:"u-status"},[t._v(" 当前文件地址")])]),a("template",{slot:"append"},[a("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.file,expression:"item.file",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-copy"},[a("i",{staticClass:"el-icon-document-copy"}),a("span",[t._v("点击复制")])])])],2):t._e()],1)])})),1)],1),a("div",{staticClass:"m-data-more"},[a("div",{staticClass:"u-more",on:{click:t.toggleMoreFeed}},[a("i",{class:t.moreFeedsVisible?"el-icon-arrow-up":"el-icon-arrow-down"}),a("span",[t._v("其它订阅号")])]),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.moreFeedsVisible,expression:"moreFeedsVisible"}],staticClass:"u-tr"},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{placeholder:"(非必填)"},model:{value:t.post.post_meta.github,callback:function(e){t.$set(t.post.post_meta,"github",e)},expression:"post.post_meta.github"}},[a("template",{slot:"prepend"},[t._v("Github订阅号")]),a("template",{slot:"append"},[t._v("@github")])],2)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.moreFeedsVisible,expression:"moreFeedsVisible"}],staticClass:"u-tr"},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{placeholder:"(非必填)"},model:{value:t.post.post_meta.gitee,callback:function(e){t.$set(t.post.post_meta,"gitee",e)},expression:"post.post_meta.gitee"}},[a("template",{slot:"prepend"},[t._v("Gitee订阅号")]),a("template",{slot:"append"},[t._v("@gitee")])],2)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.moreFeedsVisible,expression:"moreFeedsVisible"}],staticClass:"u-tr"},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{placeholder:"(非必填)"},model:{value:t.post.post_meta.aliyun,callback:function(e){t.$set(t.post.post_meta,"aliyun",e)},expression:"post.post_meta.aliyun"}},[a("template",{slot:"prepend"},[t._v("Aliyun订阅号")]),a("template",{slot:"append"},[t._v("@aliyun")])],2)],1)],1)],1)]:a("el-form-item",{staticClass:"m-jx3dat-other",attrs:{label:"数据"}},[a("input",{staticClass:"u-data-input",attrs:{type:"file",id:"otherdata"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-s-promotion",plain:"",size:"medium"},on:{click:t.uploadDat}},[t._v("开始上传")]),t.post.post_meta.down?a("el-input",{staticClass:"u-fileurl",attrs:{placeholder:"数据地址",disabled:!0,value:t.post.post_meta.down}},[a("template",{slot:"prepend"},[a("span",{staticClass:"u-status"},[t._v(" 当前文件地址")])]),a("template",{slot:"append"},[a("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.post.post_meta.down||"",expression:"post.post_meta.down || ''",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-copy"},[a("i",{staticClass:"el-icon-document-copy"}),a("span",[t._v("点击复制")])])])],2):t._e()],1)]],2):t._e()],1)},i=[],o=(a("a434"),a("b0c0"),a("d3b7"),a("25f0"),a("c202")),n=(a("4160"),a("159b"),a("2777")),l=a("64c7"),r=l["__next"]+"api/plugins/my-team-mon",c=l["__next"]+"api/plugins/jx3dat/publish";function p(t,e){return n["b"].post(r,t,{withCredentials:!0}).catch((function(t){e.failCallback(t,e)}))}function u(t,e){return n["a"].post("upload/data",t).catch((function(t){e.failCallback(t,e)}))}function d(t,e){var a=m(t);return console.log("正在执行redis同步作业:",a),n["b"].post(c,a,{withCredentials:!0}).catch((function(t){e.failCallback(t,e)}))}function m(t){var e=t.author,a=t.ID,s={author:e,user_id:~~t.post_author||0,post_id:a,post_status:t.post_status,data:{},lang:t.post_meta.lang};return t.post_meta.data.forEach((function(t,i){s.data[t.name]={author:e,key:t.name,name:t.desc,version:t.version||Date.now(),data_url:t.file,about:l["__Root"]+"jx3dat/?pid="+a,status:t.status}})),s}var h=a("c9d2"),b=a.n(h),f=a("f8c2"),_=a("bd13"),v={name:"jx3dat",props:[],data:function(){return{type:"jx3dat",name:"插件数据",loaded:!1,options:{type_map:f["b"],tag_list:f["a"]},meta:{},post:{ID:"",post_subtype:"1",post_title:"",post_content:"",post_meta:{type:"1",lang:"cn",data:[{name:"默认版",desc:"",status:!0,file:"",version:""}],tag:[],github:"",gitee:"",aliyun:"",down:""},post_excerpt:"",post_mode:"tinymce",post_status:"",post_banner:"",original:0},extend:{feedEnable:!1,followEnable:!1,tencentEnable:!1,weiboEnable:!1,tuilanEnable:!1},user:{},tempname:"",moreFeedsVisible:!1,activeIndex:"1"}},computed:{},methods:{toPublish:function(){var t=this;this.doPublish(this.build(),this,!1).then((function(e){1==t.post.post_subtype?d(e.data.data,t).then((function(a){t.finish(e.data.msg,e.data.data.ID,t.type)})).catch((function(e){t.failCallback(e,t)})):t.finish(e.data.msg,e.data.data.ID,t.type)}))},toDraft:function(){var t=this;this.doDraft(this.build(),this,!1).then((function(e){1==t.post.post_subtype?d(e.data.data,t).then((function(a){t.finish(e.data.msg,e.data.data.ID,t.type)})).catch((function(e){t.failCallback(e,t)})):t.finish(e.data.msg,e.data.data.ID,t.type)}))},finish:function(t,e,a){this.$message({message:t,type:"success"}),setTimeout((function(){location.href="/"+a+"/?pid="+e}),500)},init:function(){return this.doLoad(this).then((function(t){}))},build:function(){var t=this.$store.state;return t.post.meta_1=t.post.post_meta.tag.toString(),t.post.meta_4=t.post.post_meta.lang,t},changeSubtype:function(t){this.$store.commit("changeSubtype",t)},checkDataName:function(t){var e=Object(_["a"])(t.name).removeSpace();e=Object(_["a"])(e).kill(),this.$set(t,"name",e)},selectDBM:function(t){var e=document.getElementById("jx3dat_"+t);e.dispatchEvent(new MouseEvent("click"))},uploadDBM:function(t,e){var a=this,s=document.getElementById("jx3dat_"+e),i=s.files[0];if(i){var o=new FormData;o.append("jx3dat",i),p(o,this).then((function(e){e&&(t.file=e.data.download_url,a.$message({message:"数据上传成功",type:"success"}),t.version=Date.now())}))}else this.$alert("请先选择文件","提醒",{confirmButtonText:"确定"})},addDBM:function(){if(this.post.post_meta.data.length>=3)this.$alert("默认只能设置3个版本","消息",{confirmButtonText:"确定"});else{this.post.post_meta.data.push({name:"",desc:"",status:!0,file:""});var t=this.post.post_meta.data.length+1+"";this.activeMacroIndex=t}},delDBM:function(t){var e=this;1!=t?this.post.post_meta.data.length<2?this.$alert("✘ 必须保留默认数据","消息",{confirmButtonText:"确定"}):this.$alert("确定删除这个数据吗，删除后无法找回","消息",{confirmButtonText:"确定",callback:function(a){if("confirm"==a){var s=~~t-1;e.post.post_meta.data.splice(s,1),e.activeIndex=s+""}}}):this.$alert("✘ 必须保留默认数据","消息",{confirmButtonText:"确定"})},selectDat:function(){var t=document.getElementById("otherdata");t.dispatchEvent(new MouseEvent("click"))},uploadDat:function(t){var e=this,a=document.getElementById("otherdata"),s=a.files[0];if(s){var i=new FormData;i.append("file",s),u(i,this).then((function(t){e.post.post_meta.down=t.data.data.list[0],e.$message({message:t.data.msg,type:"success"}),e.tempname=s.name}))}else this.$alert("请先选择文件","提醒",{confirmButtonText:"确定"})},toggleMoreFeed:function(){this.moreFeedsVisible=!this.moreFeedsVisible},onCopy:function(t){this.$notify({title:"复制成功",message:"复制成功",type:"success"})},onError:function(){this.$notify.error({title:"复制失败",message:"复制失败"})}},mounted:function(){this.init().then((function(t){})),this.user=b.a.getInfo()},filters:{},components:{boilerplate:o["a"]}},g=v,y=(a("6353"),a("2877")),w=Object(y["a"])(g,s,i,!1,null,null,null);e["default"]=w.exports},6353:function(t,e,a){"use strict";var s=a("910f"),i=a.n(s);i.a},"910f":function(t,e,a){},bd13:function(t,e,a){"use strict";function s(t){var e=Object.prototype.toString.call(t);return e.match(/\[object (.*?)\]/)[1].toLowerCase()}a.d(e,"a",(function(){return n}));var i=s;class o{constructor(t,e){if("string"!==i(t))throw new Error("[Sterilizer::init] params should be string");this._symbols={"`":"`","~":"~","!":"!","@":"@","#":"#",$:"\\$","%":"%","^":"\\^","&":"&","*":"\\*","-":"\\-",_:"_","=":"=","+":"+","(":"\\(",")":"\\)","[":"\\[","]":"\\]","{":"\\{","}":"\\}","|":"\\|","\\":"\\\\","/":"/","?":"\\?",":":":",";":";","'":"'",'"':'"',">":">","<":"<",",":",",".":"\\."},this.symbols=Object.keys(this._symbols),this.regs=Object.values(this._symbols),this.str=t,this._str=t,this._chain=e}toString(){return this._str}_detected(t){let e=i(t),a=["string","array","set"];if(!a.includes(e))throw new Error("[Sterilizer::remove] params should be string|array|set");return t}_sterilize(t){t=[...t].join("");let e=new RegExp(`[${t}]`,"gm");return this._str=this._str.replace(e,""),this._chain?this:this.toString()}kill(t){let e=null;if(void 0==t)e=new Set(this.regs);else{this._detected(t),e=new Set;let a=new Set(t);for(let t of a)this.symbols.includes(t)&&e.add(this._symbols[t])}return this._sterilize(e)}live(t){this._detected(t);let e=new Set(this.regs);for(let a of t)this.symbols.includes(a)&&e.delete(this._symbols[a]);return this._sterilize(e)}safe(){return this.kill(["&","<",">",'"',"'","+",":","/","?","=","#","%"])}removeHSC(){return this.kill(["&","<",">",'"',"'"])}removeURL(){return this.kill(["+",":","/","?","=","&","#","%"])}removeSpace(){return this._str=this._str.replace(/\s/gm,""),this._chain?this:this.toString()}remove(t,e){let a=new RegExp(""+t,"gm");return e=void 0!==e?e:"",this._str=this._str.replace(a,e),this._chain?this:this.toString()}removeHTMLtag(){return this._str=this._str.replace(/<[^>]+>/gm,""),this._chain?this:this.toString()}}function n(t,e=!1){return new o(t,e)}},f8c2:function(t){t.exports=JSON.parse('{"b":{"1":"团队监控数据","2":"目标监控数据","3":"团队面板buff数据","4":"团队面板UI皮肤","5":"其它插件数据"},"a":["PVE","PVP","抓马","宠物","奇遇","浪客行","体服","其它"]}')}}]);
//# sourceMappingURL=chunk-0c91fe1e.befd28e8.js.map