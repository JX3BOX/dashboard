{"version":3,"sources":["webpack:///./src/publish/knowledge.vue?3bd5","webpack:///./node_modules/core-js/modules/es.string.trim.js","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./src/publish/knowledge.vue?f96c","webpack:///./src/service/knowledge.js","webpack:///src/publish/knowledge.vue","webpack:///./src/publish/knowledge.vue?723f","webpack:///./src/publish/knowledge.vue","webpack:///./node_modules/core-js/internals/string-trim-forced.js","webpack:///./src/service/wiki_post.js"],"names":["$","$trim","trim","forcedStringTrimMethod","target","proto","forced","this","module","exports","requireObjectCoercible","whitespaces","whitespace","ltrim","RegExp","rtrim","createMethod","TYPE","$this","string","String","replace","start","end","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_t","_v","post","id","search_handle","options","loading","model","value","callback","$$v","$set","expression","_l","item","key","name","domProps","_s","label","on","$event","dialogVisible","tag","tags","splice","ref","handleInputConfirm","nativeOn","type","indexOf","_k","keyCode","inputValue","showInput","processing","publish","knowledge","_e","slot","create_knowledge","staticRenderFns","get_menus","$_helper","method","url","get_list","params","data","qs","stringify","component","fails","non","METHOD_NAME","get_newest_post","$helper","source_id","create_post"],"mappings":"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","file":"js/chunk-0147843c.40438166.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./knowledge.vue?vue&type=style&index=0&lang=less&\"","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","// a string of all valid unicode whitespaces\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002' +\n  '\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish-box\"},[_c('pubheader',{attrs:{\"name\":\"通识百科\"}},[_vm._t(\"header\")],2),_c('el-form',{staticClass:\"m-publish-post\"},[_c('div',{staticClass:\"m-publish-source\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"选择通识 *\")]),_c('el-select',{staticClass:\"u-source-id\",attrs:{\"filterable\":\"\",\"remote\":\"\",\"disabled\":!!_vm.post.id,\"placeholder\":\"通过输入通识名称进行搜索\",\"remote-method\":_vm.search_handle,\"loading\":_vm.options.loading},model:{value:(_vm.post.source_id),callback:function ($$v) {_vm.$set(_vm.post, \"source_id\", $$v)},expression:\"post.source_id\"}},_vm._l((_vm.options.sources),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.id}},[_c('div',{staticClass:\"u-option\"},[_c('span',{staticClass:\"u-type\",domProps:{\"textContent\":_vm._s(item.label)}}),_c('span',{staticClass:\"u-name\",domProps:{\"textContent\":_vm._s(item.name)}})])])}),1),_c('p',{staticClass:\"m-knowledge-add\"},[_c('span',[_vm._v(\"如没有合适的通识选择，可点击此处\")]),_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"添加通识\")]),_c('span',[_vm._v(\"Note：添加完成后的通识需要经过管理员审核通过后才会在通识百科上展示哦\")])],1)],1),_c('div',{staticClass:\"m-publish-remark\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"修订说明 *\")]),_c('el-input',{attrs:{\"maxlength\":200,\"minlength\":1,\"show-word-limit\":\"\",\"required\":\"\",\"placeholder\":\"请简单描述一下本次修订说明\"},model:{value:(_vm.post.remark),callback:function ($$v) {_vm.$set(_vm.post, \"remark\", $$v)},expression:\"post.remark\"}})],1),_c('div',{staticClass:\"m-publish-content\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"通识正文 *\")]),_c('Tinymce',{attrs:{\"attachmentEnable\":true,\"resourceEnable\":true,\"height\":600},model:{value:(_vm.post.content),callback:function ($$v) {_vm.$set(_vm.post, \"content\", $$v)},expression:\"post.content\"}})],1),_c('div',{staticClass:\"m-publish-tags\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"通识标签\")]),_vm._l((_vm.post.tags),function(tag,key){return _c('el-tag',{key:key,attrs:{\"closable\":\"\",\"disable-transitions\":false},on:{\"close\":function($event){return _vm.post.tags.splice(key, 1)}}},[_vm._v(_vm._s(tag)+\" \")])}),(_vm.inputVisible)?_c('el-input',{ref:\"saveTagInput\",staticClass:\"input-new-tag\",attrs:{\"size\":\"small\",\"placeholder\":\"回车以添加\"},on:{\"blur\":_vm.handleInputConfirm},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.handleInputConfirm($event)}},model:{value:(_vm.inputValue),callback:function ($$v) {_vm.inputValue=$$v},expression:\"inputValue\"}}):_c('el-button',{staticClass:\"button-new-tag\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.showInput}},[_vm._v(\"+ 添加标签 \")])],2),_c('div',{staticClass:\"m-publish-commit\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}}),_c('el-button',{staticClass:\"u-publish\",attrs:{\"icon\":\"el-icon-s-promotion\",\"type\":\"primary\",\"disabled\":_vm.processing},on:{\"click\":_vm.publish}},[_vm._v(\"提交通识 \")])],1)]),_c('el-dialog',{attrs:{\"title\":\"通识添加\",\"visible\":_vm.dialogVisible,\"width\":\"640px\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event},\"open\":function($event){_vm.knowledge = { type: '', name: '' }}}},[(_vm.knowledge)?_c('el-form',{staticClass:\"m-publish-knowledge\"},[_c('div',{staticClass:\"m-publish-type\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"类别 *\")]),(_vm.types)?_c('el-radio-group',{model:{value:(_vm.knowledge.type),callback:function ($$v) {_vm.$set(_vm.knowledge, \"type\", $$v)},expression:\"knowledge.type\"}},_vm._l((_vm.types),function(type,key){return _c('el-radio',{key:type.name,attrs:{\"label\":key,\"border\":\"\"}},[_vm._v(_vm._s(type.label)+\" \")])}),1):_vm._e()],1),_c('div',{staticClass:\"m-publish-name\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"名称 *\")]),_c('el-input',{attrs:{\"placeholder\":\"请输入通识名称\",\"minlength\":1,\"maxlength\":50,\"show-word-limit\":\"\"},model:{value:(_vm.knowledge.name),callback:function ($$v) {_vm.$set(_vm.knowledge, \"name\", $$v)},expression:\"knowledge.name\"}})],1)]):_vm._e(),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.processing},on:{\"click\":_vm.create_knowledge}},[_vm._v(\"添加通识\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $_helper } from \"./axios\";\nimport qs from \"qs\";\n\nfunction get_menus() {\n    return $_helper({\n        method: \"GET\",\n        url: `/api/knowledge/menus`,\n    });\n}\n\nfunction get_list(params) {\n    return $_helper({\n        method: \"GET\",\n        url: `/api/knowledges`,\n        params: params,\n    });\n}\n\nfunction create_knowledge(params) {\n    return $_helper({\n        method: \"POST\",\n        url: `/api/knowledge`,\n        data: qs.stringify({ knowledge: params }),\n    });\n}\n\nexport { get_menus, get_list, create_knowledge };\n","<template>\n    <div class=\"m-publish-box\">\n        <!-- 头部 -->\n        <pubheader name=\"通识百科\">\n            <slot name=\"header\"></slot>\n        </pubheader>\n\n        <el-form class=\"m-publish-post\">\n            <div class=\"m-publish-source\">\n                <el-divider content-position=\"left\">选择通识 *</el-divider>\n                <el-select\n                    class=\"u-source-id\"\n                    v-model=\"post.source_id\"\n                    filterable\n                    remote\n                    :disabled=\"!!post.id\"\n                    placeholder=\"通过输入通识名称进行搜索\"\n                    :remote-method=\"search_handle\"\n                    :loading=\"options.loading\"\n                >\n                    <el-option\n                        v-for=\"item in options.sources\"\n                        :key=\"item.id\"\n                        :label=\"item.name\"\n                        :value=\"item.id\"\n                    >\n                        <div class=\"u-option\">\n                            <span class=\"u-type\" v-text=\"item.label\"></span>\n                            <span class=\"u-name\" v-text=\"item.name\"></span>\n                        </div>\n                    </el-option>\n                </el-select>\n                <p class=\"m-knowledge-add\">\n                    <span>如没有合适的通识选择，可点击此处</span>\n                    <el-button\n                        type=\"success\"\n                        @click=\"dialogVisible = true\"\n                        size=\"mini\"\n                        >添加通识</el-button\n                    >\n                    <span\n                        >Note：添加完成后的通识需要经过管理员审核通过后才会在通识百科上展示哦</span\n                    >\n                </p>\n            </div>\n\n            <div class=\"m-publish-remark\">\n                <el-divider content-position=\"left\">修订说明 *</el-divider>\n                <el-input\n                    v-model=\"post.remark\"\n                    :maxlength=\"200\"\n                    :minlength=\"1\"\n                    show-word-limit\n                    required\n                    placeholder=\"请简单描述一下本次修订说明\"\n                ></el-input>\n            </div>\n\n            <div class=\"m-publish-content\">\n                <el-divider content-position=\"left\">通识正文 *</el-divider>\n                <Tinymce\n                    v-model=\"post.content\"\n                    :attachmentEnable=\"true\"\n                    :resourceEnable=\"true\"\n                    :height=\"600\"\n                />\n            </div>\n\n            <div class=\"m-publish-tags\">\n                <el-divider content-position=\"left\">通识标签</el-divider>\n                <el-tag\n                    :key=\"key\"\n                    v-for=\"(tag, key) in post.tags\"\n                    closable\n                    :disable-transitions=\"false\"\n                    @close=\"post.tags.splice(key, 1)\"\n                    >{{ tag }}\n                </el-tag>\n                <el-input\n                    class=\"input-new-tag\"\n                    v-if=\"inputVisible\"\n                    v-model=\"inputValue\"\n                    ref=\"saveTagInput\"\n                    size=\"small\"\n                    placeholder=\"回车以添加\"\n                    @keyup.enter.native=\"handleInputConfirm\"\n                    @blur=\"handleInputConfirm\"\n                >\n                </el-input>\n                <el-button\n                    v-else\n                    class=\"button-new-tag\"\n                    size=\"small\"\n                    @click=\"showInput\"\n                    >+ 添加标签\n                </el-button>\n            </div>\n\n            <div class=\"m-publish-commit\">\n                <el-divider content-position=\"left\"></el-divider>\n                <el-button\n                    class=\"u-publish\"\n                    icon=\"el-icon-s-promotion\"\n                    type=\"primary\"\n                    @click=\"publish\"\n                    :disabled=\"processing\"\n                    >提交通识\n                </el-button>\n            </div>\n        </el-form>\n\n        <!-- 通识创建表单 -->\n        <el-dialog\n            title=\"通识添加\"\n            :visible.sync=\"dialogVisible\"\n            width=\"640px\"\n            @open=\"knowledge = { type: '', name: '' }\"\n        >\n            <el-form class=\"m-publish-knowledge\" v-if=\"knowledge\">\n                <div class=\"m-publish-type\">\n                    <el-divider content-position=\"left\">类别 *</el-divider>\n                    <el-radio-group v-if=\"types\" v-model=\"knowledge.type\">\n                        <el-radio\n                            :label=\"key\"\n                            border\n                            v-for=\"(type, key) in types\"\n                            :key=\"type.name\"\n                            >{{ type.label }}\n                        </el-radio>\n                    </el-radio-group>\n                </div>\n\n                <div class=\"m-publish-name\">\n                    <el-divider content-position=\"left\">名称 *</el-divider>\n                    <el-input\n                        v-model=\"knowledge.name\"\n                        placeholder=\"请输入通识名称\"\n                        :minlength=\"1\"\n                        :maxlength=\"50\"\n                        show-word-limit\n                    ></el-input>\n                </div>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogVisible = false\">取消</el-button>\n                <el-button\n                    type=\"primary\"\n                    :disabled=\"processing\"\n                    @click=\"create_knowledge\"\n                    >添加通识</el-button\n                >\n            </div>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport pubheader from \"@/components/publish/pubheader.vue\";\nimport Tinymce from \"@jx3box/jx3box-editor/src/Tinymce\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { get_menus, get_list, create_knowledge } from \"../service/knowledge\";\nimport { get_newest_post, create_post } from \"../service/wiki_post\";\nimport {__Root} from '@jx3box/jx3box-common/data/jx3box.json'\n\nexport default {\n    name: \"knowledge\",\n    data: function() {\n        return {\n            dialogVisible: false,\n            knowledge: null,\n            post: {\n                id: \"\",\n                content: \"\",\n                source_id: \"\",\n                remark: \"\",\n                tags: [],\n            },\n            types: null,\n            options: {\n                sources: null,\n                loading: false,\n            },\n            inputVisible: false,\n            inputValue: \"\",\n        };\n    },\n    computed: {\n        processing() {\n            return this.$store.state.processing;\n        },\n    },\n    methods: {\n        create_knowledge() {\n            this.$store.commit(\"startProcess\");\n            create_knowledge({\n                type: this.knowledge.type,\n                name: this.knowledge.name,\n            }).then((res) => {\n                res = res.data;\n                if (res.code === 200) {\n                    // 自动选择已添加项\n                    this.post.source_id = res.data.id;\n                    this.$message({ message: \"通识添加成功\", type: \"success\" });\n                    this.dialogVisible = false;\n                } else {\n                    this.$message({\n                        message: `${res.message}`,\n                        type: \"warning\",\n                    });\n                }\n            });\n        },\n        search_handle(keyword) {\n            this.options.loading = true;\n            get_list({\n                keyword: keyword,\n                include_pending: 1,\n                limit: 10,\n            }).then((res) => {\n                res = res.data;\n                if (res.code === 200) this.options.sources = res.data.data;\n                this.options.loading = false;\n            });\n        },\n        validate() {\n            let result = [\"source_id\", \"content\", \"remark\"].every((prop) => {\n                return !!this.post[prop];\n            });\n            if (!result) this.$message.error(\"请完成必填项\");\n            return result;\n        },\n        publish: function() {\n            // 表单校验\n            if (!this.validate()) return;\n            this.$store.commit(\"startProcess\");\n            create_post({\n                type: \"knowledge\",\n                source_id: this.post.source_id,\n                user_nickname: User.getInfo().name,\n                content: this.post.content,\n                remark: this.post.remark,\n                tags: this.post.tags,\n            }).then((data) => {\n                data = data.data;\n                if (data.code === 200) {\n                    this.$message({\n                        message: \"提交成功，请等待审核\",\n                        type: \"success\",\n                        onClose: () => {\n                            // this.$router.go(0);\n                            location.href = __Root + '/dashboard/#/wiki'\n                        },\n                    });\n                } else {\n                    this.$message({\n                        message: `${data.message}`,\n                        type: \"warning\",\n                    });\n                }\n            });\n        },\n        showInput() {\n            this.inputVisible = true;\n            this.$nextTick((_) => {\n                this.$refs.saveTagInput.$refs.input.focus();\n            });\n        },\n        handleInputConfirm() {\n            let inputValue = this.inputValue.trim();\n            if (inputValue) {\n                this.post.tags.push(inputValue);\n            }\n            this.inputVisible = false;\n            this.inputValue = \"\";\n        },\n    },\n    created() {\n        let id = this.$route.params.source_id;\n        this.post.source_id = id ? id : \"\";\n\n        // 初始化搜索列表\n        this.search_handle(\"\");\n\n        get_menus().then((res) => {\n            res = res.data;\n            if (res.code === 200) this.types = res.data.menus;\n        });\n    },\n    components: {\n        pubheader,\n        Tinymce,\n    },\n    watch: {\n        \"post.source_id\": {\n            handler() {\n                if (!this.post.source_id) return;\n                get_newest_post(\"knowledge\", this.post.source_id).then(\n                    (res) => {\n                        let data = res.data;\n                        if (data.code === 200) {\n                            // 数据填充\n                            let post = data.data.post;\n                            let source = data.data.source;\n\n                            if (post) {\n                                this.post.source_id = parseInt(post.source_id);\n                                this.post.remark = \"\";\n                                this.post.content = post.content;\n                                this.post.tags = post.tags || [];\n                            } else {\n                                this.post.source_id = this.post.source_id\n                                    ? parseInt(this.post.source_id)\n                                    : \"\";\n                                this.post.remark = \"\";\n                                this.post.content = \"\";\n                                this.post.tags = [];\n                            }\n\n                            if (source) {\n                                // 将选择项恢复至下拉框\n                                let exist = false;\n                                this.options.sources =\n                                    this.options.sources || [];\n                                for (let index in this.options.sources) {\n                                    if (\n                                        this.options.sources[index].id ==\n                                        source.id\n                                    ) {\n                                        exist = true;\n                                        break;\n                                    }\n                                }\n                                if (!exist) this.options.sources.push(source);\n                            }\n                        }\n                    }\n                );\n            },\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/publish/knowledge.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./knowledge.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./knowledge.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./knowledge.vue?vue&type=template&id=453c1b58&\"\nimport script from \"./knowledge.vue?vue&type=script&lang=js&\"\nexport * from \"./knowledge.vue?vue&type=script&lang=js&\"\nimport style0 from \"./knowledge.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","import { $helper } from \"./axios\";\nimport qs from \"qs\";\n\n// 获取最新攻略\nfunction get_newest_post(type, id) {\n    if (!id) return;\n    return $helper({\n        method: \"GET\",\n        url: `/api/wiki/post`,\n        params: { type: type, source_id: id },\n    });\n}\n\nfunction create_post(params) {\n    return $helper({\n        method: \"POST\",\n        url: `/api/wiki/post`,\n        data: qs.stringify({ post: params }),\n    });\n}\n\nexport { get_newest_post, create_post };\n"],"sourceRoot":""}