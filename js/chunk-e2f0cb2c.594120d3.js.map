{"version":3,"sources":["webpack:///./src/service/goods.js","webpack:///./src/views/order_detail.vue?29d2","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/views/order_detail.vue?89d4","webpack:///src/views/order_detail.vue","webpack:///./src/views/order_detail.vue?3fde","webpack:///./src/views/order_detail.vue"],"names":["getAddress","params","$pay","get","addAddress","data","post","updateAddress","id","put","delAddress","delete","defaultAddress","getOrder","updateOrderAddress","orderId","addressId","updateOrderRemark","remark","getOrderId","closeOrder","toPay","toConfirm","$","$map","map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","on","goBack","_v","_s","address","actual_contact","actual_phone","actual_address","attrs","goods","goods_images","title","order","order_no","created_at","goods_num","postage","payStatus","pay_status","orderStatus","order_status","price_cny","_e","price_boxcoin","price_points","closeButton","$event","cancel","open","showPay","dialogVisible","close","mode","ref","address_form","address_rules","model","value","callback","$$v","$set","expression","_l","item","i","key","submit","remark_form","remark_rules","staticRenderFns","name","addressList","address_id","required","message","trigger","computed","pageIndex","methods","load","loadAddress","type","formName","mounted","component"],"mappings":"kiBAEA,SAASA,EAAWC,GAChB,OAAOC,iBAAOC,IAAP,qBAAiCF,GAG5C,SAASG,EAAWC,GAChB,OAAOH,iBAAOI,KAAP,qBAAkCD,GAG7C,SAASE,EAAcC,EAAIH,GACvB,OAAOH,iBAAOO,IAAP,6BAAiCD,GAAMH,GAGlD,SAASK,EAAWF,GAChB,OAAON,iBAAOS,OAAP,6BAAoCH,IAG/C,SAASI,EAAeJ,GACpB,OAAON,iBAAOO,IAAP,qCAAyCD,IAGpD,SAASK,EAASZ,GACd,OAAOC,iBAAOC,IAAP,kBAA8B,CAAEF,WAG3C,SAASa,EAAmBC,EAASC,GACjC,OAAOd,iBAAOO,IAAP,0BAA8BM,EAA9B,yBAAsDC,IAGjE,SAASC,EAAkBT,EAAIU,GAC3B,OAAOhB,iBAAOO,IAAP,0BAA8BD,EAA9B,WAA2C,CAAEU,WAGxD,SAASC,EAAWX,GAChB,OAAON,iBAAOC,IAAP,0BAA8BK,IAGzC,SAASY,EAAWZ,GAChB,OAAON,iBAAOO,IAAP,0BAA8BD,EAA9B,YAGX,SAASa,EAAMb,GACX,OAAON,iBAAOI,KAAP,0BAA+BE,EAA/B,SAGX,SAASc,EAAUd,GACf,OAAON,iBAAOI,KAAP,0BAA+BE,EAA/B,gB,2DC/CX,W,kCCCA,IAAIe,EAAI,EAAQ,QACZC,EAAO,EAAQ,QAAgCC,IAC/CC,EAA+B,EAAQ,QAEvCC,EAAsBD,EAA6B,OAKvDH,EAAE,CAAEK,OAAQ,QAASC,OAAO,EAAMC,QAASH,GAAuB,CAChEF,IAAK,SAAaM,GAChB,OAAOP,EAAKQ,KAAMD,EAAYE,UAAUC,OAAS,EAAID,UAAU,QAAKE,O,yCCZxE,IAAIC,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,OAAO,CAACE,YAAY,SAASC,GAAG,CAAC,MAAQN,EAAIO,SAAS,CAACJ,EAAG,IAAI,CAACE,YAAY,uBAAuBL,EAAIQ,GAAG,WAAWL,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACF,EAAG,OAAO,CAACH,EAAIQ,GAAG,OAAOR,EAAIS,GAAGT,EAAIU,QAAQC,mBAAmBR,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIU,QAAQE,iBAAiBT,EAAG,OAAO,CAACH,EAAIQ,GAAG,SAASR,EAAIS,GAAGT,EAAIU,QAAQG,qBAAsBb,EAAS,MAAEG,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQS,MAAM,CAAC,IAAMd,EAAIe,MAAMC,aAAa,MAAMb,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,OAAO,CAACE,YAAY,WAAW,CAACL,EAAIQ,GAAGR,EAAIS,GAAGT,EAAIe,MAAME,UAAUd,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIkB,MAAMC,aAAahB,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIkB,MAAME,eAAejB,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIkB,MAAMG,cAAclB,EAAG,OAAO,CAACH,EAAIQ,GAAG,MAAMR,EAAIS,GAAGT,EAAIe,MAAMO,QAAUtB,EAAIe,MAAMO,QAAU,IAAM,IAAM,SAASnB,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIuB,UAAUvB,EAAIkB,MAAMM,aAAa,OAAOrB,EAAG,OAAO,CAACH,EAAIQ,GAAG,QAAQR,EAAIS,GAAGT,EAAIyB,YAAYzB,EAAIkB,MAAMQ,eAAe,OAAOvB,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,OAAO,CAACH,EAAIQ,GAAG,WAAWL,EAAG,MAAM,CAACE,YAAY,SAAS,CAAEL,EAAIe,MAAe,UAAEZ,EAAG,OAAO,CAACH,EAAIQ,GAAG,OAAOL,EAAG,IAAI,CAACH,EAAIQ,GAAGR,EAAIS,GAAGT,EAAIe,MAAMY,UAAY3B,EAAIkB,MAAMG,gBAAgBrB,EAAI4B,KAAM5B,EAAIe,MAAmB,cAAEZ,EAAG,OAAO,CAACH,EAAIQ,GAAG,OAAOL,EAAG,IAAI,CAACH,EAAIQ,GAAGR,EAAIS,GAAGT,EAAIe,MAAMc,cAAgB7B,EAAIkB,MAAMG,gBAAgBrB,EAAI4B,KAAM5B,EAAIe,MAAkB,aAAEZ,EAAG,OAAO,CAACH,EAAIQ,GAAG,OAAOL,EAAG,IAAI,CAACH,EAAIQ,GAAGR,EAAIS,GAAGT,EAAIe,MAAMe,aAAe9B,EAAIkB,MAAMG,gBAAgBrB,EAAI4B,SAASzB,EAAG,OAAO,CAACH,EAAIQ,GAAG,MAAMR,EAAIS,GAAGT,EAAIkB,MAAMrC,QAAU,YAAYmB,EAAI4B,KAAM5B,EAAI+B,YAAY/B,EAAIhC,KAAKkD,OAAQf,EAAG,MAAM,CAACE,YAAY,YAAY,CAAiC,GAA/BL,EAAIhC,KAAKkD,MAAMQ,aAAmB,CAACvB,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIiC,OAAOjC,EAAIhC,KAAKkD,MAAM/C,OAAO,CAAC6B,EAAIQ,GAAG,UAAUL,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIkC,KAAKlC,EAAIhC,KAAKkD,MAAM/C,GAAI,cAAc,CAAC6B,EAAIQ,GAAG,UAAUL,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIkC,KAAKlC,EAAIhC,KAAKkD,MAAM/C,GAAI,aAAa,CAAC6B,EAAIQ,GAAG,WAAWR,EAAI4B,KAAqC,GAA/B5B,EAAIhC,KAAKkD,MAAMQ,aAAmBvB,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIf,UAAUe,EAAIhC,KAAKkD,MAAM/C,OAAO,CAAC6B,EAAIQ,GAAG,UAAUR,EAAI4B,KAAM5B,EAAImC,QAAQnC,EAAIhC,KAAKkD,OAAQf,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIhB,MAAMgB,EAAIhC,SAAS,CAACgC,EAAIQ,GAAG,UAAUR,EAAI4B,MAAM,GAAG5B,EAAI4B,OAAOzB,EAAG,YAAY,CAACW,MAAM,CAAC,MAAQd,EAAIiB,MAAM,QAAUjB,EAAIoC,cAAc,MAAQ,MAAM,eAAepC,EAAIqC,MAAM,eAAe,iBAAiB/B,GAAG,CAAC,iBAAiB,SAAS0B,GAAQhC,EAAIoC,cAAcJ,KAAU,CAAc,WAAZhC,EAAIsC,KAAmB,CAACnC,EAAG,UAAU,CAACoC,IAAI,eAAelC,YAAY,mBAAmBS,MAAM,CAAC,MAAQd,EAAIwC,aAAa,MAAQxC,EAAIyC,gBAAgB,CAACtC,EAAG,eAAe,CAACW,MAAM,CAAC,MAAQ,SAAS,KAAO,eAAe,CAACX,EAAG,YAAY,CAACuC,MAAM,CAACC,MAAO3C,EAAIwC,aAAuB,WAAEI,SAAS,SAAUC,GAAM7C,EAAI8C,KAAK9C,EAAIwC,aAAc,aAAcK,IAAME,WAAW,4BAA4B/C,EAAIgD,GAAIhD,EAAe,aAAE,SAASiD,EAAKC,GAAG,OAAO/C,EAAG,YAAY,CAACgD,IAAID,EAAEpC,MAAM,CAAC,MAAS,KAAQmC,EAAiB,aAAI,IAAOA,EAAkB,cAAI,MAASA,EAAa,SAAKA,EAAS,KAAKA,EAAS,KAAKA,EAAY,QAAG,MAAQA,EAAK9E,SAAQ,IAAI,GAAGgC,EAAG,eAAe,CAACA,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQN,EAAIqC,QAAQ,CAACrC,EAAIQ,GAAG,SAASL,EAAG,YAAY,CAACW,MAAM,CAAC,KAAO,WAAWR,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIoD,OAAO,mBAAmB,CAACpD,EAAIQ,GAAG,SAAS,MAAM,IAAI,CAACL,EAAG,UAAU,CAACoC,IAAI,cAAclC,YAAY,mBAAmBS,MAAM,CAAC,MAAQd,EAAIqD,YAAY,MAAQrD,EAAIsD,eAAe,CAACnD,EAAG,eAAe,CAACW,MAAM,CAAC,MAAQ,KAAK,KAAO,WAAW,CAACX,EAAG,WAAW,CAACW,MAAM,CAAC,KAAO,WAAW,KAAO,EAAE,YAAc,SAAS4B,MAAM,CAACC,MAAO3C,EAAIqD,YAAkB,OAAET,SAAS,SAAUC,GAAM7C,EAAI8C,KAAK9C,EAAIqD,YAAa,SAAUR,IAAME,WAAW,yBAAyB,GAAG5C,EAAG,eAAe,CAACA,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,YAAY,CAACG,GAAG,CAAC,MAAQN,EAAIqC,QAAQ,CAACrC,EAAIQ,GAAG,SAASL,EAAG,YAAY,CAACW,MAAM,CAAC,KAAO,WAAWR,GAAG,CAAC,MAAQ,SAAS0B,GAAQ,OAAOhC,EAAIoD,OAAO,kBAAkB,CAACpD,EAAIQ,GAAG,SAAS,MAAM,KAAK,IAAI,IAChpI+C,EAAkB,G,wDCoGP,GACfC,mBACAxF,gBACA,OACAA,QACAsE,QACAF,iBACAqB,eACAjB,cACAkB,eAEAjB,eACAiB,aAAAC,YAAAC,gBAAAC,oBAEAR,aACAxE,WAEAyE,cACAzE,SAAA8E,YAAAC,gBAAAC,oBAIAC,UACA3F,GADA,WAEA,8BAEA4F,UAJA,WAKA,qCAEArD,QAPA,WAQA,kCAEAQ,MAVA,WAWA,wBAEAH,MAbA,WAcA,wBAEAQ,UAhBA,WAiBA,eAEAE,YAnBA,WAoBA,eAEAR,MAtBA,WAuBA,6CAGA+C,SACAC,KADA,WACA,WACAnF,0CACA,uBAGAoF,YANA,WAMA,WACAvG,mCACA,mCAIAoE,YAZA,SAYA/D,GACA,YACA,0DAIAmE,QAlBA,SAkBAnE,GACA,MACA,qBAAI,EAAJ,aACA,yBACA,KAEA,UAGAiB,UA3BA,SA2BAd,GAAA,WACAc,mCACA,gCAGAsB,OAhCA,WAiCA,mBACAiD,YACA5F,QACAmG,6BAIA7B,KAxCA,SAwCA/D,EAAAgG,GACA,gBACA,sCACA,0EACA,mEACA,YACA,uBAEA9B,MAhDA,WAiDA,uBAGAJ,OApDA,SAoDA9D,GAAA,WACAY,oCACA,+BAEA,OADA,wCACA,SAKAC,MA7DA,SA6DAhB,GAAA,WACA,aACAgB,mCACA,+BAEA,OADA,sCACA,SAIAoE,OAtEA,SAsEAgB,GAAA,WACA,oCACA,IACA,kBACA3F,sEACA,YACAmF,iBACAO,iBAGA,4BACA,sDACA,GACA,MACA,iBAAI,EAAJ,OAAI,EAAJ,OAAI,EAAJ,UAAI,EAAJ,eAAI,EAAJ,gBACA,sBACA,oCACA,oCACA,kCAEA,aAEAvF,iEACA,YACAgF,iBACAO,iBAEA,yCACA,mBAMAE,QAxJA,WAyJA,uBC9PiZ,I,wBCQ7YC,EAAY,eACd,EACAvE,EACAwD,GACA,EACA,KACA,KACA,MAIa,aAAAe,E","file":"js/chunk-e2f0cb2c.594120d3.js","sourcesContent":["import { $pay } from \"@jx3box/jx3box-common/js/https\";\n// 获取地址列表\nfunction getAddress(params) {\n    return $pay().get(`/mall/ship-address`, params)\n}\n// 添加地址\nfunction addAddress(data) {\n    return $pay().post(`/mall/ship-address`, data)\n}\n// 更新地址\nfunction updateAddress(id, data) {\n    return $pay().put(`/mall/ship-address/${id}`, data)\n}\n// 删除地址\nfunction delAddress(id) {\n    return $pay().delete(`/mall/ship-address/${id}`)\n}\n// 设定默认地址\nfunction defaultAddress(id) {\n    return $pay().put(`/mall/ship-address/default/${id}`, )\n}\n// 获取我的订单\nfunction getOrder(params) {\n    return $pay().get(`/mall/my/orders`, { params })\n}\n// 更改订单的收货地址\nfunction updateOrderAddress(orderId, addressId) {\n    return $pay().put(`/mall/my/orders/${orderId}/bind-address/${addressId}`, )\n}\n// 修改订单备注\nfunction updateOrderRemark(id, remark) {\n    return $pay().put(`/mall/my/orders/${id}/remark`, { remark })\n}\n// 查看对应id的订单详情\nfunction getOrderId(id) {\n    return $pay().get(`/mall/my/orders/${id}`)\n}\n// 关闭订单\nfunction closeOrder(id) {\n    return $pay().put(`/mall/my/orders/${id}/cancel`, )\n}\n// 支付订单\nfunction toPay(id) {\n    return $pay().post(`/mall/my/orders/${id}/pay`);\n}\n// 确认收货\nfunction toConfirm(id) {\n    return $pay().post(`/mall/my/orders/${id}/received`);\n}\nexport {\n    getAddress,\n    addAddress,\n    updateAddress,\n    delAddress,\n    defaultAddress,\n    getOrder,\n    updateOrderAddress,\n    updateOrderRemark,\n    getOrderId,\n    closeOrder, \n    toPay,\n    toConfirm\n};","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./order_detail.vue?vue&type=style&index=0&lang=less&\"","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-mall-detail\"},[_c('div',{staticClass:\"m-breadcrumb\"},[_c('span',{staticClass:\"u-back\",on:{\"click\":_vm.goBack}},[_c('i',{staticClass:\"el-icon-arrow-left\"}),_vm._v(\" 返回\")])]),_c('div',{staticClass:\"m-content\"},[_c('div',{staticClass:\"m-address el-card\"},[_c('span',[_vm._v(\"收件人：\"+_vm._s(_vm.address.actual_contact))]),_c('span',[_vm._v(\"联系电话：\"+_vm._s(_vm.address.actual_phone))]),_c('span',[_vm._v(\"收货地址： \"+_vm._s(_vm.address.actual_address))])]),(_vm.goods)?_c('div',{staticClass:\"m-order el-card\"},[_c('img',{staticClass:\"u-img\",attrs:{\"src\":_vm.goods.goods_images[0]}}),_c('div',{staticClass:\"m-box\"},[_c('span',{staticClass:\"u-title\"},[_vm._v(_vm._s(_vm.goods.title))]),_c('span',[_vm._v(\"订单编号：\"+_vm._s(_vm.order.order_no))]),_c('span',[_vm._v(\"下单时间：\"+_vm._s(_vm.order.created_at))]),_c('span',[_vm._v(\"购买数量：\"+_vm._s(_vm.order.goods_num))]),_c('span',[_vm._v(\"邮费：\"+_vm._s(_vm.goods.postage ? _vm.goods.postage / 100 + \"元\" : \"包邮\"))]),_c('span',[_vm._v(\"支付状态：\"+_vm._s(_vm.payStatus[_vm.order.pay_status])+\" \")]),_c('span',[_vm._v(\"订单状态：\"+_vm._s(_vm.orderStatus[_vm.order.order_status])+\" \")]),_c('div',{staticClass:\"u-consume\"},[_c('span',[_vm._v(\"购买消耗：\")]),_c('div',{staticClass:\"u-box\"},[(_vm.goods.price_cny)?_c('span',[_vm._v(\"金箔：\"),_c('b',[_vm._v(_vm._s(_vm.goods.price_cny * _vm.order.goods_num))])]):_vm._e(),(_vm.goods.price_boxcoin)?_c('span',[_vm._v(\"盒币：\"),_c('b',[_vm._v(_vm._s(_vm.goods.price_boxcoin * _vm.order.goods_num))])]):_vm._e(),(_vm.goods.price_points)?_c('span',[_vm._v(\"积分：\"),_c('b',[_vm._v(_vm._s(_vm.goods.price_points * _vm.order.goods_num))])]):_vm._e()])]),_c('span',[_vm._v(\"备注：\"+_vm._s(_vm.order.remark || \"-\"))])])]):_vm._e(),(_vm.closeButton(_vm.data.order))?_c('div',{staticClass:\"m-button\"},[(_vm.data.order.order_status == 0)?[_c('el-button',{on:{\"click\":function($event){return _vm.cancel(_vm.data.order.id)}}},[_vm._v(\"取消订单\")]),_c('el-button',{on:{\"click\":function($event){return _vm.open(_vm.data.order.id, 'address')}}},[_vm._v(\"修改地址\")]),_c('el-button',{on:{\"click\":function($event){return _vm.open(_vm.data.order.id, 'remark')}}},[_vm._v(\"添加备注\")])]:_vm._e(),(_vm.data.order.order_status == 3)?_c('el-button',{on:{\"click\":function($event){return _vm.toConfirm(_vm.data.order.id)}}},[_vm._v(\"确认收货\")]):_vm._e(),(_vm.showPay(_vm.data.order))?_c('el-button',{on:{\"click\":function($event){return _vm.toPay(_vm.data)}}},[_vm._v(\"点击付款\")]):_vm._e()],2):_vm._e()]),_c('el-dialog',{attrs:{\"title\":_vm.title,\"visible\":_vm.dialogVisible,\"width\":\"30%\",\"before-close\":_vm.close,\"custom-class\":\"m-edit-dialog\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[(_vm.mode == 'address')?[_c('el-form',{ref:\"address_form\",staticClass:\"demo-form-inline\",attrs:{\"model\":_vm.address_form,\"rules\":_vm.address_rules}},[_c('el-form-item',{attrs:{\"label\":\"选择收货地址\",\"prop\":\"address_id\"}},[_c('el-select',{model:{value:(_vm.address_form.address_id),callback:function ($$v) {_vm.$set(_vm.address_form, \"address_id\", $$v)},expression:\"address_form.address_id\"}},_vm._l((_vm.addressList),function(item,i){return _c('el-option',{key:i,attrs:{\"label\":(\"【 \" + (item.contact_name) + \" \" + (item.contact_phone) + \" 】 \" + (item.province) + (item.city) + (item.area) + (item.address)),\"value\":item.id}})}),1)],1),_c('el-form-item',[_c('div',{staticClass:\"m-button\"},[_c('el-button',{on:{\"click\":_vm.close}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submit('address_form')}}},[_vm._v(\"确定\")])],1)])],1)]:[_c('el-form',{ref:\"remark_form\",staticClass:\"demo-form-inline\",attrs:{\"model\":_vm.remark_form,\"rules\":_vm.remark_rules}},[_c('el-form-item',{attrs:{\"label\":\"备注\",\"prop\":\"remark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":2,\"placeholder\":\"请输入备注\"},model:{value:(_vm.remark_form.remark),callback:function ($$v) {_vm.$set(_vm.remark_form, \"remark\", $$v)},expression:\"remark_form.remark\"}})],1),_c('el-form-item',[_c('div',{staticClass:\"m-button\"},[_c('el-button',{on:{\"click\":_vm.close}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submit('remark_form')}}},[_vm._v(\"确定\")])],1)])],1)]],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-mall-detail\">\n        <div class=\"m-breadcrumb\">\n            <span @click=\"goBack\" class=\"u-back\"><i class=\"el-icon-arrow-left\"></i> 返回</span>\n        </div>\n\n        <div class=\"m-content\">\n            <div class=\"m-address el-card\">\n                <span>收件人：{{ address.actual_contact }}</span>\n                <span>联系电话：{{ address.actual_phone }}</span>\n                <span>收货地址： {{ address.actual_address }}</span>\n            </div>\n            <div class=\"m-order el-card\" v-if=\"goods\">\n                <img class=\"u-img\" :src=\"goods.goods_images[0]\" />\n                <div class=\"m-box\">\n                    <span class=\"u-title\">{{ goods.title }}</span>\n                    <span>订单编号：{{ order.order_no }}</span>\n                    <span>下单时间：{{ order.created_at }}</span>\n                    <span>购买数量：{{ order.goods_num }}</span>\n                    <span>邮费：{{ goods.postage ? goods.postage / 100 + \"元\" : \"包邮\" }}</span>\n                    <span>支付状态：{{ payStatus[order.pay_status] }} </span>\n                    <span>订单状态：{{ orderStatus[order.order_status] }} </span>\n                    <div class=\"u-consume\">\n                        <span>购买消耗：</span>\n                        <div class=\"u-box\">\n                            <span v-if=\"goods.price_cny\"\n                                >金箔：<b>{{ goods.price_cny * order.goods_num }}</b></span\n                            >\n                            <span v-if=\"goods.price_boxcoin\"\n                                >盒币：<b>{{ goods.price_boxcoin * order.goods_num }}</b></span\n                            >\n                            <span v-if=\"goods.price_points\"\n                                >积分：<b>{{ goods.price_points * order.goods_num }}</b></span\n                            >\n                        </div>\n                    </div>\n                    <span>备注：{{ order.remark || \"-\" }}</span>\n                </div>\n            </div>\n            <div class=\"m-button\" v-if=\"closeButton(data.order)\">\n                <template v-if=\"data.order.order_status == 0\">\n                    <el-button @click=\"cancel(data.order.id)\">取消订单</el-button>\n                    <el-button @click=\"open(data.order.id, 'address')\">修改地址</el-button>\n                    <el-button @click=\"open(data.order.id, 'remark')\">添加备注</el-button>\n                </template>\n\n                <el-button @click=\"toConfirm(data.order.id)\" v-if=\"data.order.order_status == 3\">确认收货</el-button>\n                <el-button @click=\"toPay(data)\" v-if=\"showPay(data.order)\">点击付款</el-button>\n            </div>\n        </div>\n\n        <!-- 弹窗 -->\n        <el-dialog\n            :title=\"title\"\n            :visible.sync=\"dialogVisible\"\n            width=\"30%\"\n            :before-close=\"close\"\n            custom-class=\"m-edit-dialog\"\n        >\n            <template v-if=\"mode == 'address'\">\n                <el-form ref=\"address_form\" :model=\"address_form\" :rules=\"address_rules\" class=\"demo-form-inline\">\n                    <el-form-item label=\"选择收货地址\" prop=\"address_id\">\n                        <el-select v-model=\"address_form.address_id\">\n                            <el-option\n                                :label=\"`【 ${item.contact_name} ${item.contact_phone} 】 ${item.province}${item.city}${item.area}${item.address}`\"\n                                :value=\"item.id\"\n                                v-for=\"(item, i) in addressList\"\n                                :key=\"i\"\n                            ></el-option>\n                        </el-select>\n                    </el-form-item>\n                    <el-form-item>\n                        <div class=\"m-button\">\n                            <el-button @click=\"close\">取 消</el-button>\n                            <el-button type=\"primary\" @click=\"submit('address_form')\">确定</el-button>\n                        </div>\n                    </el-form-item>\n                </el-form>\n            </template>\n            <template v-else>\n                <el-form ref=\"remark_form\" :model=\"remark_form\" :rules=\"remark_rules\" class=\"demo-form-inline\">\n                    <el-form-item label=\"备注\" prop=\"remark\">\n                        <el-input type=\"textarea\" :rows=\"2\" placeholder=\"请输入备注\" v-model=\"remark_form.remark\">\n                        </el-input>\n                    </el-form-item>\n                    <el-form-item>\n                        <div class=\"m-button\">\n                            <el-button @click=\"close\">取 消</el-button>\n                            <el-button type=\"primary\" @click=\"submit('remark_form')\">确定</el-button>\n                        </div>\n                    </el-form-item>\n                </el-form>\n            </template>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport { updateOrderAddress, updateOrderRemark, getAddress, closeOrder, toPay, toConfirm } from \"@/service/goods\";\nimport { getOrderId } from \"@/service/goods\";\nimport { orderStatus, payStatus } from \"../assets/data/mall.json\";\nexport default {\n    name: \"orderDetail\",\n    data: function () {\n        return {\n            data: {},\n            mode: \"\",\n            dialogVisible: false,\n            addressList: [],\n            address_form: {\n                address_id: \"\",\n            },\n            address_rules: {\n                address_id: [{ required: true, message: \"请选择地址\", trigger: \"change\" }],\n            },\n            remark_form: {\n                remark: \"\",\n            },\n            remark_rules: {\n                remark: [{ required: true, message: \"请输入备注\", trigger: \"blur\" }],\n            },\n        };\n    },\n    computed: {\n        id() {\n            return this.$route.params.id;\n        },\n        pageIndex() {\n            return this.$route.params.pageIndex;\n        },\n        address() {\n            return this.data.shipAddress || {};\n        },\n        order() {\n            return this.data.order;\n        },\n        goods() {\n            return this.data.goods;\n        },\n        payStatus() {\n            return payStatus;\n        },\n        orderStatus() {\n            return orderStatus;\n        },\n        title() {\n            return this.mode == \"address\" ? \"修改收货地址\" : \"修改备注\";\n        },\n    },\n    methods: {\n        load() {\n            getOrderId(this.id).then((res) => {\n                this.data = res.data.data;\n            });\n        },\n        loadAddress() {\n            getAddress().then((res) => {\n                this.addressList = res.data.data.list;\n            });\n        },\n        // 订单关闭不显示按钮\n        closeButton(data) {\n            if (!data) return false;\n            if (data.order_status == 1 || data.order_status == 2 || data.order_status == 7) return false;\n            return true;\n        },\n        // 显示支付按钮\n        showPay(data) {\n            if (data) {\n                const { order_status, pay_status } = data;\n                if (order_status == 1 || order_status == 2 || order_status == 7) return false;\n                return pay_status == 0 ? true : false;\n            }\n            return false;\n        },\n        // 确认收货\n        toConfirm(id) {\n            toConfirm(id).then(() => {\n                this.data.order.order_status = 4;\n            });\n        },\n        goBack() {\n            this.$router.push({\n                name: \"mall\",\n                params: {\n                    pageIndex: this.pageIndex,\n                },\n            });\n        },\n        open(id, type) {\n            this.order_id = id;\n            if (type == \"address\") this.loadAddress();\n            if (this.$refs.address_form !== undefined) this.$refs.address_form.clearValidate();\n            if (this.$refs.remark_form !== undefined) this.$refs.remark_form.clearValidate();\n            this.mode = type;\n            this.dialogVisible = true;\n        },\n        close() {\n            this.dialogVisible = false;\n        },\n        // 关闭订单\n        cancel(id) {\n            closeOrder(id).then((res) => {\n                this.list = this.list.map((item) => {\n                    if (item.order.id == id) item.order.order_status = 1;\n                    return item;\n                });\n            });\n        },\n        // 支付\n        toPay(data) {\n            const id = data.order.id;\n            toPay(id).then(() => {\n                this.list = this.list.map((item) => {\n                    if (item.order.id == id) item.order.pay_status = 1;\n                    return item;\n                });\n            });\n        },\n        submit(formName) {\n            this.$refs[formName].validate((valid) => {\n                if (valid) {\n                    this.mode == \"address\"\n                        ? updateOrderAddress(this.order_id, this.address_form.address_id).then(() => {\n                              this.$message({\n                                  message: \"修改地址成功\",\n                                  type: \"success\",\n                              });\n\n                              const list = this.addressList.filter(\n                                  (item) => item.id == this.address_form.address_id\n                              )[0];\n                              if (list) {\n                                  const { province, city, area, address, contact_name, contact_phone } = list;\n                                  const actual_address = province + \" \" + city + \" \" + area + \" \" + address;\n                                  this.data.shipAddress.actual_address = actual_address;\n                                  this.data.shipAddress.actual_contact = contact_name;\n                                  this.data.shipAddress.actual_phone = contact_phone;\n                              }\n                              this.close();\n                          })\n                        : updateOrderRemark(this.order_id, this.remark_form.remark).then(() => {\n                              this.$message({\n                                  message: \"修改备注成功\",\n                                  type: \"success\",\n                              });\n                              this.data.order.remark = this.remark_form.remark;\n                              this.close();\n                          });\n                }\n            });\n        },\n    },\n    mounted() {\n        if (this.id) this.load();\n    },\n};\n</script>\n<style lang=\"less\">\n@import \"../assets/css/order_detail.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./order_detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./order_detail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./order_detail.vue?vue&type=template&id=c8afa22a&\"\nimport script from \"./order_detail.vue?vue&type=script&lang=js&\"\nexport * from \"./order_detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./order_detail.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}