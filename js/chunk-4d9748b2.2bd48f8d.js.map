{"version":3,"sources":["webpack:///./src/publish/share.vue?99dd","webpack:///./src/components/publish/album.vue?8af1","webpack:///./src/components/publish/album.vue?f2ef","webpack:///src/components/publish/album.vue","webpack:///./src/components/publish/album.vue?4803","webpack:///./src/components/publish/album.vue","webpack:///./src/publish/share.vue?0628","webpack:///./src/service/share.js","webpack:///src/publish/share.vue","webpack:///./src/publish/share.vue?e894","webpack:///./src/publish/share.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","API","accept","fileList","change","handlePictureCardPreview","handleRemove","slot","dialogVisible","on","$event","dialogImageUrl","staticRenderFns","component","name","type","post","meta","extend","toPublish","toDraft","model","value","callback","$$v","$set","expression","_l","options","i","key","_v","_s","post_meta","pics","updateAlbum","uploadData","selectData","directives","rawName","_e","formdata","vm","$","__server","parseData","data","__node","raw"],"mappings":"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","file":"js/chunk-4d9748b2.2bd48f8d.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./share.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./share.vue?vue&type=style&index=0&lang=less&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./album.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./album.vue?vue&type=style&index=0&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"c-album\"},[_c('el-upload',{ref:\"uploadbox\",attrs:{\"action\":_vm.API,\"with-credentials\":\"\",\"list-type\":\"picture-card\",\"auto-upload\":false,\"accept\":_vm.accept,\"limit\":10,\"multiple\":\"\",\"file-list\":_vm.fileList,\"on-change\":_vm.change,\"on-preview\":_vm.handlePictureCardPreview,\"on-remove\":_vm.handleRemove}},[_c('i',{staticClass:\"el-icon-plus\",attrs:{\"slot\":\"default\"},slot:\"default\"})]),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"c-album\">\n        <el-upload\n            :action=\"API\"\n            with-credentials\n            list-type=\"picture-card\"\n            :auto-upload=\"false\"\n            :accept=\"accept\"\n            :limit=\"10\"\n            multiple\n            :file-list=\"fileList\"\n            :on-change=\"change\"\n            :on-preview=\"handlePictureCardPreview\"\n            :on-remove=\"handleRemove\"\n            ref=\"uploadbox\"\n        >\n            <i slot=\"default\" class=\"el-icon-plus\"></i>\n        </el-upload>\n        <el-dialog :visible.sync=\"dialogVisible\">\n            <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport allow_types from \"@jx3box/jx3box-common/js/conf\";\nimport { __server } from \"@jx3box/jx3box-common/js/jx3box.json\";\nimport {axios} from \"@/service/axios\";\n// import draggable from 'vuedraggable'\nconst imgtypes = [\"jpg\", \"png\", \"gif\", \"bmp\"];\nconst API = __server + \"upload\";\nexport default {\n    name: \"album\",\n    props: [\"imgList\"],\n    data: function() {\n        return {\n            API,\n            fileList: this.imgList || [],\n            accept: allow_types.accept,\n            sizeLimit: allow_types.sizeLimit,\n            dialogImageUrl: \"\",\n            dialogVisible: false,\n        };\n    },\n    computed: {},\n    methods: {\n        change: function(file, fileList) {\n            if (file.status != \"success\") {\n                // 判断大小\n                if (file.size > this.sizeLimit) {\n                    this.$message.error(\"文件超出大小限制\");\n                    this.removeFile(fileList, file.uid);\n                    return;\n                }\n\n                // 构建数据\n                let fdata = new FormData();\n                fdata.append(\"file\", file.raw);\n\n                // 异步上传\n                axios\n                    .post(API, fdata, {\n                        headers: { \"Content-Type\": \"multipart/form-data\" },\n                        withCredentials: true,\n                    })\n                    .then((res) => {\n                        // 提醒\n                        this.$message({\n                            message: \"上传成功\",\n                            type: \"success\",\n                        });\n\n                        // 修改path\n                        file.url = res.data.data.list[0];\n\n                        // // 分析文件类型\n                        // let ext = file.name.split(\".\").pop();\n                        // let is_img = imgtypes.includes(ext);\n\n                        // // 额外赋值\n                        // file.is_img = is_img;\n                        // file.selected = false;\n\n                        // 修改状态加入仓库\n                        file.status = \"success\";\n                        this.fileList.push(file);\n                        this.$emit(\"albumChange\", this.fileList);\n                    })\n            }\n        },\n        handleRemove(file, fileList) {\n            this.fileList = fileList;\n            this.$emit(\"albumChange\", this.fileList);\n        },\n        handlePictureCardPreview(file) {\n            this.dialogImageUrl = file.url;\n            this.dialogVisible = true;\n        },\n        removeFile: function(fileList, uid) {\n            fileList.forEach((file, i) => {\n                if (file.uid == uid) {\n                    fileList.splice(i, 1);\n                }\n            });\n        },\n    },\n    mounted: function() {},\n    components: {\n        // draggable\n    },\n};\n</script>\n\n<style lang=\"less\">\n.c-album {\n    .el-dialog__body {\n        padding-top: 0;\n    }\n\n    .el-upload-list li {\n        outline: none;\n    }\n\n    .el-upload-list__item {\n        &:hover {\n            border: 1px solid #13ce66;\n        }\n    }\n\n    // 列表\n    .u-file-wrapper {\n        .size(100%);\n        &.isSelected {\n        }\n        &.disabled {\n            cursor: default;\n            opacity: 0.38;\n            border-color: #eee;\n            .u-fileplaceholder {\n                fill: #aaa;\n            }\n        }\n        .pointer;\n    }\n    .u-filebox {\n        .x;\n        padding: 37px;\n    }\n    .u-fileplaceholder {\n        width: 40px;\n        height: 40px;\n        fill: @primary;\n    }\n    .u-filename {\n        .db;\n        .nobreak;\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./album.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./album.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./album.vue?vue&type=template&id=50108348&\"\nimport script from \"./album.vue?vue&type=script&lang=js&\"\nexport * from \"./album.vue?vue&type=script&lang=js&\"\nimport style0 from \"./album.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-dashboard-publish-share\"},[(_vm.loaded)?_c('boilerplate',{attrs:{\"name\":_vm.name,\"type\":_vm.type,\"post\":_vm.post,\"meta\":_vm.meta,\"extend\":_vm.extend,\"infoEnable\":true,\"contentEnable\":false,\"markdownEnable\":false,\"excerptEnable\":false,\"tagEnable\":false,\"notifyEnable\":false,\"bannerEnable\":false},on:{\"publish\":_vm.toPublish,\"draft\":_vm.toDraft}},[[_c('el-form-item',{attrs:{\"label\":\"原创\"}},[_c('el-switch',{attrs:{\"active-color\":\"#13ce66\"},model:{value:(_vm.post.original),callback:function ($$v) {_vm.$set(_vm.post, \"original\", $$v)},expression:\"post.original\"}})],1),_c('el-form-item',{attrs:{\"label\":\"类型\"}},[_c('el-radio-group',{model:{value:(_vm.post.post_subtype),callback:function ($$v) {_vm.$set(_vm.post, \"post_subtype\", $$v)},expression:\"post.post_subtype\"}},_vm._l((_vm.options.types),function(type,i){return _c('el-radio',{key:i,attrs:{\"border\":\"\",\"label\":type}},[_vm._v(_vm._s(type))])}),1)],1),_c('el-form-item',{attrs:{\"label\":\"作者\"}},[_c('el-input',{attrs:{\"placeholder\":\"请注明原作者\"},model:{value:(_vm.post.post_meta.author),callback:function ($$v) {_vm.$set(_vm.post.post_meta, \"author\", $$v)},expression:\"post.post_meta.author\"}})],1),_c('el-form-item',{attrs:{\"label\":\"图册\"}},[_c('album',{attrs:{\"imgList\":_vm.post.post_meta.pics},on:{\"albumChange\":_vm.updateAlbum}})],1),_c('el-form-item',{attrs:{\"label\":\"数据\"}},[_c('input',{staticClass:\"u-data-input\",attrs:{\"type\":\"file\",\"id\":\"face_file\"},on:{\"change\":_vm.uploadData}}),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-upload2\"},on:{\"click\":_vm.selectData}},[_vm._v(\"上传脸型数据\")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.post.post_meta.file),expression:\"post.post_meta.file\"}],staticClass:\"u-data-ready\"},[_c('i',{staticClass:\"el-icon-success\"}),_vm._v(\" 已上传 \")])],1),_c('el-form-item',{attrs:{\"label\":\"分析结果\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":6},model:{value:(_vm.post.post_meta.data),callback:function ($$v) {_vm.$set(_vm.post.post_meta, \"data\", $$v)},expression:\"post.post_meta.data\"}})],1)]],2):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $ } from \"./axios\";\nimport { __node, __Root } from \"@jx3box/jx3box-common/js/jx3box.json\";\n\nfunction uploadData(formdata, vm) {\n    return $.post(__server + \"upload/data\", formdata)\n}\n\nfunction parseData(data,vm) {\n    return $.post(__node + \"facedat\", {\n        raw : data\n    })\n    \n}\n\nexport { uploadData, parseData };\n","<template>\n    <div class=\"m-dashboard-publish-share\">\n        <!-- 💛 预设选项 -->\n        <!-- \n            localDraft : 是否显示本地草稿按钮\n            infoEnable : 是否包含自定义字段\n            markdownEnable : 是否开启markdown编辑器\n            excerptEnable : 是否开启摘要\n            tagEnable : 是否开启标签\n            notifyEnable : 是否开启通知等扩展功能\n            bannerEnable : 是否开启头条图功能,开启后仍旧需要签约作者及管理员才可见\n         -->\n        <boilerplate\n            v-if=\"loaded\"\n            :name=\"name\"\n            :type=\"type\"\n            :post=\"post\"\n            :meta=\"meta\"\n            :extend=\"extend\"\n            :infoEnable=\"true\"\n            :contentEnable=\"false\"\n            :markdownEnable=\"false\"\n            :excerptEnable=\"false\"\n            :tagEnable=\"false\"\n            :notifyEnable=\"false\"\n            :bannerEnable=\"false\"\n            @publish=\"toPublish\"\n            @draft=\"toDraft\"\n        >\n            <template>\n                <el-form-item label=\"原创\">\n                    <el-switch\n                        v-model=\"post.original\"\n                        active-color=\"#13ce66\"\n                    >\n                    </el-switch>\n                </el-form-item>\n                \n                <el-form-item label=\"类型\">\n                    <el-radio-group v-model=\"post.post_subtype\">\n                        <el-radio\n                            border\n                            v-for=\"(type, i) in options.types\"\n                            :label=\"type\"\n                            :key=\"i\"\n                            >{{ type }}</el-radio\n                        >\n                    </el-radio-group>\n                </el-form-item>\n\n                <el-form-item label=\"作者\">\n                    <el-input\n                        v-model=\"post.post_meta.author\"\n                        placeholder=\"请注明原作者\"\n                    ></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"图册\">\n                    <album\n                        :imgList=\"post.post_meta.pics\"\n                        @albumChange=\"updateAlbum\"\n                    ></album>\n                </el-form-item>\n\n                <el-form-item label=\"数据\">\n                    <input\n                        class=\"u-data-input\"\n                        type=\"file\"\n                        id=\"face_file\"\n                        @change=\"uploadData\"\n                    />\n                    <el-button\n                        type=\"primary\"\n                        @click=\"selectData\"\n                        icon=\"el-icon-upload2\"\n                        >上传脸型数据</el-button\n                    >\n                    <span class=\"u-data-ready\" v-show=\"post.post_meta.file\">\n                        <i class=\"el-icon-success\"></i>\n                        已上传\n                    </span>\n                </el-form-item>\n\n                <el-form-item label=\"分析结果\">\n                    <el-input\n                        v-model=\"post.post_meta.data\"\n                        type=\"textarea\"\n                        :rows=\"6\"\n                    ></el-input>\n                </el-form-item>\n            </template>\n        </boilerplate>\n    </div>\n</template>\n\n<script>\nimport boilerplate from \"@/components/publish/boilerplate\";\nimport { __ossMirror } from \"@jx3box/jx3box-common/js/jx3box.json\";\nimport album from \"@/components/publish/album.vue\";\n// import lodash from \"lodash\";\nimport { uploadData, parseData } from \"../service/share.js\";\nconst types = [\"成男\", \"成女\", \"正太\", \"萝莉\"];\n\nexport default {\n    name: \"share\",\n    props: [],\n    data: function() {\n        return {\n            //基本 - 类型设置\n            type: \"share\",\n            name: \"捏脸分享\",\n            loaded: false,\n\n            //选项\n            options: {\n                types: types,\n            },\n\n            //字段\n            meta: {},\n\n            //文章 - 主表数据\n            post: {\n                ID: \"\", //文章ID\n                // post_author               //无需设置,由token自动获取\n                // post_type:\"\",             //类型(默认由boilerplate托管)\n                post_subtype: \"成男\", //子类型(过滤查询用)\n                post_title: \"\", //标题\n                post_content: \"\", //主表内容字段,由后端接口配置是否双存储至meta表\n                post_meta: {\n                    author: \"\", //原作者\n                    pics: [], //图片\n                    file: \"\", //文件\n                    data: \"\", //解析数据\n                },\n                post_excerpt: \"\", //主表摘要\n                post_mode: \"tinymce\", //编辑模式(会影响文章详情页渲染规则)\n                post_banner: \"\", //头条图,管理员可见\n                post_status: \"\", //由发布按钮、草稿按钮决定\n                // post_tags: [],            //标签列表\n                original:0\n            },\n\n            //扩展 - 部分栏目文章不应启用该功能\n            extend: {\n                feedEnable: false, //是否通知订阅用户\n                followEnable: false, //是否通知粉丝\n                tencentEnable: false, //是否同步至腾讯文档\n                weiboEnable: false, //是否同步至微博头条文章\n                tuilanEnable: false, //是否同步至推栏\n            },\n        };\n    },\n    computed: {},\n    methods: {\n        // 发布\n        toPublish: function() {\n            // console.log(this.build());\n            this.doPublish(this.build(), this).then((res) => {});\n        },\n        // 草稿\n        toDraft: function() {\n            this.doDraft(this.build(), this).then((res) => {});\n        },\n        // 设置检索meta\n        build: function() {\n            let data = this.$store.state;\n            data.post.meta_1 = data.post.post_meta.author   //原作者\n            return data;\n        },\n        // 加载\n        init: function() {\n            return this.doLoad(this).then((data) => {});\n        },\n\n        // 图集\n        updateAlbum: function(filelist) {\n            let imglist = [];\n            filelist.forEach((img) => {\n                imglist.push({\n                    name: img.name,\n                    url: img.url,\n                });\n            });\n            this.post.post_meta.pics = imglist;\n        },\n        // 数据\n        selectData: function(i) {\n            let fileInput = document.getElementById(\"face_file\");\n            fileInput.dispatchEvent(new MouseEvent(\"click\"));\n        },\n        uploadData: function(e) {\n            let formdata = new FormData();\n            let file = e.target.files[0];\n            formdata.append(\"file\", file);\n            uploadData(formdata, this).then((res) => {\n                this.post.post_meta.file = res.data.data.list[0];\n                this.$message({\n                    message: res.data.msg,\n                    type: \"success\",\n                });\n            });\n            this.parseData(file);\n        },\n        // 解析数据\n        parseData: function(facedata) {\n            // 如果不支持本地读取\n            if (!FileReader) return;\n            const vm = this;\n\n            let fr = new FileReader();\n            fr.readAsText(facedata);\n            fr.onload = function(e) {\n                console.log(\"读取成功...开始执行分析...\");\n                parseData(e.target.result,vm)\n                    .then((res) => {\n                        vm.post.post_meta.data = JSON.stringify(res.data.data);\n                        return res.data.status;\n                    })\n                    .then((status) => {\n                        if (status) {\n                            vm.$notify({\n                                title: \"成功\",\n                                message: \"脸型数据解析成功\",\n                                type: \"success\",\n                            });\n                        } else {\n                            vm.$notify.error({\n                                title: \"错误\",\n                                message: \"无法解析脸型数据\",\n                            });\n                        }\n                    })\n            };\n            fr.onerror = function(e) {\n                vm.$notify.error({\n                    title: \"错误\",\n                    message: \"无法解析脸型数据\",\n                });\n            };\n        },\n    },\n    filters: {},\n    mounted: function() {\n        // 初始化默认文章数据\n        this.init().then(() => {\n            console.log(\"Init Post:\", this.post);\n        });\n    },\n    components: {\n        boilerplate,\n        album,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/publish/share.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./share.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./share.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./share.vue?vue&type=template&id=33c1fc5a&\"\nimport script from \"./share.vue?vue&type=script&lang=js&\"\nexport * from \"./share.vue?vue&type=script&lang=js&\"\nimport style0 from \"./share.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}