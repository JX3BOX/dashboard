(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cfdd188a"],{"0b60":function(t,a,e){"use strict";var n=e("4d2a"),s=e.n(n);s.a},"33de":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"m-dashboard m-dashboard-work m-dashboard-msg"},[e("div",{staticClass:"m-dashboard-msg-header"},[e("h2",{staticClass:"u-title"},[t._v(" 我的消息 ")]),e("el-button",{staticClass:"u-read-all",attrs:{type:"primary",size:"mini",disabled:!t.unread_total},on:{click:function(a){return t.read(null)}}},[e("i",{staticClass:"el-icon el-icon-check"}),e("span",{domProps:{textContent:t._s("全部设为已读")}})])],1),t.data.length?e("ul",{staticClass:"m-dashboard-box-list"},t._l(t.data,(function(a,n){return e("li",{directives:[{name:"show",rawName:"v-show",value:0==a.deleted,expression:"item.deleted == 0"}],key:n,class:{on:1==a.read}},[e("div",{staticClass:"u-primary"},[e("span",{staticClass:"u-content"},[1==a.read?e("span",{staticClass:"u-label u-hasChecked"},[t._v("已读")]):e("span",{staticClass:"u-label u-hasNotChecked"},[t._v("未读")]),e("span",{domProps:{innerHTML:t._s(a.content)}}),a.source_id&&a.source_type?e("a",{staticClass:"u-msg-link",attrs:{href:t._f("msgLink")(a),target:"_blank"},on:{click:function(e){return t.read(a)}}},[e("i",{staticClass:"el-icon-link"}),t._v(" 点击查看")]):t._e()]),e("time",{staticClass:"u-time"},[e("i",{staticClass:"el-icon-phone-outline"}),t._v(" "+t._s(t.dateFormat(~~a.created)))])]),e("el-button-group",{staticClass:"u-action"},[e("el-button",{attrs:{size:"mini",icon:"el-icon-check",title:"设为已读",disabled:1==a.read},on:{click:function(e){return t.read(a)}}}),e("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.del(a)}}})],1)],1)})),0):e("el-alert",{staticClass:"m-dashboard-box-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-pagination",{staticClass:"m-dashboard-box-pages",attrs:{background:"","hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.changePage}})],1)},s=[],i=e("2777"),r=e("4328");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return i["b"].get("/api/messages",{headers:{Accept:"application/prs.helper.v2+json"},params:{page:t}})}function c(t){var a={};return t&&(a.ids=t),i["b"].put("/api/messages/read",r.stringify(a),{headers:{Accept:"application/prs.helper.v2+json"}})}function l(t){return i["b"].put("/api/messages/remove",r.stringify({ids:t}),{headers:{Accept:"application/prs.helper.v2+json"}})}var d=e("e4f1"),u=e("85e4"),p={name:"msg",props:[],data:function(){return{type:"all",data:[],unread_total:0,total:1,page:1}},methods:{changePage:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=a,o(a).then((function(a){t.unread_total=a.data.data.unread_count,t.total=a.data.data.total,t.data=a.data.data.messages}))},read:function(t){var a=this;c(t?[t.ID]:null).then((function(e){200===e.data.code?t?t.read=1:a.changePage(a.page):a.$notify.error({title:e.data.message})}))},del:function(t){var a=this;l([t.ID]).then((function(e){200===e.data.code?t.deleted=Math.round(new Date/1e3):a.$notify.error({title:e.data.message})}))},dateFormat:function(t){return Object(d["b"])(new Date(1e3*t))}},filters:{msgLink:function(t){var a=t.source_id,e=t.source_type;return Object(u["getLink"])(e,a)}},mounted:function(){this.changePage()}},h=p,g=(e("0b60"),e("2877")),m=Object(g["a"])(h,n,s,!1,null,"a040db1c",null);a["default"]=m.exports},"4d2a":function(t,a,e){}}]);
//# sourceMappingURL=chunk-cfdd188a.21734123.js.map