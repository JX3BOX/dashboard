(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b12b8dc"],{"0cd3":function(t){t.exports=JSON.parse('{"1":"充值","-2":"金箔消费","-3":"作品消费"}')},"31dd":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-credit m-boxcoin m-cny"},[t._m(0),a("div",{staticClass:"m-credit-total m-packet-total"},[t._v(" 余额 : "),a("b",{class:{hasLeft:t.hasLeft}},[t._v(t._s(t.money))]),a("a",{staticClass:"el-button u-btn el-button--primary el-button--mini",attrs:{href:"/vip/cny",target:"_blank"}},[t._v("充值")]),a("el-button",{staticClass:"u-btn",attrs:{type:"primary",size:"mini",disabled:!t.money},on:{click:t.togglePullBox}},[t._v("提现")])],1),t.showPullBox?a("div",{staticClass:"m-credit-pull"},[t.breadcrumb?a("el-alert",{staticClass:"m-boxcoin-ac",attrs:{type:"error","show-icon":"",closable:!1,size:"mini"}},[t._t("title",(function(){return[a("div",{domProps:{innerHTML:t._s(t.breadcrumb)}})]}))],2):t._e(),a("el-alert",{staticClass:"m-boxcoin-tip",attrs:{title:"100金箔可兑换1元人民币，最小兑换起步100金箔",type:"warning","show-icon":""}},[t._t("description",(function(){return[t._v("每个月6~30日开放提现，1~5日关闭提现渠道进行汇总。（即1月6日的兑换，和1月30日的兑换，同样在2月1~5日进行汇总）"),a("br"),t._v(" 每笔提现收取2%手续费，最低收取0.02元。收取规则：不满1元部分按1元计算，计算手续费时向上取整。"),a("br"),t._v(" 比如提现15.5元，16.2向取整，分别按16，17元收取0.32元和0.34元。"),a("br"),t._v(" 汇总后，通常7个工作日内转账至收款账号。")]}))],2),a("el-form",{staticClass:"m-boxcoin-form",attrs:{"label-position":"left","label-width":"80px",model:t.pull}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.pull.pay_type,callback:function(e){t.$set(t.pull,"pay_type",e)},expression:"pull.pay_type"}},t._l(t.paytypes,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{placeholder:"请务必填写正确的收款账号"},model:{value:t.pull.account,callback:function(e){t.$set(t.pull,"account",e)},expression:"pull.account"}})],1),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"请务必填写正确的收款人"},model:{value:t.pull.username,callback:function(e){t.$set(t.pull,"username",e)},expression:"pull.username"}})],1),a("el-form-item",{attrs:{label:"数量"}},[a("el-input-number",{attrs:{max:t.money,min:100,step:100,placeholder:"请务必填写正确的金额"},model:{value:t.pull.money,callback:function(e){t.$set(t.pull,"money",t._n(e))},expression:"pull.money"}},[a("template",{slot:"append"},[t._v("金箔（分）")])],2),t.pull.money?a("div",{staticClass:"u-tip"},[t._v(" 手续费"+t._s(t.formatMoney(t.fee))+"元，实际到账"+t._s(t.formatMoney(t.real))+"元 ")]):t._e()],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",disabled:!t.ready||t.lockStatus},on:{click:t.openConfirmBox}},[t._v("提交申请")]),t.isAllowDate?t._e():a("span",{staticClass:"u-tip"},[a("i",{staticClass:"el-icon-warning-outline"}),t._v(" 每月"+t._s(t.start_date)+"-"+t._s(t.end_date)+"日结算期间不能进行提现申请 ")])],1)],1)],1):t._e(),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-credit-table m-packet-table"},[a("el-tabs",{attrs:{type:"border-card"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("el-tab-pane",{attrs:{label:"变动记录",name:"list"}},[t.list&&t.list.length?a("div",{staticClass:"m-packet-table"},[a("table",{staticClass:"m-boxcoin-in-list m-packet-in-list"},[a("tr",[a("th",[t._v("类型")]),a("th",[t._v("来源")]),a("th",[t._v("去向")]),a("th",[t._v("数量")]),a("th",[t._v("备注")]),a("th",[t._v("时间")])]),t._l(t.list,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(t.formatType(e.use_case)))]),a("td",[e.pay_user?a("a",{staticClass:"u-user",attrs:{href:t.authorLink(e.pay_user.id)}},[a("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(e.pay_user.avatar),alt:""}}),t._v(" "+t._s(e.pay_user.display_name)+" ")]):a("span",[t._v("系统")])]),a("td",[e.access_user?a("a",{staticClass:"u-user",attrs:{href:t.authorLink(e.access_user.id)}},[a("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(e.access_user.avatar),alt:""}}),t._v(" "+t._s(e.access_user.display_name)+" ")]):t._e()]),a("td",{staticClass:"u-count",class:{isNegative:!t.isIncome(e)}},[a("span",[t._v(t._s(t.isIncome(e)?"+":"-"))]),a("b",[t._v(t._s(e.money))])]),a("td",[a("span",{attrs:{title:e.remark}},[t._v(t._s(t.formatRemark(e.remark)))])]),a("td",[t._v(t._s(t.formatDate(e.created_at)))])])}))],2)]):a("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),a("el-pagination",{staticClass:"m-credit-pages m-packet-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)],1)],1)])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",{staticClass:"u-title"},[a("i",{staticClass:"el-icon-wallet"}),t._v(" 我的金箔")])}],i=(a("caad"),a("2532"),a("99af"),a("d3b7"),a("b680"),a("fb6a"),a("a9e3"),a("e4f1")),r=a("0cd3"),l=a("9deb"),o=a("cc9a"),c=a("41cb"),u=function(t){return Object(c["e"])().post("/api/cny/cashout/apply",t)},p=function(){return Object(c["e"])().get("/api/vip/i").then((function(t){return t.data.data.cny||0}))};function d(t){return Object(c["e"])().get("/api/my/cny/history",{params:t})}var m=a("46f4"),f=a("c9d2"),h=a("85e4"),b={name:"Cny",props:[],data:function(){return{money:0,pull:{username:"",account:"",pay_type:"alipay",money:100},showPullBox:!1,lockStatus:!1,formStatus:!1,breadcrumb:"",dates:[],paytypes:l,list:[],page:1,per:10,total:1,tab:"list",loading:!1}},computed:{hasLeft:function(){return this.money>100},fee:function(){return Math.max(2*Math.ceil(this.pull.money/100),2)},real:function(){return this.pull.money-this.fee},start_date:function(){return this.dates[0]},end_date:function(){return this.dates[this.dates.length-1]},isAllowDate:function(){var t=(new Date).getDate();return!this.dates.includes(t)},canCash:function(){return this.hasLeft&&this.isAllowDate&&this.pull.money<=this.money},ready:function(){return this.canCash&&this.formStatus},params:function(){var t={pageIndex:this.page,pageSize:this.per};return t},uid:function(){return f["a"].getInfo().uid}},methods:{init:function(){var t=this;Object(m["c"])().then((function(e){t.dates=JSON.parse(e.data.data.val)})),this.loadAsset(),this.loadAc(),this.loadData()},loadAsset:function(){var t=this;p().then((function(e){t.money=e,console.log(e,"getBalance")}))},togglePullBox:function(){this.showPullBox=!this.showPullBox},loadAc:function(){var t=this;Object(o["b"])("dashboard-cny").then((function(e){t.breadcrumb=e}))},checkForm:function(){for(var t in this.pull)if(!this.pull[t])return void(this.formStatus=!1);this.formStatus=!0},openConfirmBox:function(){var t=this;this.$alert('<div class="m-packet-msg">\n                收款账号<b>'.concat(this.pull.account,"</b><br/>\n                收款人<b>").concat(this.pull.username,"</b><br/>\n                </div>"),"确认信息",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:function(e){"confirm"==e&&(t.lockStatus=!0,t.loading=!0,u(t.pull).then((function(e){t.$message({type:"success",message:"申请成功,请耐心等待结算"}),t.showPullBox=!1,t.money=t.money-t.pull.money})).then((function(){t.loadData()})).finally((function(){t.lockStatus=!1,t.loading=!1})))}})},loadData:function(){var t=this;this.loading=!0,d(this.params).then((function(e){t.list=e.data.data.list||[],t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},isIncome:function(t){var e=t.access_user_id,a=t.action_type;t.pay_user_id;return a>0||e==this.uid},authorLink:h["authorLink"],showAvatar:h["showAvatar"],formatMoney:function(t){return t?(t/100).toFixed(2):0},formatDate:function(t){return Object(i["b"])(t)},formatType:function(t){return t&&r[t]||"未知"},formatRemark:function(t){return t?t.length>12?t.slice(12)+"...":t:"-"}},created:function(){this.page=Number(this.$route.query.page||1),this.init()},watch:{params:{deep:!0,handler:function(){this.loadData()}},pull:{deep:!0,handler:function(){this.checkForm()}}}},_=b,y=(a("c0ac"),a("2877")),v=Object(y["a"])(_,n,s,!1,null,null,null);e["default"]=v.exports},"46f4":function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return o}));var n=a("41cb");function s(t){return Object(n["e"])().get("/api/my/boxcoin/cashout/history",{params:t})}function i(t){return Object(n["e"])().get("/api/my/boxcoin/bill",{params:t})}function r(t,e){return Object(n["e"])().post("/api/my/boxcoin/cashout",t,{params:e})}function l(){return Object(n["b"])().get("/api/cms/config",{params:{key:"boxcoin_cashout_forbid_date"}})}function o(){return Object(n["e"])().get("/api/my/boxcoin/overview")}},"9deb":function(t){t.exports=JSON.parse('{"alipay":"支付宝"}')},c0ac:function(t,e,a){"use strict";a("f6e8")},f6e8:function(t,e,a){}}]);
//# sourceMappingURL=chunk-7b12b8dc.862f24e6.js.map