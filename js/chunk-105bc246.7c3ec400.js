(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-105bc246"],{"057f":function(t,e,n){var i=n("fc6a"),o=n("241c").f,s={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],r=function(t){try{return o(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==s.call(t)?r(t):o(i(t))}},"0af0":function(t,e,n){},"3a16":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-publish-box"},[n("pubheader",{attrs:{name:"文集小册",localDraft:!1}},[t._t("header")],2),n("el-form",{staticClass:"m-publish-collection",attrs:{"label-position":"left"}},[n("div",{staticClass:"m-publish-title"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("标题")]),n("el-input",{attrs:{placeholder:"请输入小册标题",maxlength:"30","show-word-limit":""},model:{value:t.collection.title,callback:function(e){t.$set(t.collection,"title",e)},expression:"collection.title"}})],1),n("div",{staticClass:"m-publish-primary"},[n("div",{staticClass:"m-publish-primary-block"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("可见性")]),n("el-radio",{attrs:{label:this.public.PUBLIC},model:{value:t.collection.public,callback:function(e){t.$set(t.collection,"public",t._n(e))},expression:"collection.public"}},[t._v("公开")]),n("el-radio",{attrs:{label:this.public.PRIVATE},model:{value:t.collection.public,callback:function(e){t.$set(t.collection,"public",t._n(e))},expression:"collection.public"}},[t._v("私有")])],1),n("div",{staticClass:"m-publish-primary-block"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("封面图")]),n("post_banner",{model:{value:t.collection.image,callback:function(e){t.$set(t.collection,"image",e)},expression:"collection.image"}})],1),n("div",{staticClass:"m-publish-primary-block m-publish-collection-posts"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("内容")]),t.collection.posts&&t.collection.posts.length?n("draggable",{staticClass:"m-list-style",attrs:{tag:"ul",list:t.collection.posts,handle:".u-move"}},t._l(t.collection.posts,(function(e,i){return n("li",{key:i,staticClass:"c-posts-item"},[n("i",{staticClass:"u-move el-icon-more"}),n("i",{staticClass:"u-delete el-icon-close",on:{click:function(e){return t.collection.posts.splice(i,1)}}}),n("el-row",{staticClass:"m-posts-item",attrs:{gutter:10}},[n("el-col",{staticClass:"u-collection-type",attrs:{span:4}},[n("el-select",{staticClass:"u-item-key",attrs:{placeholder:"请选择文章类型"},on:{change:function(){t.search_handle(null,e),e.url=e.title=""}},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"item.type"}},t._l(t.source_types,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),n("el-col",{staticClass:"u-collection-id",attrs:{span:8}},["custom"!==e.type?n("el-select",{staticClass:"u-item-value",attrs:{filterable:"",remote:"",placeholder:"通过输入文章标题进行搜索","remote-method":function(n){t.search_handle(n,e)}},on:{change:function(n){t.title_fill(n,e)}},model:{value:e.id,callback:function(n){t.$set(e,"id",n)},expression:"item.id"}},[t._l(e.posts,(function(e){return[e.id&&e.title?n("el-option",{key:e.id,attrs:{value:e.id,label:e.title}}):t._e()]}))],2):n("el-input",{staticClass:"u-item-value",attrs:{placeholder:"请输入完整网页链接（需以HTTP或HTTPS开头）"},model:{value:e.url,callback:function(n){t.$set(e,"url",n)},expression:"item.url"}})],1),e.url?n("el-col",{staticClass:"u-collection-url",attrs:{span:12}},[n("el-input",{attrs:{placeholder:"请输入自定义标题"},model:{value:e.title,callback:function(n){t.$set(e,"title",n)},expression:"item.title"}})],1):t._e()],1)],1)})),0):n("div",{staticClass:"u-posts-items-empty"},[t._v(" 暂无文章信息，请进行文章添加 ")]),n("div",{staticClass:"u-posts-add",on:{click:t.add_posts_item}},[n("i",{staticClass:"el-icon-plus"}),n("span",[t._v(" 添加文章")])])],1),n("div",{staticClass:"m-publish-primary-block m-publish-description"},[n("el-divider",{attrs:{"content-position":"left"},on:{click:function(e){t.show_description=!t.show_description}}},[t._v("描述（选填）")]),t.show_description?t._e():n("span",{staticClass:"u-show",on:{click:function(e){t.show_description=!0}}},[t._v("▼ 展开")]),t.show_description?n("span",{staticClass:"u-hide",on:{click:function(e){t.show_description=!1}}},[t._v("▲ 收起")]):t._e(),n("Tinymce",{directives:[{name:"show",rawName:"v-show",value:t.show_description,expression:"show_description"}],attrs:{attachmentEnable:!0,resourceEnable:!0,height:300},model:{value:t.collection.description,callback:function(e){t.$set(t.collection,"description",e)},expression:"collection.description"}})],1),n("div",{staticClass:"m-publish-primary-block m-publish-tags"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("标签（选填）")]),n("ul",{staticClass:"m-list-style"},t._l(t.collection.tags,(function(e,i){return n("li",{key:i,staticClass:"m-tag"},[n("span",{domProps:{textContent:t._s(e)}}),n("i",{staticClass:"el-icon-close",on:{click:function(e){return t.collection.tags.splice(i,1)}}})])})),0),t.collection.tags.length<5?n("div",{staticClass:"m-tag-add"},[n("el-autocomplete",{staticClass:"u-tag-add-value",attrs:{placeholder:"请输入标签（最多为5个）","fetch-suggestions":t.tags_search},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}}),n("el-button",{staticClass:"u-tag-add",on:{click:function(){t.tag&&t.collection.tags.push(t.tag),t.tag=""}}},[n("i",{staticClass:"el-icon-plus"})])],1):t._e()],1)]),n("el-form-item",[n("el-button",{staticClass:"m-publish-collection-publish u-publish",attrs:{icon:"el-icon-s-promotion",type:"success",loading:t.$store.state.processing},on:{click:t.submit}},[t._v("提交剑三小册 ")])],1)],1)],1)},o=[];n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("fb6a"),n("b0c0"),n("a630");function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function a(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function r(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){c=!0,s=t},f:function(){try{r||null==n["return"]||n["return"]()}finally{if(c)throw s}}}}n("1276"),n("ac1f"),n("99af");var c=n("221a");const l=Object.freeze({PRIVATE:0,PUBLIC:1,all(){return[this.PRIVATE,this.PUBLIC]}});var u=l,f=n("a0fa"),p=n("7825"),d=n("b76a"),m=n.n(d),b=n("6c2b"),h=n("2777");function v(t,e){return Object(h["e"])({method:"GET",url:"/api/posts/type/".concat(t),params:e})}var g=n("65c2"),y=g.__Root,_=n("65c2"),w=_.__postType,C=_.__otherType,O=(n("4328"),n("2ef0"),{name:"item",props:[],data:function(){var t=Object.assign(w,C);return t["custom"]="自定义",delete t["cj"],{source_types:t,public:u,collection:{id:"",title:"",public:1,image:"",description:"",tags:[],posts:[]},tag:"",legal_tags:null,show_description:!1}},mounted:function(){var t=this;this.collection.posts.length||this.add_posts_item(),this.$route.params.collection_id&&Object(b["a"])(this.$route.params.collection_id).then((function(e){if(e=e.data,200===e.code){var n=e.data.collection;if(n){for(var i in n.posts){var o=n.posts[i];n.posts[i].posts="custom"===o.type?null:[{id:o.id,title:o.title}]}t.collection=n}else t.$message({message:"该剑三小册已被删除或无权限访问",type:"warning"})}}))},methods:{tags_search:function(t,e){var n=this;null===this.legal_tags?Object(b["b"])().then((function(i){i=i.data,n.legal_tags=200===i.code?i.data.tags:[],e(n.tags_filters(t))})):e(this.tags_filters(t))},tags_filters:function(t){var e,n=[],i=r(this.legal_tags);try{for(i.s();!(e=i.n()).done;){var o=e.value;o.split(t).length>1&&n.push({value:o})}}catch(s){i.e(s)}finally{i.f()}return n},title_fill:function(t,e){var n=e.posts[t];e.title=n&&n.title?n.title:""},add_posts_item:function(){this.collection.posts.push({title:"",type:"",id:"",url:"",posts:null})},search_handle:function(t,e){null===t&&(e.id=t=""),v(e.type,{public:1,keyword:t}).then((function(t){t=t.data,200===t.code&&(e.posts=t.data.posts)}))},submit:function(){var t=this;this.$confirm("确定提交剑三小册信息？","提示",{type:"info"}).then((function(){var e=JSON.parse(JSON.stringify(t.collection));if(e.posts.length){for(var n in e.posts)delete e.posts[n].posts;e.posts=JSON.stringify(e.posts),t.$store.commit("startProcess"),Object(b["e"])(e).then((function(e){e=e.data,200===e.code?(t.$message({message:e.message,type:"success"}),location.href="".concat(y,"collection/#/view/").concat(e.data.collection.id)):t.$message({message:"".concat(e.message),type:"warning"})}))}else t.$message({message:"要添加剑三小册内文章哦",type:"warning"})}))}},components:{Tinymce:c["a"],draggable:m.a,pubheader:f["a"],post_banner:p["a"]}}),S=O,k=(n("cee3"),n("2877")),j=Object(k["a"])(S,i,o,!1,null,null,null);e["default"]=j.exports},"6c2b":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return l}));var i=n("2777"),o=n("4328");function s(){return Object(i["a"])({method:"GET",url:"/api/post/collection/legal_tags"})}function a(t){return Object(i["a"])({method:"GET",url:"/api/post/collection/".concat(t)})}function r(t){return Object(i["a"])({method:"GET",url:"/api/my/post/collections",params:t})}function c(t){return Object(i["a"])({method:"POST",url:"/api/post/collection",data:o.stringify({action:t.id?"update":"create",collection:t})})}function l(t){return t?Object(i["a"])({method:"PUT",url:"/api/post/collection/remove",data:o.stringify({id:t})}):null}},"746f":function(t,e,n){var i=n("428f"),o=n("5135"),s=n("e538"),a=n("9bf2").f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});o(e,t)||a(e,t,{value:s.f(t)})}},7825:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-publish-banner"},[n("el-alert",{staticClass:"u-tip",attrs:{title:"首页海报尺寸1100*300，非必选，部分栏目不会展示海报，分享功能将使用该图作为预览图",type:"info","show-icon":""}}),n("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.url,"show-file-list":!1,"on-success":t.done,"on-error":t.fail,"with-credentials":"",accept:"image/jpg,image/jpeg,image/gif,image/png,image/bmp"}},[t.post_banner?n("img",{attrs:{src:t._f("showBanner")(t.post_banner)}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),n("el-button",{staticClass:"u-remove",attrs:{type:"info",size:"mini",icon:"el-icon-circle-close"},on:{click:t.clearBanner}},[t._v("移除海报")])],1)},o=[],s=(n("99af"),n("65c2")),a=n("85e4"),r=s["__server"]+"upload",c={name:"post_banner",props:["banner"],data:function(){return{post_banner:this.banner,url:r}},model:{prop:"banner",event:"update"},watch:{post_banner:function(t){this.$emit("update",t)},banner:function(t){this.post_banner=t}},methods:{done:function(t,e){this.post_banner=t.data.list[0],this.$store.commit("editBanner",this.post_banner)},fail:function(t,e,n){try{var i=JSON.parse(t.message);this.$message.error("[".concat(i.code,"]").concat(i.msg))}catch(o){this.$message.error("网络请求异常")}},clearBanner:function(){this.post_banner="",this.$store.commit("editBanner",this.post_banner)}},filters:{showBanner:function(t){return Object(a["showMinibanner"])(t)}}},l=c,u=(n("c383"),n("2877")),f=Object(u["a"])(l,i,o,!1,null,null,null);e["a"]=f.exports},a4d3:function(t,e,n){"use strict";var i=n("23e7"),o=n("da84"),s=n("d066"),a=n("c430"),r=n("83ab"),c=n("4930"),l=n("fdbf"),u=n("d039"),f=n("5135"),p=n("e8b5"),d=n("861d"),m=n("825a"),b=n("7b0b"),h=n("fc6a"),v=n("c04e"),g=n("5c6c"),y=n("7c73"),_=n("df75"),w=n("241c"),C=n("057f"),O=n("7418"),S=n("06cf"),k=n("9bf2"),j=n("d1e7"),$=n("9112"),P=n("6eeb"),T=n("5692"),x=n("f772"),E=n("d012"),A=n("90e3"),I=n("b622"),N=n("e538"),B=n("746f"),J=n("d44e"),U=n("69f3"),G=n("b727").forEach,R=x("hidden"),L="Symbol",V="prototype",z=I("toPrimitive"),D=U.set,F=U.getterFor(L),H=Object[V],M=o.Symbol,Q=s("JSON","stringify"),W=S.f,q=k.f,K=C.f,X=j.f,Y=T("symbols"),Z=T("op-symbols"),tt=T("string-to-symbol-registry"),et=T("symbol-to-string-registry"),nt=T("wks"),it=o.QObject,ot=!it||!it[V]||!it[V].findChild,st=r&&u((function(){return 7!=y(q({},"a",{get:function(){return q(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=W(H,e);i&&delete H[e],q(t,e,n),i&&t!==H&&q(H,e,i)}:q,at=function(t,e){var n=Y[t]=y(M[V]);return D(n,{type:L,tag:t,description:e}),r||(n.description=e),n},rt=l?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof M},ct=function(t,e,n){t===H&&ct(Z,e,n),m(t);var i=v(e,!0);return m(n),f(Y,i)?(n.enumerable?(f(t,R)&&t[R][i]&&(t[R][i]=!1),n=y(n,{enumerable:g(0,!1)})):(f(t,R)||q(t,R,g(1,{})),t[R][i]=!0),st(t,i,n)):q(t,i,n)},lt=function(t,e){m(t);var n=h(e),i=_(n).concat(mt(n));return G(i,(function(e){r&&!ft.call(n,e)||ct(t,e,n[e])})),t},ut=function(t,e){return void 0===e?y(t):lt(y(t),e)},ft=function(t){var e=v(t,!0),n=X.call(this,e);return!(this===H&&f(Y,e)&&!f(Z,e))&&(!(n||!f(this,e)||!f(Y,e)||f(this,R)&&this[R][e])||n)},pt=function(t,e){var n=h(t),i=v(e,!0);if(n!==H||!f(Y,i)||f(Z,i)){var o=W(n,i);return!o||!f(Y,i)||f(n,R)&&n[R][i]||(o.enumerable=!0),o}},dt=function(t){var e=K(h(t)),n=[];return G(e,(function(t){f(Y,t)||f(E,t)||n.push(t)})),n},mt=function(t){var e=t===H,n=K(e?Z:h(t)),i=[];return G(n,(function(t){!f(Y,t)||e&&!f(H,t)||i.push(Y[t])})),i};if(c||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=A(t),n=function(t){this===H&&n.call(Z,t),f(this,R)&&f(this[R],e)&&(this[R][e]=!1),st(this,e,g(1,t))};return r&&ot&&st(H,e,{configurable:!0,set:n}),at(e,t)},P(M[V],"toString",(function(){return F(this).tag})),P(M,"withoutSetter",(function(t){return at(A(t),t)})),j.f=ft,k.f=ct,S.f=pt,w.f=C.f=dt,O.f=mt,N.f=function(t){return at(I(t),t)},r&&(q(M[V],"description",{configurable:!0,get:function(){return F(this).description}}),a||P(H,"propertyIsEnumerable",ft,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:M}),G(_(nt),(function(t){B(t)})),i({target:L,stat:!0,forced:!c},{for:function(t){var e=String(t);if(f(tt,e))return tt[e];var n=M(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!rt(t))throw TypeError(t+" is not a symbol");if(f(et,t))return et[t]},useSetter:function(){ot=!0},useSimple:function(){ot=!1}}),i({target:"Object",stat:!0,forced:!c,sham:!r},{create:ut,defineProperty:ct,defineProperties:lt,getOwnPropertyDescriptor:pt}),i({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:dt,getOwnPropertySymbols:mt}),i({target:"Object",stat:!0,forced:u((function(){O.f(1)}))},{getOwnPropertySymbols:function(t){return O.f(b(t))}}),Q){var bt=!c||u((function(){var t=M();return"[null]"!=Q([t])||"{}"!=Q({a:t})||"{}"!=Q(Object(t))}));i({target:"JSON",stat:!0,forced:bt},{stringify:function(t,e,n){var i,o=[t],s=1;while(arguments.length>s)o.push(arguments[s++]);if(i=e,(d(e)||void 0!==t)&&!rt(t))return p(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!rt(e))return e}),o[1]=e,Q.apply(null,o)}})}M[V][z]||$(M[V],z,M[V].valueOf),J(M,L),E[R]=!0},a630:function(t,e,n){var i=n("23e7"),o=n("4df4"),s=n("1c7e"),a=!s((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:a},{from:o})},c383:function(t,e,n){"use strict";n("c515")},c515:function(t,e,n){},cee3:function(t,e,n){"use strict";n("0af0")},d28b:function(t,e,n){var i=n("746f");i("iterator")},e01a:function(t,e,n){"use strict";var i=n("23e7"),o=n("83ab"),s=n("da84"),a=n("5135"),r=n("861d"),c=n("9bf2").f,l=n("e893"),u=s.Symbol;if(o&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var f={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new u(t):void 0===t?u():u(t);return""===t&&(f[e]=!0),e};l(p,u);var d=p.prototype=u.prototype;d.constructor=p;var m=d.toString,b="Symbol(test)"==String(u("test")),h=/^Symbol\((.*)\)[^)]+$/;c(d,"description",{configurable:!0,get:function(){var t=r(this)?this.valueOf():this,e=m.call(t);if(a(f,t))return"";var n=b?e.slice(7,-1):e.replace(h,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:p})}},e538:function(t,e,n){var i=n("b622");e.f=i}}]);
//# sourceMappingURL=chunk-105bc246.7c3ec400.js.map