(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c7925dc"],{"0c34":function(t,e,a){},"0fa0":function(t){t.exports=JSON.parse('{"0":"待处理","1":"已完成","2":"异常"}')},"31e8":function(t){t.exports=JSON.parse('{"1":"品鉴评分","2":"用户打赏","3":"盒币充值","4":"盒币退回","5":"系统奖励","6":"打赏退回","7":"系统冲正","9":"付费作品","-1":"撤销评分","-2":"盒币兑换","-7":"系统冲正","-8":"过期失效"}')},"46f4":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return s})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return r}));var n=a("41cb");function i(t){return Object(n["e"])().get("/api/my/boxcoin/cashout/history",{params:t})}function s(t){return Object(n["e"])().get("/api/my/boxcoin/bill",{params:t})}function o(t,e){return Object(n["e"])().post("/api/my/boxcoin/cashout",t,{params:e})}function l(){return Object(n["b"])().get("/api/cms/config",{params:{key:"boxcoin_cashout_forbid_date"}})}function r(){return Object(n["e"])().get("/api/my/boxcoin/overview")}},ceab:function(t,e,a){"use strict";a("0c34")},d15e:function(t){t.exports=JSON.parse('["电信一区","电信五区","电信八区","双线一区","双线二区","双线四区","缘起大区"]')},e963:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-credit m-boxcoin"},[t._m(0),a("div",{staticClass:"m-credit-total m-packet-total"},[t._v(" 余额 : "),a("b",{class:{hasLeft:t.hasLeft}},[t._v(t._s(t.money))]),a("span",{staticClass:"u-types"},[a("span",{staticClass:"u-type u-type-std"},[t._v("重制："),a("b",[t._v(t._s(t.total_std))])]),a("span",{staticClass:"u-type u-type-origin"},[t._v("缘起："),a("b",[t._v(t._s(t.total_origin))])]),a("span",{staticClass:"u-type u-type-all"},[t._v("双端："),a("b",[t._v(t._s(t.total_all))])])]),a("el-button",{staticClass:"u-btn",attrs:{type:"primary",size:"mini",disabled:!t.money},on:{click:t.togglePullBox}},[t._v("兑换")])],1),t.showPullBox?a("div",{staticClass:"m-credit-pull"},[t.breadcrumb?a("el-alert",{staticClass:"m-boxcoin-ac",attrs:{type:"error","show-icon":"",closable:!1,size:"mini"}},[t._t("title",(function(){return[a("div",{domProps:{innerHTML:t._s(t.breadcrumb)}})]}))],2):t._e(),a("el-alert",{staticClass:"m-boxcoin-tip",attrs:{title:"1盒币可兑换1通宝，不可折现",type:"warning","show-icon":""}},[t._t("description",(function(){return[t._v("每个月6~30日开放兑换，1~5日关闭兑换渠道进行汇总。（即1月6日的兑换，和1月30日的兑换，同样在2月1~5日进行汇总）"),a("br"),t._v(" 汇总后，重制（正式服）通常21个工作日内发放奖励，即前一月的兑换，通常在后一个月的月底发放，如遇特殊原因可能会在某些月份锁定兑换，超过6个月的盒币将自动过期。"),a("br"),t._v(" 汇总后，缘起（怀旧服）通常赛季中和赛季末一次性发放，其中赛季末未兑换部分将清空该赛季所有盒币。"),a("br"),t._v(" 缘起（怀旧服）通过一卡通发放，可在个人中心›我的卡密中查看，如使用的第三方登录还没有设置过密码的用户，需要在个人中心›资料设置›修改密码中设置一个密码。"),a("br"),t._v(" 重制（正式服）则会直充到账号上，不会有官方短信提醒。"),a("br"),t._v(" 发放后，将会有魔盒公告，请关注首页侧边栏站内动态。 ")]}))],2),a("el-form",{staticClass:"m-boxcoin-form",attrs:{"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:"游戏大区"}},[a("el-select",{attrs:{placeholder:"请选择所在大区"},model:{value:t.pull.zone,callback:function(e){t.$set(t.pull,"zone",e)},expression:"pull.zone"}},t._l(t.zones,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"游戏账号"}},[a("el-input",{attrs:{placeholder:"请务必填写正确的账号"},model:{value:t.pull.account,callback:function(e){t.$set(t.pull,"account",e)},expression:"pull.account"}})],1),a("el-form-item",{attrs:{label:"兑换数目"}},[a("el-radio-group",{model:{value:t.pull.cash,callback:function(e){t.$set(t.pull,"cash",e)},expression:"pull.cash"}},["std"==t.client?a("el-radio",{attrs:{label:1500,border:"",disabled:!t.canSelect(1500)}},[t._v("1500通宝")]):t._e(),a("el-radio",{attrs:{label:3e3,border:"",disabled:!t.canSelect(3e3)}},[t._v("3000通宝")]),a("el-radio",{attrs:{label:5e3,border:"",disabled:!t.canSelect(5e3)}},[t._v("5000通宝")]),a("el-radio",{attrs:{label:1e4,border:"",disabled:!t.canSelect(1e4)}},[t._v("10000通宝")])],1)],1),a("el-form-item",{attrs:{label:"邮箱地址"}},[a("el-input",{attrs:{placeholder:"请务必填写正确的邮箱"},model:{value:t.pull.email,callback:function(e){t.$set(t.pull,"email",e)},expression:"pull.email"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",disabled:!t.ready||t.lockStatus},on:{click:t.openConfirmBox}},[t._v("提交申请")]),t.isAllowDate?t._e():a("span",{staticClass:"u-tip"},[a("i",{staticClass:"el-icon-warning-outline"}),t._v(" 每月"+t._s(t.start_date)+"-"+t._s(t.end_date)+"日结算期间不能进行兑换申请 ")])],1)],1)],1):t._e(),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-credit-table m-packet-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.changeType},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("el-tab-pane",{attrs:{label:"盒币记录",name:"in",lazy:""}},[t.list&&t.list.length?a("div",{staticClass:"m-packet-table"},[a("table",{staticClass:"m-boxcoin-in-list m-packet-in-list"},[a("tr",[a("th",[t._v("类型")]),a("th",[t._v("数量")]),a("th",[t._v("源于作品")]),a("th",[t._v("备注")]),a("th",[t._v("时间")])]),t._l(t.list,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(t.formatType(e.action_type)))]),a("td",{staticClass:"u-count",class:t.showBoxcoinCls(e)},[a("span",[t._v(t._s(t.showBoxcoinOp(e)))]),a("b",[t._v(t._s(t.countBoxCoin(e)))])]),a("td",[t.getPostLink(e)?a("a",{attrs:{href:t.getPostLink(e),target:"_blank"}},[a("i",{staticClass:"el-icon-link"}),t._v(" 点击查看 ")]):a("span",[t._v("-")])]),a("td",[a("span",{attrs:{title:e.remark}},[t._v(t._s(t.formatRemark(e.remark)))])]),a("td",[t._v(t._s(t.formatDate(e.created_at)))])])}))],2)]):a("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),a("el-pagination",{staticClass:"m-credit-pages m-packet-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1),a("el-tab-pane",{attrs:{label:"兑换记录",name:"out",lazy:""}},[t.list&&t.list.length?a("div",{staticClass:"m-packet-table"},[a("table",{staticClass:"m-boxcoin-out-list m-packet-in-list"},[a("tr",[a("th",[t._v("数量")]),a("th",[t._v("大区")]),a("th",[t._v("账号")]),a("th",[t._v("邮箱")]),a("th",[t._v("处理状态")]),a("th",[t._v("备注")]),a("th",[t._v("申请时间")])]),t._l(t.list,(function(e,n){return a("tr",{key:n},[a("td",[a("b",[t._v(t._s(e.cash)+"通宝")])]),a("td",[t._v(t._s(e.zone))]),a("td",[t._v(t._s(e.account))]),a("td",[t._v(t._s(e.email))]),a("td",{class:{isFinished:1==e.status,isProcessing:!e.status,isPending:e.status>1}},[t._v(" "+t._s(t.formatHistoryStatus(e.status))+" ")]),a("td",[t._v(t._s(e.remark))]),a("td",[t._v(t._s(t.formatDate(e.created_at)))])])}))],2)]):a("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),a("el-pagination",{staticClass:"m-credit-pages m-packet-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)],1)],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",{staticClass:"u-title"},[a("i",{staticClass:"el-icon-coin"}),t._v(" 我的盒币")])}],s=(a("caad"),a("2532"),a("4de4"),a("d3b7"),a("2ca0"),a("99af"),a("fb6a"),a("a9e3"),a("c9d2")),o=a("85e4"),l=a("e4f1"),r=a("31e8"),c=a("d15e"),u=a("0fa0"),p=a("46f4"),d=a("cc9a"),h={name:"Boxcoin",props:[],data:function(){return{pull:{zone:"",account:"",cash:"",email:""},showPullBox:!1,lockStatus:!1,formStatus:!1,loading:!1,tab:"in",list:[],page:1,per:10,total:1,types:r,dates:[],breadcrumb:"",overview:{all:0,std:0,origin:0},totalCoin:0,uid:s["a"].getInfo().uid}},computed:{params:function(){var t={pageIndex:this.page,pageSize:this.per};return t},client:function(){return this.$store.state.client},total_std:function(){return this.toPositiveNumber(this.overview.std)},total_origin:function(){return this.toPositiveNumber(this.overview.origin)},total_all:function(){return this.toPositiveNumber(this.overview.all)},money:{get:function(){return"std"==this.client?Math.min(this.totalCoin,Math.max(this.total_std,0)+Math.max(this.total_all,0)):Math.min(this.totalCoin,Math.max(this.total_origin,0)+Math.max(this.total_all,0))},set:function(t){return t}},hasLeft:function(){return this.money>0},min:function(){return"std"==this.client?1500:3e3},isAllowDate:function(){var t=(new Date).getDate();return!this.dates.includes(t)},start_date:function(){return this.dates[0]},end_date:function(){return this.dates[this.dates.length-1]},zones:function(){return"origin"==this.client?c.filter((function(t){return t.startsWith("缘起")})):c.filter((function(t){return!t.startsWith("缘起")}))},canCash:function(){return this.hasLeft&&this.isAllowDate&&this.money>=this.min},ready:function(){return this.canCash&&this.formStatus}},methods:{init:function(){var t=this;Object(p["c"])().then((function(e){t.dates=JSON.parse(e.data.data.val)})),this.loadAsset(),this.loadData(),this.loadAc(),this.loadOverview()},loadData:function(){var t=this;this.loading=!0;var e={in:p["d"],out:p["b"]};this.$router.push({query:{tab:this.tab,page:this.page}}),e[this.tab](this.params).then((function(e){t.list=e.data.data.list,t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},loadOverview:function(){var t=this;Object(p["e"])().then((function(e){t.overview=e.data.data}))},changeType:function(){this.page=1,this.loadData()},getPostLink:function(t){return Object(o["getLink"])(t.post_type,t.article_id)},loadAsset:function(){var t=this;s["a"].getAsset().then((function(e){t.totalCoin=(null===e||void 0===e?void 0:e.box_coin)||0}))},togglePullBox:function(){this.showPullBox=!this.showPullBox},canSelect:function(t){return~~this.money>=~~t},checkForm:function(){for(var t in this.pull)if(!this.pull[t])return void(this.formStatus=!1);this.formStatus=!0},openConfirmBox:function(){var t=this;this.$alert('<div class="m-boxcoin-msg">大区：<b>'.concat(this.pull.zone,"</b> <br/> 账号：<b>").concat(this.pull.account,"</b> <br/> 邮箱：<b>").concat(this.pull.email,"</b> <br/> 兑换：<b>").concat(this.pull.cash,"通宝</b></div>"),"确认信息",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:function(e){"confirm"==e&&(t.lockStatus=!0,t.loading=!0,Object(p["a"])(Object.assign(t.pull,{client:t.client}),{client:t.client}).then((function(e){t.$message({type:"success",message:"申请成功,请耐心等待结算"}),t.showPullBox=!1,t.money=t.money-t.pull.cash})).then((function(){t.loadData()})).finally((function(){t.lockStatus=!1,t.loading=!1})))}})},loadAc:function(){var t=this;Object(d["b"])("dashboard-boxcoin").then((function(e){t.breadcrumb=e}))},formatDate:function(t){return Object(l["b"])(t)},formatType:function(t){return t&&r[t]||"未知"},formatRemark:function(t){return t?t.length>12?t.slice(12)+"...":t:"-"},formatHistoryStatus:function(t){return u[t]||t},toPositiveNumber:function(t){return t>0?t:0},countBoxCoin:function(t){var e=t.count,a=t.ext_take_off_count,n=t.ext2_take_off_count,i=t.action_type;return(e+~~a+~~n)*(i/Math.abs(i))},showBoxcoinOp:function(t){var e=this.countBoxCoin(t);return 9==t.action_type?t.operate_user_id==this.uid?"-":"+":"-2"==t.action_type?"-":e>=0?"+":""},showBoxcoinCls:function(t){var e=this.countBoxCoin(t);return 9==t.action_type?t.operate_user_id==this.uid&&"isNegative":("-2"==t.action_type||e<0)&&"isNegative"}},created:function(){this.tab=this.$route.query.tab||"in",this.page=Number(this.$route.query.page||1),this.init()},watch:{params:{deep:!0,handler:function(){this.loadData()}},pull:{deep:!0,handler:function(){this.checkForm()}}}},f=h,b=(a("ceab"),a("2877")),m=Object(b["a"])(f,n,i,!1,null,null,null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-6c7925dc.51650151.js.map