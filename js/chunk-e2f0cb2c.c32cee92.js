(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2f0cb2c"],{1101:function(t,e,r){"use strict";r.d(e,"e",(function(){return a})),r.d(e,"a",(function(){return o})),r.d(e,"j",(function(){return n})),r.d(e,"d",(function(){return d})),r.d(e,"c",(function(){return i})),r.d(e,"f",(function(){return c})),r.d(e,"k",(function(){return u})),r.d(e,"l",(function(){return l})),r.d(e,"g",(function(){return m})),r.d(e,"b",(function(){return f})),r.d(e,"i",(function(){return _})),r.d(e,"h",(function(){return p}));r("99af");var s=r("41cb");function a(t){return Object(s["e"])().get("/mall/ship-address",t)}function o(t){return Object(s["e"])().post("/mall/ship-address",t)}function n(t,e){return Object(s["e"])().put("/mall/ship-address/".concat(t),e)}function d(t){return Object(s["e"])().delete("/mall/ship-address/".concat(t))}function i(t){return Object(s["e"])().put("/mall/ship-address/default/".concat(t))}function c(t){return Object(s["e"])().get("/mall/my/orders",{params:t})}function u(t,e){return Object(s["e"])().put("/mall/my/orders/".concat(t,"/bind-address/").concat(e))}function l(t,e){return Object(s["e"])().put("/mall/my/orders/".concat(t,"/remark"),{remark:e})}function m(t){return Object(s["e"])().get("/mall/my/orders/".concat(t))}function f(t){return Object(s["e"])().put("/mall/my/orders/".concat(t,"/cancel"))}function _(t){return Object(s["e"])().post("/mall/my/orders/".concat(t,"/pay"))}function p(t){return Object(s["e"])().post("/mall/my/orders/".concat(t,"/received"))}},"2dcf":function(t,e,r){},d222:function(t,e,r){"use strict";r("2dcf")},d81d:function(t,e,r){"use strict";var s=r("23e7"),a=r("b727").map,o=r("1dde"),n=o("map");s({target:"Array",proto:!0,forced:!n},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},ed5e:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"m-mall-detail"},[r("div",{staticClass:"m-breadcrumb"},[r("span",{staticClass:"u-back",on:{click:t.goBack}},[r("i",{staticClass:"el-icon-arrow-left"}),t._v(" 返回")])]),r("div",{staticClass:"m-content"},[r("div",{staticClass:"m-address el-card"},[r("span",[t._v("收件人："+t._s(t.address.actual_contact))]),r("span",[t._v("联系电话："+t._s(t.address.actual_phone))]),r("span",[t._v("收货地址： "+t._s(t.address.actual_address))])]),t.goods?r("div",{staticClass:"m-order el-card"},[r("img",{staticClass:"u-img",attrs:{src:t.goods.goods_images[0]}}),r("div",{staticClass:"m-box"},[r("span",{staticClass:"u-title"},[t._v(t._s(t.goods.title))]),r("span",[t._v("订单编号："+t._s(t.order.order_no))]),r("span",[t._v("下单时间："+t._s(t.order.created_at))]),r("span",[t._v("购买数量："+t._s(t.order.goods_num))]),r("span",[t._v("邮费："+t._s(t.goods.postage?t.goods.postage/100+"元":"包邮"))]),r("span",[t._v("支付状态："+t._s(t.payStatus[t.order.pay_status])+" ")]),r("span",[t._v("订单状态："+t._s(t.orderStatus[t.order.order_status])+" ")]),r("div",{staticClass:"u-consume"},[r("span",[t._v("购买消耗：")]),r("div",{staticClass:"u-box"},[t.goods.price_cny?r("span",[t._v("金箔："),r("b",[t._v(t._s(t.goods.price_cny*t.order.goods_num))])]):t._e(),t.goods.price_boxcoin?r("span",[t._v("盒币："),r("b",[t._v(t._s(t.goods.price_boxcoin*t.order.goods_num))])]):t._e(),t.goods.price_points?r("span",[t._v("积分："),r("b",[t._v(t._s(t.goods.price_points*t.order.goods_num))])]):t._e()])]),r("span",[t._v("备注："+t._s(t.order.remark||"-"))])])]):t._e(),t.closeButton(t.data.order)?r("div",{staticClass:"m-button"},[0==t.data.order.order_status?[r("el-button",{on:{click:function(e){return t.cancel(t.data.order.id)}}},[t._v("取消订单")]),r("el-button",{on:{click:function(e){return t.open(t.data.order.id,"address")}}},[t._v("修改地址")]),r("el-button",{on:{click:function(e){return t.open(t.data.order.id,"remark")}}},[t._v("添加备注")])]:t._e(),3==t.data.order.order_status?r("el-button",{on:{click:function(e){return t.toConfirm(t.data.order.id)}}},[t._v("确认收货")]):t._e(),t.showPay(t.data.order)?r("el-button",{on:{click:function(e){return t.toPay(t.data)}}},[t._v("点击付款")]):t._e()],2):t._e()]),r("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"30%","before-close":t.close,"custom-class":"m-edit-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},["address"==t.mode?[r("el-form",{ref:"address_form",staticClass:"demo-form-inline",attrs:{model:t.address_form,rules:t.address_rules}},[r("el-form-item",{attrs:{label:"选择收货地址",prop:"address_id"}},[r("el-select",{model:{value:t.address_form.address_id,callback:function(e){t.$set(t.address_form,"address_id",e)},expression:"address_form.address_id"}},t._l(t.addressList,(function(t,e){return r("el-option",{key:e,attrs:{label:"【 "+t.contact_name+" "+t.contact_phone+" 】 "+t.province+t.city+t.area+t.address,value:t.id}})})),1)],1),r("el-form-item",[r("div",{staticClass:"m-button"},[r("el-button",{on:{click:t.close}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("address_form")}}},[t._v("确定")])],1)])],1)]:[r("el-form",{ref:"remark_form",staticClass:"demo-form-inline",attrs:{model:t.remark_form,rules:t.remark_rules}},[r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:t.remark_form.remark,callback:function(e){t.$set(t.remark_form,"remark",e)},expression:"remark_form.remark"}})],1),r("el-form-item",[r("div",{staticClass:"m-button"},[r("el-button",{on:{click:t.close}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("remark_form")}}},[t._v("确定")])],1)])],1)]],2)],1)},a=[],o=(r("d81d"),r("4de4"),r("d3b7"),r("1101")),n=r("f03c"),d={name:"orderDetail",data:function(){return{data:{},mode:"",dialogVisible:!1,addressList:[],address_form:{address_id:""},address_rules:{address_id:[{required:!0,message:"请选择地址",trigger:"change"}]},remark_form:{remark:""},remark_rules:{remark:[{required:!0,message:"请输入备注",trigger:"blur"}]}}},computed:{id:function(){return this.$route.params.id},pageIndex:function(){return this.$route.params.pageIndex},address:function(){return this.data.shipAddress||{}},order:function(){return this.data.order},goods:function(){return this.data.goods},payStatus:function(){return n["b"]},orderStatus:function(){return n["a"]},title:function(){return"address"==this.mode?"修改收货地址":"修改备注"}},methods:{load:function(){var t=this;Object(o["g"])(this.id).then((function(e){t.data=e.data.data}))},loadAddress:function(){var t=this;Object(o["e"])().then((function(e){t.addressList=e.data.data.list}))},closeButton:function(t){return!!t&&(1!=t.order_status&&2!=t.order_status&&7!=t.order_status)},showPay:function(t){if(t){var e=t.order_status,r=t.pay_status;return 1!=e&&2!=e&&7!=e&&0==r}return!1},toConfirm:function(t){var e=this;Object(o["h"])(t).then((function(){e.data.order.order_status=4}))},goBack:function(){this.$router.push({name:"mall",params:{pageIndex:this.pageIndex}})},open:function(t,e){this.order_id=t,"address"==e&&this.loadAddress(),void 0!==this.$refs.address_form&&this.$refs.address_form.clearValidate(),void 0!==this.$refs.remark_form&&this.$refs.remark_form.clearValidate(),this.mode=e,this.dialogVisible=!0},close:function(){this.dialogVisible=!1},cancel:function(t){var e=this;Object(o["b"])(t).then((function(r){e.list=e.list.map((function(e){return e.order.id==t&&(e.order.order_status=1),e}))}))},toPay:function(t){var e=this,r=t.order.id;Object(o["i"])(r).then((function(){e.list=e.list.map((function(t){return t.order.id==r&&(t.order.pay_status=1),t}))}))},submit:function(t){var e=this;this.$refs[t].validate((function(t){t&&("address"==e.mode?Object(o["k"])(e.order_id,e.address_form.address_id).then((function(){e.$message({message:"修改地址成功",type:"success"});var t=e.addressList.filter((function(t){return t.id==e.address_form.address_id}))[0];if(t){var r=t.province,s=t.city,a=t.area,o=t.address,n=t.contact_name,d=t.contact_phone,i=r+" "+s+" "+a+" "+o;e.data.shipAddress.actual_address=i,e.data.shipAddress.actual_contact=n,e.data.shipAddress.actual_phone=d}e.close()})):Object(o["l"])(e.order_id,e.remark_form.remark).then((function(){e.$message({message:"修改备注成功",type:"success"}),e.data.order.remark=e.remark_form.remark,e.close()})))}))}},mounted:function(){this.id&&this.load()}},i=d,c=(r("d222"),r("2877")),u=Object(c["a"])(i,s,a,!1,null,null,null);e["default"]=u.exports},f03c:function(t){t.exports=JSON.parse('{"b":{"0":"未支付","1":"已支付","2":"已退款"},"a":{"0":"未发货","1":"已取消","2":"已关闭","3":"已发货","4":"已收货","5":"已评价","6":"已退货","7":"等待退款"}}')}}]);
//# sourceMappingURL=chunk-e2f0cb2c.c32cee92.js.map