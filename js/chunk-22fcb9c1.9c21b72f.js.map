{"version":3,"sources":["webpack:///./src/service/profile.js","webpack:///./src/views/auth.vue","webpack:///src/views/auth.vue","webpack:///./src/views/auth.vue?a375","webpack:///./src/views/auth.vue?3193","webpack:///./src/views/auth.vue?ff23"],"names":["getProfile","$cms","get","updateProfile","data","put","updateAvatar","uploadAvatar","post","getFrames","url","__imgPath","axios","getUserOverview","uid","concat","params","__no_cache","updatePassword","checkEmailAvailable","email","sendBindEmail","sendVerifyEmail","code","app","checkOAuth","unbindOAuth","type","popType","delete","getWechatQrcode","unbindWechat","sendPhoneCode","verifyPhone","checkPhone","render","_vm","this","_c","_self","staticClass","domProps","_s","content","directives","name","rawName","value","loading","expression","_l","oauth","key","class","attrs","icon","_v","types","level","checkStatus","on","$event","toBind","_e","staticRenderFns","wechat_mp_openid","wechat_miniprogram_openid","user_phone","components","uc","info","computed","_this$info","User","getLevel","experience","mounted","_this","getBreadcrumb","then","res","loadAuth","loadUserInfo","methods","getNickname","__cdn","_this2","finally","routeName","$router","push","_this3","getMyInfo","component"],"mappings":"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","file":"js/chunk-22fcb9c1.9c21b72f.js","sourcesContent":["import { $cms, $_https } from \"@jx3box/jx3box-common/js/https.js\";\n\nimport axios from \"axios\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\n// 1.资料\n// -------------------------------\nfunction getProfile() {\n    return $cms().get(\"/api/cms/user/my/profile\");\n}\nfunction updateProfile(data) {\n    return $cms().put(\"/api/cms/user/my/profile\", data);\n}\n\n// 2.头像\n// -------------------------------\nfunction updateAvatar(data) {\n    return $cms().put(\"/api/cms/user/my/avatar\", data);\n}\nfunction uploadAvatar(data) {\n    return $cms().post(\"/api/cms/upload/avatar\", data);\n}\nfunction getFrames() {\n    // let url = process.env.NODE_ENV == 'development'?'/temp/user_avatar_frame.json':(__imgPath + \"avatar/index.json\")\n    let url = __imgPath + \"avatar/index.json\";\n    return axios.get(url);\n}\nfunction getUserOverview(uid) {\n    return $cms().get(`/api/cms/user/${uid}/info`, {\n        params: {\n            __no_cache: 1,\n        },\n    });\n}\n\n// 3.密码\n// -------------------------------\n// 发送验证码\nfunction sendVerifyCode(data) {\n    return $cms().post(\"/api/cms/user/account/email/forgot-password\", data, {\n        app: \"jx3box\",\n    });\n}\n// 重设密码\nfunction updatePassword(data) {\n    return $cms().put(\"/api/cms/user/my/password\", data);\n}\n\n// 4.邮箱\n// -------------------------------\nfunction checkEmailAvailable(email) {\n    return $cms().get(\"/api/cms/user/account/email/valid\", {\n        params: {\n            email\n        }\n    });\n}\n\nfunction sendBindEmail(data) {\n    return $cms().post(\"/api/cms/user/account/email/bind\", data);\n}\n\nfunction sendVerifyEmail(code) {\n    return $cms().put(\"/api/cms/user/account/email/verify\", {\n        code,\n    }, { app: 'jx3box' });\n}\n\n// 5.互联\nfunction checkOAuth() {\n    return $cms().get(\"/api/cms/account/oauth/status\");\n}\n\nfunction unbindOAuth(type) {\n    return $cms({\n        popType: \"alert\",\n    }).delete(`/api/cms/account/oauth/unbind/${type}`);\n}\n\n// 6.微信\n// 获取微信二维码\nfunction getWechatQrcode() {\n    return $cms().get(`/api/cms/wechat/mp/bind`);\n}\n\n// 解除绑定\nfunction unbindWechat() {\n    return $cms().get(`/api/cms/wechat/mp/unbind`);\n}\n\n// 7.手机\n// -------------------------------\nfunction sendPhoneCode(data) {\n    return $cms().post(\"/api/cms/account/oauth/phone/bind\", data, {\n        app: \"jx3box\",\n    });\n}\n\nfunction verifyPhone(data) {\n    return $cms().put(\"/api/cms/account/oauth/phone/verify\", data, {\n        app: \"jx3box\",\n    });\n}\n\nfunction checkPhone(params) {\n    return $cms().get(\"/api/cms/account/oauth/phone/check\", {\n        params,\n    });\n}\n\nexport {\n    updateProfile,\n    getProfile,\n    updateAvatar,\n    updatePassword,\n    sendVerifyEmail,\n    checkEmailAvailable,\n    sendBindEmail,\n    unbindOAuth,\n    checkOAuth,\n    uploadAvatar,\n    getFrames,\n    getUserOverview,\n    getWechatQrcode,\n    unbindWechat,\n    sendVerifyCode,\n\n    sendPhoneCode,\n    verifyPhone,\n    checkPhone,\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('uc',{staticClass:\"m-auth\"},[_c('div',{staticClass:\"m-block\"},[_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.content)}})]),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"m-dashboard-content-list\"},_vm._l((_vm.oauth),function(type){return _c('div',{key:type,staticClass:\"m-item\"},[_c('span',{staticClass:\"u-profile-item\"},[_c('img',{class:'u-' + type,attrs:{\"svg-inline\":\"\",\"src\":_vm.icon(type)}}),_c('span',{staticClass:\"u-status\"},[_vm._v(\" \"+_vm._s(_vm.types[type].name)+\" \")])]),(type != 'user_phone' || (type == 'user_phone' && _vm.level >= 3))?[(!_vm.checkStatus(type))?_c('el-button',{staticClass:\"u-button\",attrs:{\"type\":!_vm.checkStatus(type) ? 'primary' : 'danger'},on:{\"click\":function($event){return _vm.toBind(type)}}},[_vm._v(\" 前往绑定 \")]):_c('i',{staticClass:\"el-icon-success u-bind\"})]:_vm._e()],2)}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <uc class=\"m-auth\">\n        <div class=\"m-block\">\n            <div v-html=\"content\"></div>\n        </div>\n\n        <div class=\"m-dashboard-content-list\" v-loading=\"loading\">\n            <div class=\"m-item\" v-for=\"type in oauth\" :key=\"type\">\n                <span class=\"u-profile-item\">\n                    <img :class=\"'u-' + type\" svg-inline :src=\"icon(type)\" />\n                    <span class=\"u-status\">\n                        {{ types[type].name }}\n                        <!-- {{ checkStatus(type) ? getNickname(type) : \"未绑定\" }} -->\n                    </span>\n                </span>\n                <template v-if=\"type != 'user_phone' || (type == 'user_phone' && level >= 3)\">\n                    <el-button\n                        class=\"u-button\"\n                        :type=\"!checkStatus(type) ? 'primary' : 'danger'\"\n                        @click=\"toBind(type)\"\n                        v-if=\"!checkStatus(type)\"\n                    >\n                        前往绑定\n                    </el-button>\n                    <i class=\"el-icon-success u-bind\" v-else></i>\n                </template>\n            </div>\n        </div>\n    </uc>\n</template>\n\n<script>\nimport { getBreadcrumb } from \"@jx3box/jx3box-common/js/api_misc\";\nimport uc from \"@/components/uc.vue\";\nimport { __imgPath, __cdn } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport { checkOAuth } from \"@/service/profile\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { getMyInfo } from \"@/service/index.js\";\n\nconst types = {\n    wechat_mp_openid: {\n        icon: \"official\",\n        name: \"微信公众号\",\n    },\n    wechat_miniprogram_openid: {\n        icon: \"app\",\n        name: \"微信小程序\",\n    },\n    user_phone: {\n        icon: \"phone\",\n        name: \"手机号\",\n    },\n};\n\nexport default {\n    name: \"auth\",\n    components: {\n        uc,\n    },\n    data: function () {\n        return {\n            content: \"\",\n            data: {},\n            oauth: [\"wechat_mp_openid\", \"wechat_miniprogram_openid\", \"user_phone\"],\n\n            types,\n            loading: false,\n\n            info: {},\n        };\n    },\n    computed: {\n        level: function () {\n            return User.getLevel(this.info?.experience || 0);\n        },\n    },\n    mounted() {\n        getBreadcrumb(\"auth_ac\").then((res) => {\n            this.content = res;\n        });\n\n        this.loadAuth();\n\n        this.loadUserInfo();\n    },\n    methods: {\n        checkStatus: function (type) {\n            return !!this.data[type];\n        },\n        getNickname: function (type) {\n            return this.data[type + \"_name\"] || \"已绑定\";\n        },\n        icon: function (type) {\n            return __cdn + \"design/user/\" + types[type][\"icon\"] + \".png\";\n        },\n        loadAuth() {\n            this.loading = true;\n            checkOAuth()\n                .then((res) => {\n                    this.data = res.data.data;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        toBind(type) {\n            const routeName = {\n                wechat_mp_openid: \"notice\",\n                wechat_miniprogram_openid: \"connect\",\n                user_phone: \"notice\",\n            }[type];\n\n            this.$router.push({ name: routeName });\n        },\n        loadUserInfo: function () {\n            getMyInfo().then((res) => {\n                this.info = res.data.data || {};\n            });\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-auth {\n    .m-block {\n        background-color: #fafbfc;\n        border: 1px solid @color-link;\n        margin: 15px 15px 5px 15px;\n        padding: 10px 10px 10px 30px;\n        border-radius: 6px;\n        position: relative;\n\n        h3,\n        h6 {\n            .fz(13px,22px);\n            color: #333;\n            margin: 10px 0;\n        }\n        p {\n            font-size: 12px;\n            line-height: 26px;\n            margin: 0;\n        }\n    }\n\n    .m-dashboard-content-list {\n        .flex;\n        box-sizing: border-box;\n        flex-direction: column;\n        gap: 20px;\n        .u-profile-item {\n            .flex;\n            align-items: center;\n            gap: 20px;\n            padding: 0 20px;\n            .bold;\n        }\n    }\n\n    .m-item {\n        .flex;\n        padding: 30px 10px 10px 10px;\n        box-sizing: border-box;\n        gap: 60px;\n        border-top: 1px dashed #ddd;\n        align-items: center;\n        &:first-child {\n            border: 0;\n        }\n    }\n\n    img,\n    svg {\n        .size(40px);\n    }\n\n    .u-button {\n        .w(auto) !important;\n    }\n\n    .u-status {\n        .nobreak;\n        .w(200px);\n    }\n\n    .u-tip {\n        .mb(10px);\n    }\n\n    .u-bind {\n        color: #67c23a;\n        font-size: 32px;\n    }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./auth.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./auth.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./auth.vue?vue&type=template&id=051b8bba\"\nimport script from \"./auth.vue?vue&type=script&lang=js\"\nexport * from \"./auth.vue?vue&type=script&lang=js\"\nimport style0 from \"./auth.vue?vue&type=style&index=0&id=051b8bba&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./auth.vue?vue&type=style&index=0&id=051b8bba&prod&lang=less\""],"sourceRoot":""}