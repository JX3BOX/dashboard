(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04b661c3"],{4426:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"m-publish-box"},[s("pubheader",{attrs:{name:"物品百科",localDraft:!1}},[e._t("header")],2),s("h1",{staticClass:"m-publish-item-header"},[e._v("贡献攻略")]),s("el-form",{staticClass:"m-publish-item",attrs:{"label-position":"left","label-width":"80px"}},[s("el-form-item",{attrs:{label:"物品选择"}},[s("el-select",{staticClass:"u-item_id",attrs:{filterable:"",remote:"",disabled:!!e.post.id,placeholder:"输入物品名称/物品描述并按『回车』进行搜索","filter-method":e.goto_search_items,loading:e.options.search_loading},model:{value:e.post.source_id,callback:function(t){e.$set(e.post,"source_id",t)},expression:"post.source_id"}},e._l(e.options.items,(function(t){return s("el-option",{key:t.id,attrs:{label:t.Name,value:t.id}},[s("div",{staticClass:"m-selector-item"},[s("img",{staticClass:"u-icon",attrs:{src:e.icon_url_filter(t.IconID),alt:t.Name}}),s("span",{staticClass:"u-name",domProps:{textContent:e._s(t.Name)}})])])})),1)],1),s("el-form-item",{attrs:{label:"综合难度"}},[s("el-rate",{staticClass:"u-level",model:{value:e.post.level,callback:function(t){e.$set(e.post,"level",t)},expression:"post.level"}})],1),s("el-form-item",{attrs:{label:"修订说明"}},[s("el-input",{attrs:{placeholder:"请简单描述一下本次修订的说明"},model:{value:e.post.remark,callback:function(t){e.$set(e.post,"remark",t)},expression:"post.remark"}})],1),s("el-form-item",{staticClass:"m-publish-item-content",attrs:{label:"攻略正文"}},[s("Tinymce",{attrs:{attachmentEnable:!0,resourceEnable:!0,height:400},model:{value:e.post.content,callback:function(t){e.$set(e.post,"content",t)},expression:"post.content"}}),s("el-button",{staticClass:"u-publish",attrs:{icon:"el-icon-s-promotion",type:"success",disabled:e.processing},on:{click:e.toPublish}},[e._v("提交攻略 ")])],1)],1)],1)},n=[],a=(s("99af"),s("4160"),s("159b"),s("a0fa")),i=s("221a"),r=s("ee8f"),c=s("b78a"),l=(s("4328"),s("2ef0"),{name:"item",props:[],data:function(){return{options:{items:null,search_loading:!1},post:{id:"",content:"",source_id:"",level:0,remark:""},extend:{feedEnable:!1,followEnable:!1,tencentEnable:!1,weiboEnable:!1,tuilanEnable:!1}}},computed:{processing:function(){return this.$store.state.processing}},methods:{toPublish:function(){var e=this;this.post.source_id?this.post.content?this.post.level>=1&&this.post.level<=5?this.post.remark?(this.$store.commit("startProcess"),Object(c["a"])(this.post).then((function(t){t=t.data,200===t.code?e.$message({message:"提交成功，请等待审核",type:"success",onClose:function(){e.$router.go(0)}}):e.$message({message:"".concat(t.message),type:"warning"})}))):this.$message({message:"请简单描述本次修订说明",type:"warning"}):this.$message({message:"请选择适合的综合难度",type:"warning"}):this.$message({message:"要编写攻略正文哦",type:"warning"}):this.$message({message:"请选择要修订攻略的物品",type:"warning"})},icon_url_filter:function(e){return isNaN(parseInt(e))?"".concat(r["JX3BOX"].__imgPath,"image/common/nullicon.png"):"".concat(r["JX3BOX"].__iconPath,"icon/").concat(e,".png")},goto_search_items:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.options.search_loading=!0,Object(c["c"])(t,10).then((function(t){t=t.data,e.options.items=200===t.code&&t.data.data,e.options.search_loading=!1,"function"===typeof s&&s()}),(function(){e.options.items=!1}))}},mounted:function(){var e=this;this.goto_search_items("",(function(){var t=e.$route.params.source_id;e.post.source_id=t||null})),document.getElementsByClassName("m-publish-title").forEach((function(e){e.remove()})),document.getElementsByClassName("el-button--plain").forEach((function(e){e.remove()}))},watch:{"post.source_id":{handler:function(){var e=this;this.post.source_id&&Object(c["b"])(this.post.source_id).then((function(t){var s=t.data;s=200===s.code&&s.data;var o=s.post,n=s.source;if(o?(e.post.source_id=o.source_id,e.post.level=o.level||1,e.post.remark="",e.post.content=o.content):(e.post.source_id=e.post.source_id?e.post.source_id:"",e.post.level=0,e.post.remark="",e.post.content=""),n){var a=!1;for(var i in e.options.items=e.options.items||[],e.options.items)if(e.options.items[i].id==e.post.source_id){a=!0;break}a||e.options.items.push(n)}}))}}},components:{pubheader:a["a"],Tinymce:i["a"]}}),p=l,u=(s("a4b8"),s("2877")),m=Object(u["a"])(p,o,n,!1,null,null,null);t["default"]=m.exports},"72b7":function(e,t,s){},a4b8:function(e,t,s){"use strict";var o=s("72b7"),n=s.n(o);n.a},b78a:function(e,t,s){"use strict";s.d(t,"c",(function(){return c})),s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return p}));s("b0c0");var o=s("2777"),n=s("ee8f"),a=s("ee8f"),i=a.User,r=s("4328");function c(e,t,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i={keyword:e,limit:t,fields:s};return null!==a&&(i.is_equip=a?1:0),Object(o["a"])({method:"GET",url:"".concat(n["JX3BOX"].__helperUrl,"api/item/search"),headers:{Accept:"application/prs.helper.v2+json"},params:i})}function l(e){return Object(o["a"])({method:"GET",url:"".concat(n["JX3BOX"].__helperUrl,"api/wiki/post"),headers:{Accept:"application/prs.helper.v2+json"},params:{type:"item",source_id:e}})}function p(e){return Object(o["a"])({method:"POST",url:"".concat(n["JX3BOX"].__helperUrl,"api/wiki/post"),headers:{Accept:"application/prs.helper.v2+json"},data:r.stringify({post:{type:"item",source_id:e.source_id,level:e.level,user_nickname:i.getInfo().name,content:e.content,remark:e.remark}})})}}}]);
//# sourceMappingURL=chunk-04b661c3.e9f4fa09.js.map