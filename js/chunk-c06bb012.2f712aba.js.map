{"version":3,"sources":["webpack:///./src/views/callback/invitation_kith.vue?6201","webpack:///./src/service/callback.js","webpack:///./src/views/callback/invitation_kith.vue?3672","webpack:///src/views/callback/invitation_kith.vue","webpack:///./src/views/callback/invitation_kith.vue?371e","webpack:///./src/views/callback/invitation_kith.vue","webpack:///./src/utils/dateFormat.js"],"names":["getPost","post_id","$cms","get","getUser","user_id","isExistPostInvitation","quitUnionPost","delete","acceptPostInvitation","put","isExistKithInvitation","refuseKithInvitation","acceptKithInvitation","render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","_v","attrs","_f","userdata","user_avatar","uid","_s","display_name","info","updated","isNotExist","alreadyAccept","on","accept","refuse","staticRenderFns","name","props","components","data","record","computed","Base64","watch","immediate","handler","methods","loadData","check","message","type","filters","authorLink","showAvatar","dateFormat","created","mounted","component","dt","separator","polished","year","getFullYear","month","getMonth","date","getDate","str","polish","val"],"mappings":"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","file":"js/chunk-c06bb012.2f712aba.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_kith.vue?vue&type=style&index=0&id=4c7b6f2c&scoped=true&lang=less&\"","import { $cms } from \"@jx3box/jx3box-common/js/https\";\n\nfunction getPost(post_id) {\n    return $cms().get(`/api/cms/post/${post_id}`);\n}\n\nfunction getUser(user_id) {\n    return $cms().get(`/api/cms/user/${user_id}/info`);\n}\n\n// 联合创作者\nfunction isExistPostInvitation(post_id) {\n    return $cms().get(`/api/cms/post/${post_id}/author/my`);\n}\n\nfunction quitUnionPost(post_id) {\n    return $cms().delete(`/api/cms/post/${post_id}/authors/quit`);\n}\n\nfunction acceptPostInvitation(post_id) {\n    return $cms().put(`/api/cms/post/${post_id}/author/my`);\n}\n\n// 亲友\nfunction isExistKithInvitation(user_id) {\n    return $cms().get(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nfunction refuseKithInvitation(user_id) {\n    return $cms().delete(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nfunction acceptKithInvitation(user_id) {\n    return $cms().put(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nexport { getPost, getUser, quitUnionPost, isExistPostInvitation, acceptPostInvitation, isExistKithInvitation, refuseKithInvitation, acceptKithInvitation };\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-callback m-invitation-kith\"},[_vm._m(0),_c('p',{staticClass:\"u-desc\"},[_vm._v(\"你收到了一条亲友邀请。\")]),_c('div',{staticClass:\"u-post\"},[_c('div',{staticClass:\"u-post-avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"showAvatar\")(_vm.userdata.user_avatar)}})]),_c('div',{staticClass:\"u-post-info\"},[_c('a',{staticClass:\"u-post-title\",attrs:{\"href\":_vm._f(\"authorLink\")(_vm.uid),\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.userdata.display_name))]),_c('div',{staticClass:\"u-post-desc\"},[_c('i',{staticClass:\"el-icon-date\"}),_c('time',{staticClass:\"u-post-time\"},[_vm._v(_vm._s(_vm._f(\"dateFormat\")(_vm.info.updated)))])])])]),_c('div',{staticClass:\"u-btns\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-check\",\"disabled\":_vm.isNotExist || _vm.alreadyAccept},on:{\"click\":_vm.accept}},[_vm._v(\"接受\")]),_c('el-button',{attrs:{\"type\":\"info\",\"icon\":\"el-icon-close\",\"disabled\":_vm.isNotExist},on:{\"click\":_vm.refuse}},[_vm._v(\"拒绝\")])],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"u-title\"},[_c('i',{staticClass:\"el-icon-message\"}),_vm._v(\" 邀请 \")])}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-callback m-invitation-kith\">\n        <h1 class=\"u-title\">\n            <i class=\"el-icon-message\"></i> 邀请\n        </h1>\n        <p class=\"u-desc\">你收到了一条亲友邀请。</p>\n        <div class=\"u-post\">\n            <div class=\"u-post-avatar\">\n                <img :src=\"userdata.user_avatar | showAvatar\" />\n            </div>\n            <div class=\"u-post-info\">\n                <a\n                    class=\"u-post-title\"\n                    :href=\"uid | authorLink\"\n                    target=\"_blank\"\n                >{{userdata.display_name}}</a>\n                <div class=\"u-post-desc\">\n                    <i class=\"el-icon-date\"></i>\n                    <time class=\"u-post-time\">{{info.updated | dateFormat}}</time>\n                </div>\n            </div>\n        </div>\n        <div class=\"u-btns\">\n            <el-button\n                type=\"primary\"\n                icon=\"el-icon-check\"\n                :disabled=\"isNotExist || alreadyAccept\"\n                @click=\"accept\"\n            >接受</el-button>\n            <el-button type=\"info\" icon=\"el-icon-close\" @click=\"refuse\" :disabled=\"isNotExist\">拒绝</el-button>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { Base64 } from \"js-base64\";\nimport {\n    getUser,\n    isExistKithInvitation,\n    refuseKithInvitation,\n    acceptKithInvitation,\n} from \"@/service/callback.js\";\nimport {\n    getLink,\n    showAvatar,\n    authorLink,\n} from \"@jx3box/jx3box-common/js/utils\";\nimport dateFormat from \"@/utils/dateFormat\";\nexport default {\n    name: \"InvitationKith\",\n    props: [],\n    components: {},\n    data: function () {\n        return {\n            userdata: \"\",\n            record: null,\n        };\n    },\n    computed: {\n        info: function () {\n            return JSON.parse(\n                Base64.decode(decodeURIComponent(this.$route.query.info))\n            );\n        },\n        uid: function () {\n            return this.info?.source_id;\n        },\n        isNotExist: function () {\n            return !this.record;\n        },\n        alreadyAccept: function () {\n            return !!(this.record && this.record.status);\n        },\n    },\n    watch: {\n        uid: {\n            immediate: true,\n            handler: function (val) {\n                if (val) {\n                    this.loadData();\n                    this.check();\n                }\n            },\n        },\n    },\n    methods: {\n        loadData: function () {\n            getUser(this.uid).then((res) => {\n                this.userdata = res.data?.data;\n            });\n        },\n        check: function () {\n            isExistKithInvitation(this.uid).then((res) => {\n                this.record = res.data?.data;\n            });\n        },\n        refuse: function () {\n            refuseKithInvitation(this.uid).then(() => {\n                this.$message({\n                    message: \"操作成功\",\n                    type: \"success\",\n                });\n            });\n            this.$router.push(\"/whitelist\");\n        },\n        accept: function () {\n            acceptKithInvitation(this.uid).then((res) => {\n                this.$message({\n                    message: \"操作成功\",\n                    type: \"success\",\n                });\n                this.$router.push(\"/whitelist\");\n            });\n        },\n    },\n    filters: {\n        authorLink,\n        showAvatar,\n        dateFormat: function (val) {\n            return dateFormat(new Date(~~val * 1000));\n        },\n    },\n    created: function () {},\n    mounted: function () {},\n};\n</script>\n\n<style scoped lang=\"less\">\n.m-invitation-kith {\n    padding: 100px 0;\n    max-width: 1280px;\n    .auto(x);\n    .u-title {\n        font-weight: 400;\n        i {\n            .fz(38px);\n            .y(-3px);\n        }\n        .x;\n        // color: @primary;\n    }\n    .u-desc {\n        .fz(24px);\n        .x;\n    }\n    .u-post {\n        display: flex;\n        border: 1px solid #ddd;\n        .r(6px);\n        max-width: 800px;\n        .auto(x);\n        background-color: @bg-light;\n    }\n    .u-post-avatar {\n        flex-shrink: 0;\n        img {\n            .size(68px);\n            padding: 10px;\n        }\n    }\n    .u-post-info {\n        padding: 10px;\n        flex-grow: 1;\n        overflow: hidden;\n    }\n    .u-post-title {\n        .fz(15px,2.5);\n        .db;\n        .bold;\n        &:hover {\n            text-decoration: underline;\n            color: @pink;\n        }\n        .nobreak;\n    }\n    .u-post-desc {\n        .fz(13px,2);\n        .db;\n        color: #555;\n        &:hover {\n            color: @pink;\n        }\n    }\n    .u-post-time {\n        .ml(10px);\n        color: #888 !important;\n    }\n    .u-btns {\n        .x;\n        .mt(20px);\n    }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_kith.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_kith.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./invitation_kith.vue?vue&type=template&id=4c7b6f2c&scoped=true&\"\nimport script from \"./invitation_kith.vue?vue&type=script&lang=js&\"\nexport * from \"./invitation_kith.vue?vue&type=script&lang=js&\"\nimport style0 from \"./invitation_kith.vue?vue&type=style&index=0&id=4c7b6f2c&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4c7b6f2c\",\n  null\n  \n)\n\nexport default component.exports","/**\n * 简单的日期格式化\n *\n * @param {*} dt Date实例\n * @param {object} opt polished:是否补齐两位,separator:连接分隔符\n */\nfunction dateFormat(dt,separator='-',polished=true){\n    let year = dt.getFullYear()\n    let month = dt.getMonth() + 1\n    let date = dt.getDate()\n    let str = polished ? \n        `${year}${separator}${polish(month)}${separator}${polish(date)}` :\n        `${year}${separator}${month}${separator}${date}`\n    return str\n}\n\nfunction polish(val){\n    return val<10 ? ('0' + val) : val\n}\n\nexport default dateFormat\n"],"sourceRoot":""}