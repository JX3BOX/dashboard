{"version":3,"sources":["webpack:///./src/views/avatar.vue","webpack:///src/views/avatar.vue","webpack:///./src/views/avatar.vue?24d6","webpack:///./src/views/avatar.vue?e971","webpack:///./src/service/profile.js","webpack:///./src/views/avatar.vue?4b58","webpack:///./src/service/decoration.js"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_f","avatar","upload","_v","on","submit","reset","staticRenderFns","name","props","data","bak","frame","isVIP","uid","User","getInfo","frames","tabActivate","decorationJson","decoration","decorationActivate","originalActivateName","selectAll","noDecoration","computed","user_avatar","methods","file","fileList","_this","formdata","FormData","filedata","raw","append","uploadAvatar","then","res","$message","message","type","_this2","updateAvatar","refresh","showFrame","__imgPath","concat","init","_this3","avatar_origin","getUserOverview","user_avatar_frame","filters","showAvatar","val","showSmallAvatar","created","components","uc","component","$server","$_https","proxy","getProfile","$cms","get","updateProfile","put","post","getFrames","url","axios","params","__no_cache","updatePassword","checkEmailStatus","checkEmailAvailable","email","user_email","sendBindEmail","sendVerifyEmail","checkOAuth","unbindOAuth","popType","delete","getDecoration","setDecoration","getDecorationJson","getEmotion","__dataPath","receive","user_id","updateAvatarFrame","getHonor"],"mappings":"6xBAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,KAAK,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,MAAM,CAACE,YAAY,4BAA4B,CAACF,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,sBAAsBC,MAAM,CAAC,IAAML,EAAIM,GAAG,aAAPN,CAAqBA,EAAIO,aAAaL,EAAG,YAAY,CAACE,YAAY,WAAWC,MAAM,CAAC,KAAO,GAAG,OAAS,mCAAmC,YAAYL,EAAIQ,OAAO,OAAS,gBAAgB,eAAc,IAAQ,CAACN,EAAG,IAAI,CAACE,YAAY,mBAAmBF,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACJ,EAAIS,GAAG,eAAeP,EAAG,KAAK,CAACF,EAAIS,GAAG,UAAUP,EAAG,MAAMA,EAAG,OAAO,CAACE,YAAY,SAAS,CAACJ,EAAIS,GAAG,2BAA2BP,EAAG,IAAI,CAACE,YAAY,UAAU,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWK,GAAG,CAAC,MAAQV,EAAIW,SAAS,CAACX,EAAIS,GAAG,QAAQP,EAAG,YAAY,CAACQ,GAAG,CAAC,MAAQV,EAAIY,QAAQ,CAACZ,EAAIS,GAAG,SAAS,IAAI,QAEj3BI,EAAkB,G,gGCuCP,G,UAAA,CACfC,KAAA,SACAC,MAAA,GACAC,KAAA,WACA,OAEAC,IAAA,GAEAV,OAAA,GACAW,MAAA,GAEAC,OAAA,EACAC,IAAAC,OAAAC,UAAAF,IAEAG,SACAC,YAAA,IACAC,eAAA,GACAC,WAAA,GACAC,mBAAA,KACAC,qBAAA,KACAC,UAAA,GACAC,cAAA,IAGAC,SAAA,CACAf,KAAA,WACA,OACAgB,YAAA,KAAAzB,UAIA0B,QAAA,CACAzB,OAAA,SAAA0B,EAAAC,GAAA,IAAAC,EAAA,KACAC,EAAA,IAAAC,SACAC,EAAAL,EAAAM,IACAH,EAAAI,OAAA,SAAAF,GACAG,eAAAL,GAAAM,MAAA,SAAAC,GACAR,EAAAS,SAAA,CACAC,QAAA,OACAC,KAAA,YAEAX,EAAA7B,OAAAqC,EAAA5B,UAAA,OAGAJ,MAAA,WACA,KAAAL,OAAA,KAAAU,KAEAN,OAAA,eAAAqC,EAAA,KAYAC,eAAA,KAAAjC,MAAA2B,MAAA,SAAAC,GACAvB,OAAA6B,QAAA,SAAAF,EAAAzC,QACAyC,EAAAH,SAAA,CACAC,QAAA,SACAC,KAAA,gBAIAI,UAAA,SAAArC,GAIA,OAAAsC,eAAA,iBAAAC,OAAAvC,EAAA,KAAAuC,OAAAvC,EAAA,SAEAwC,KAAA,eAAAC,EAAA,KACA,KAAAhD,OAAA,KAAAU,IAAAI,OAAAC,UAAAkC,cACAC,eAAA,KAAArC,KAAAuB,MAAA,SAAAC,GACAW,EAAArC,MAAA0B,EAAA5B,UAAA0C,mBAAA,QAIAC,QAAA,CACAC,WAAA,SAAAC,GACA,OAAAD,wBAAAC,EAAA,SAEAC,gBAAA,SAAAD,GACA,OAAAD,wBAAAC,EAAA,UAGAE,QAAA,WACA,KAAAT,QAEAU,WAAA,CACAC,aCrI2Y,I,wBCQvYC,EAAY,eACd,EACAnE,EACAc,GACA,EACA,KACA,KACA,MAIa,aAAAqD,E,6CCnBf,2eAKMC,EAAUC,eAAQ,SAAU,CAC9BC,OAAO,IAKX,SAASC,IACL,OAAOC,iBAAOC,IAAI,4BAEtB,SAASC,EAAczD,GACnB,OAAOuD,iBAAOG,IAAI,2BAA4B1D,GAKlD,SAASiC,EAAajC,GAClB,OAAOuD,iBAAOG,IAAI,0BAA2B1D,GAEjD,SAAS0B,EAAa1B,GAClB,OAAOuD,iBAAOI,KAAK,yBAA0B3D,GAEjD,SAAS4D,IAEL,IAAIC,EAAMzB,eAAY,oBACtB,OAAO0B,IAAMN,IAAIK,GAErB,SAASpB,EAAgBrC,GACrB,OAAOmD,iBAAOC,IAAI,iBAADnB,OAAkBjC,EAAG,SAAQ,CAC1C2D,OAAQ,CACJC,WAAY,KAOxB,SAASC,EAAejE,GACpB,OAAOmD,EAAQQ,KAAK,mBAAoB3D,GAK5C,SAASkE,IACL,OAAOf,EAAQK,IAAI,uBAGvB,SAASW,EAAoBC,GACzB,OAAOjB,EAAQK,IAAI,0BAA2B,CAC1CO,OAAQ,CACJM,WAAYD,KAKxB,SAASE,EAActE,GACnB,OAAOmD,EAAQQ,KAAK,qBAAsB3D,GAG9C,SAASuE,IACL,OAAOpB,EAAQQ,KAAK,wBAIxB,SAASa,IACL,OAAOjB,iBAAOC,IAAI,iCAGtB,SAASiB,EAAY1C,GACjB,OAAOwB,eAAK,CACRmB,QAAU,UACXC,OAAO,iCAADtC,OAAkCN,M,oCC3E/C,W,2UCGA,SAAS6C,EAAcb,GACnB,OAAOR,iBAAOC,IAAI,2BAA4B,CAC1CO,WAGR,SAASc,EAAc7E,GACnB,OAAOuD,iBAAOI,KAAK,2BAA4B3D,GAEnD,SAAS8E,IACL,IAAIjB,EAAMzB,eAAY,wBACtB,OAAO0B,IAAMN,IAAIK,GAErB,SAASkB,IACL,OAAOjB,IAAMN,IAAI,GAADnB,OAAI2C,gBAAU,gCAElC,SAASC,EAAQC,EAASrC,GACtB,OAAOU,iBAAOI,KAAK,uCAADtB,OAAwC6C,EAAO,KAAA7C,OAAIQ,EAAG,gBAG5E,SAASsC,EAAkBnF,GACvB,OAAOuD,iBAAOG,IAAI,gCAAiC1D,GAEvD,SAASoF,IACL,OAAOtB,IAAMN,IAAI,GAADnB,OAAID,eAAS","file":"js/chunk-29af8e0d.ce74f6fe.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('uc',{staticClass:\"m-dashboard-avatar\"},[_c('div',{staticClass:\"m-profile-avatar\"},[_c('div',{staticClass:\"m-profile-avatar-primary\"},[_c('div',{staticClass:\"u-avatar\"},[_c('img',{staticClass:\"u-avatar u-avatar-l\",attrs:{\"src\":_vm._f(\"showAvatar\")(_vm.avatar)}})]),_c('el-upload',{staticClass:\"u-upload\",attrs:{\"drag\":\"\",\"accept\":\"image/png, image/gif, image/jpeg\",\"on-change\":_vm.upload,\"action\":\"upload/avatar\",\"auto-upload\":false}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\" 将文件拖到此处，或 \"),_c('em',[_vm._v(\"点击上传\")]),_c('br'),_c('span',{staticClass:\"u-tip\"},[_vm._v(\"只能上传jpg/png/gif文件\")])])]),_c('p',{staticClass:\"u-btng\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(\"确认\")]),_c('el-button',{on:{\"click\":_vm.reset}},[_vm._v(\"重置\")])],1)],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <uc class=\"m-dashboard-avatar\">\n        <div class=\"m-profile-avatar\">\n            <div class=\"m-profile-avatar-primary\">\n                <div class=\"u-avatar\">\n                    <img class=\"u-avatar u-avatar-l\" :src=\"avatar | showAvatar\" />\n                </div>\n                <el-upload\n                    class=\"u-upload\"\n                    drag\n                    accept=\"image/png, image/gif, image/jpeg\"\n                    :on-change=\"upload\"\n                    action=\"upload/avatar\"\n                    :auto-upload=\"false\"\n                >\n                    <i class=\"el-icon-upload\"></i>\n                    <div class=\"el-upload__text\">\n                        将文件拖到此处，或\n                        <em>点击上传</em>\n                        <br />\n                        <span class=\"u-tip\">只能上传jpg/png/gif文件</span>\n                    </div>\n                </el-upload>\n                <p class=\"u-btng\">\n                    <el-button type=\"primary\" @click=\"submit\">确认</el-button>\n                    <el-button @click=\"reset\">重置</el-button>\n                </p>\n            </div>\n        </div>\n    </uc>\n</template>\n\n<script>\nimport uc from \"@/components/uc.vue\";\nimport { updateAvatar, uploadAvatar, getFrames, getUserOverview } from \"@/service/profile\";\nimport { getDecoration, setDecoration, getDecorationJson } from \"@/service/decoration\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { showAvatar, getThumbnail } from \"@jx3box/jx3box-common/js/utils\";\nimport frames from \"@jx3box/jx3box-common/data/user_avatar_frame.json\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport { flatten } from \"lodash\";\nexport default {\n    name: \"avatar\",\n    props: [],\n    data: function () {\n        return {\n            // 备份\n            bak: \"\",\n            // 数据\n            avatar: \"\",\n            frame: \"\",\n            // VIP\n            isVIP: false,\n            uid: User.getInfo().uid,\n            // 头像框\n            frames,\n            tabActivate: \"0\",\n            decorationJson: {},\n            decoration: [],\n            decorationActivate: null,\n            originalActivateName: null,\n            selectAll: [],\n            noDecoration: false,\n        };\n    },\n    computed: {\n        data: function () {\n            return {\n                user_avatar: this.avatar,\n            };\n        },\n    },\n    methods: {\n        upload: function (file, fileList) {\n            let formdata = new FormData();\n            let filedata = file.raw;\n            formdata.append(\"avatar\", filedata);\n            uploadAvatar(formdata).then((res) => {\n                this.$message({\n                    message: \"上传成功\",\n                    type: \"success\",\n                });\n                this.avatar = res.data.data[0];\n            });\n        },\n        reset: function () {\n            this.avatar = this.bak;\n        },\n        submit: function () {\n            // this.decorationSubmit();\n            // if (!this.isVIP) {\n            //     if (this.frame) {\n            //         this.$notify({\n            //             title: \"头像框未生效\",\n            //             message: \"头像框仅高级/专业账号可用\",\n            //             type: \"warning\",\n            //         });\n            //     }\n            //     this.frame = \"\";\n            // }\n            updateAvatar(this.data).then((res) => {\n                User.refresh(\"avatar\", this.avatar);\n                this.$message({\n                    message: \"头像更新成功\",\n                    type: \"success\",\n                });\n            });\n        },\n        showFrame: function (name) {\n            // if (process.env.NODE_ENV == \"development\") {\n            //     return `temp/avatar/${name}/${name}.svg`;\n            // }\n            return __imgPath + `avatar/images/${name}/${name}.svg`;\n        },\n        init: function () {\n            this.avatar = this.bak = User.getInfo().avatar_origin;\n            getUserOverview(this.uid).then((res) => {\n                this.frame = res.data.data.user_avatar_frame || \"\";\n            });\n        },\n    },\n    filters: {\n        showAvatar: function (val) {\n            return showAvatar(val, 480, false);\n        },\n        showSmallAvatar: function (val) {\n            return showAvatar(val, 136, false);\n        },\n    },\n    created: function () {\n        this.init();\n    },\n    components: {\n        uc,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/profile/avatar.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./avatar.vue?vue&type=template&id=2eab4646&\"\nimport script from \"./avatar.vue?vue&type=script&lang=js&\"\nexport * from \"./avatar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./avatar.vue?vue&type=style&index=0&id=2eab4646&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { $cms,$_https } from \"@jx3box/jx3box-common/js/https.js\";\n\nimport axios from 'axios'\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\nconst $server = $_https('server', {\n    proxy: false,\n})\n\n// 1.资料\n// -------------------------------\nfunction getProfile() {\n    return $cms().get(\"/api/cms/user/my/profile\");\n}\nfunction updateProfile(data) {\n    return $cms().put(\"/api/cms/user/my/profile\", data);\n}\n\n// 2.头像\n// -------------------------------\nfunction updateAvatar(data) {\n    return $cms().put(\"/api/cms/user/my/avatar\", data);\n}\nfunction uploadAvatar(data) {\n    return $cms().post(\"/api/cms/upload/avatar\", data);\n}\nfunction getFrames() {\n    // let url = process.env.NODE_ENV == 'development'?'/temp/user_avatar_frame.json':(__imgPath + \"avatar/index.json\")\n    let url = __imgPath + \"avatar/index.json\"\n    return axios.get(url)\n}\nfunction getUserOverview(uid) {\n    return $cms().get(`/api/cms/user/${uid}/info`,{\n        params: {\n            __no_cache: 1\n        }\n    });\n}\n\n// 3.密码\n// -------------------------------\nfunction updatePassword(data) {\n    return $server.post(\"profile/password\", data);\n}\n\n// 4.邮箱\n// -------------------------------\nfunction checkEmailStatus() {\n    return $server.get(\"profile/email/check\");\n}\n\nfunction checkEmailAvailable(email) {\n    return $server.get(\"profile/email/available\", {\n        params: {\n            user_email: email,\n        },\n    });\n}\n\nfunction sendBindEmail(data) {\n    return $server.post(\"profile/email/bind\", data);\n}\n\nfunction sendVerifyEmail() {\n    return $server.post(\"profile/email/verify\");\n}\n\n// 5.互联\nfunction checkOAuth() {\n    return $cms().get(\"/api/cms/account/oauth/status\");\n}\n\nfunction unbindOAuth(type) {\n    return $cms({\n        popType : 'alert',\n    }).delete(`/api/cms/account/oauth/unbind/${type}`);\n}\n\n\nexport {\n    updateProfile,\n    getProfile,\n    updateAvatar,\n    updatePassword,\n    sendVerifyEmail,\n    checkEmailAvailable,\n    checkEmailStatus,\n    sendBindEmail,\n    unbindOAuth,\n    checkOAuth,\n    uploadAvatar,\n    getFrames,\n    getUserOverview,\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=style&index=0&id=2eab4646&prod&lang=less&\"","import { $cms } from \"@jx3box/jx3box-common/js/https.js\";\nimport axios from \"axios\";\nimport { __imgPath, __dataPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nfunction getDecoration(params) {\n    return $cms().get(`/api/cms/user/decoration`, {\n        params,\n    });\n}\nfunction setDecoration(data) {\n    return $cms().post(`/api/cms/user/decoration`, data);\n}\nfunction getDecorationJson() {\n    let url = __imgPath + \"decoration/index.json\";\n    return axios.get(url);\n}\nfunction getEmotion() {\n    return axios.get(`${__dataPath}emotion/output/catalog.json`);\n}\nfunction receive(user_id, val) {\n    return $cms().post(`/api/cms/user/decoration/check-suit/${user_id}/${val}/for/avatar`);\n}\n\nfunction updateAvatarFrame(data) {\n    return $cms().put(\"/api/cms/user/my/avatar-frame\", data);\n}\nfunction getHonor() {\n    return axios.get(`${__imgPath}decoration/honor.json`);\n}\nexport { getDecoration, setDecoration, getDecorationJson, getEmotion, receive, updateAvatarFrame, getHonor };\n"],"sourceRoot":""}