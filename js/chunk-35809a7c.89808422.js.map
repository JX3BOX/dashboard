{"version":3,"sources":["webpack:///./src/publish/collection.vue?5c4b","webpack:///./node_modules/@jx3box/jx3box-editor/service/enum/CollectionPublic.js","webpack:///./src/service/collection.js","webpack:///./src/service/post.js","webpack:///src/publish/collection.vue","webpack:///./src/publish/collection.vue?03b7","webpack:///./src/publish/collection.vue","webpack:///./src/components/publish/post_banner.vue?17d3","webpack:///src/components/publish/post_banner.vue","webpack:///./src/components/publish/post_banner.vue?7da6","webpack:///./src/components/publish/post_banner.vue","webpack:///./src/components/publish/post_banner.vue?1f42","webpack:///./src/publish/collection.vue?ca75"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_t","_v","model","value","collection","callback","$$v","$set","expression","image","public","PUBLIC","PRIVATE","_l","t","key","domProps","_s","on","$event","tags","splice","length","tag","push","_e","show_description","directives","name","rawName","add_posts_item","posts","item","search_handle","url","title","type","k","query","post_id","title_fill","post","id","$store","state","processing","submit","staticRenderFns","CollectionPublic","Object","freeze","qs","require","get_collection","$collection_id","$http","method","JX3BOX","__helperUrl","headers","Accept","submit_collection","data","stringify","action","get_posts_by_type","params","component","done","fail","_f","post_banner","clearBanner"],"mappings":"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","file":"js/chunk-35809a7c.89808422.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish-box\"},[_c('pubheader',{attrs:{\"name\":\"剑三小册\",\"localDraft\":false}},[_vm._t(\"header\")],2),_c('el-form',{staticClass:\"m-publish-collection\",attrs:{\"label-position\":\"left\"}},[_c('div',{staticClass:\"m-publish-title\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"标题\")]),_c('el-input',{attrs:{\"placeholder\":\"请输入剑三小册标题\",\"maxlength\":\"20\",\"show-word-limit\":\"\"},model:{value:(_vm.collection.title),callback:function ($$v) {_vm.$set(_vm.collection, \"title\", $$v)},expression:\"collection.title\"}})],1),_c('el-row',{attrs:{\"gutter\":30}},[_c('el-col',{staticClass:\"m-publish-image\",attrs:{\"span\":6}},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"封面图\")]),_c('post_banner',{attrs:{\"banner\":_vm.collection.image}})],1),_c('el-col',{attrs:{\"span\":18}},[_c('div',{staticClass:\"m-publish-public\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"可见性\")]),_c('el-radio',{attrs:{\"label\":this.public.PUBLIC},model:{value:(_vm.collection.public),callback:function ($$v) {_vm.$set(_vm.collection, \"public\", $$v)},expression:\"collection.public\"}},[_vm._v(\"公开\")]),_c('el-radio',{attrs:{\"label\":this.public.PRIVATE},model:{value:(_vm.collection.public),callback:function ($$v) {_vm.$set(_vm.collection, \"public\", $$v)},expression:\"collection.public\"}},[_vm._v(\"私有\")])],1),_c('div',{staticClass:\"m-publish-tags\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"标签（选填）\")]),_c('ul',{staticClass:\"m-list-style\"},_vm._l((_vm.collection.tags),function(t,key){return _c('li',{key:key,staticClass:\"m-tag\"},[_c('span',{domProps:{\"textContent\":_vm._s(t)}}),_c('i',{staticClass:\"el-icon-close\",on:{\"click\":function($event){return _vm.collection.tags.splice(key, 1)}}})])}),0),(_vm.collection.tags.length < 5)?_c('div',{staticClass:\"m-tag-add\"},[_c('el-input',{staticClass:\"u-tag-add-value\",attrs:{\"placeholder\":\"请输入标签（最多为5个）\"},model:{value:(_vm.tag),callback:function ($$v) {_vm.tag=$$v},expression:\"tag\"}}),_c('el-button',{staticClass:\"u-tag-add\",on:{\"click\":function (){if(_vm.tag){ _vm.collection.tags.push(_vm.tag); }_vm.tag='';}}},[_c('i',{staticClass:\"el-icon-plus\"})])],1):_vm._e()],1)])],1),_c('div',{staticClass:\"m-publish-description\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"},on:{\"click\":function($event){_vm.show_description=!_vm.show_description}}},[_vm._v(\"描述（选填）\")]),(!_vm.show_description)?_c('span',{staticClass:\"u-show\",on:{\"click\":function($event){_vm.show_description=true}}},[_vm._v(\"▼ 展开\")]):_vm._e(),(_vm.show_description)?_c('span',{staticClass:\"u-hide\",on:{\"click\":function($event){_vm.show_description=false}}},[_vm._v(\"▲ 收起\")]):_vm._e(),_c('Tinymce',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show_description),expression:\"show_description\"}],attrs:{\"attachmentEnable\":true,\"resourceEnable\":true,\"height\":300},model:{value:(_vm.collection.description),callback:function ($$v) {_vm.$set(_vm.collection, \"description\", $$v)},expression:\"collection.description\"}})],1),_c('div',{staticClass:\"m-publish-posts\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"内容\")]),_c('div',{staticClass:\"u-posts-add\",on:{\"click\":_vm.add_posts_item}},[_c('i',{staticClass:\"el-icon-plus\"}),_c('span',[_vm._v(\" 添加文章\")])]),(_vm.collection.posts && _vm.collection.posts.length)?_c('draggable',{staticClass:\"m-list-style\",attrs:{\"tag\":\"ul\",\"list\":_vm.collection.posts,\"handle\":\".u-move\"}},_vm._l((_vm.collection.posts),function(item,key){return _c('li',{key:key,staticClass:\"c-posts-item\"},[_c('i',{staticClass:\"u-move el-icon-more\"}),_c('i',{staticClass:\"u-delete el-icon-close\",on:{\"click\":function($event){return _vm.collection.posts.splice(key, 1)}}}),_c('el-row',{staticClass:\"m-posts-item\",attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":4}},[_c('el-select',{staticClass:\"u-item-key\",attrs:{\"placeholder\":\"请选择文章类型\"},on:{\"change\":function (){_vm.search_handle(null, item);item.url=item.title=''}},model:{value:(item.type),callback:function ($$v) {_vm.$set(item, \"type\", $$v)},expression:\"item.type\"}},_vm._l((_vm.source_types),function(type,k){return _c('el-option',{key:k,attrs:{\"label\":type,\"value\":k}})}),1)],1),_c('el-col',{attrs:{\"span\":8}},[(item.type !== 'custom')?_c('el-select',{staticClass:\"u-item-value\",attrs:{\"filterable\":\"\",\"remote\":\"\",\"placeholder\":\"通过输入文章标题进行搜索\",\"remote-method\":function (query){_vm.search_handle(query, item)}},on:{\"change\":function (post_id){_vm.title_fill(post_id, item)}},model:{value:(item.id),callback:function ($$v) {_vm.$set(item, \"id\", $$v)},expression:\"item.id\"}},[_vm._l((item.posts),function(post){return [(post.id && post.title)?_c('el-option',{key:post.id,attrs:{\"value\":post.id,\"label\":post.title}}):_vm._e()]})],2):_c('el-input',{staticClass:\"u-item-value\",attrs:{\"placeholder\":\"请输入URL链接\"},model:{value:(item.url),callback:function ($$v) {_vm.$set(item, \"url\", $$v)},expression:\"item.url\"}})],1),(item.url)?_c('el-col',{attrs:{\"span\":12}},[_c('el-input',{attrs:{\"placeholder\":\"请输入自定义标题\"},model:{value:(item.title),callback:function ($$v) {_vm.$set(item, \"title\", $$v)},expression:\"item.title\"}})],1):_vm._e()],1)],1)}),0):_c('div',{staticClass:\"u-posts-items-empty\"},[_vm._v(\"暂无文章信息，请进行文章添加\")])],1),_c('el-form-item',[_c('el-button',{staticClass:\"u-publish\",attrs:{\"icon\":\"el-icon-s-promotion\",\"type\":\"success\",\"loading\":_vm.$store.state.processing},on:{\"click\":_vm.submit}},[_vm._v(\"提交剑三小册 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const CollectionPublic = Object.freeze({\n  PRIVATE: 0,\n  PUBLIC: 1,\n\n  all() {\n    return [\n      this.PRIVATE,\n      this.PUBLIC,\n    ]\n  },\n})\n\nexport default CollectionPublic;","import {$ as $http} from \"./axios\";\nimport {JX3BOX} from \"@jx3box/jx3box-common\";\n\nconst qs = require(\"qs\");\n\nfunction get_collection($collection_id) {\n  return $http({\n    method: \"GET\",\n    url: `${JX3BOX.__helperUrl}api/post/collection/${$collection_id}`,\n    headers: {Accept: \"application/prs.helper.v2+json\"},\n  });\n}\n\nfunction submit_collection(collection) {\n  return $http({\n    method: \"POST\",\n    url: `${JX3BOX.__helperUrl}api/post/collection`,\n    headers: {Accept: \"application/prs.helper.v2+json\"},\n    data: qs.stringify({\n      action: collection.id ? 'update' : 'create',\n      collection: collection,\n    }),\n  });\n}\n\nexport {get_collection, submit_collection};\n","import {$ as $http} from \"./axios\";\nimport {JX3BOX} from \"@jx3box/jx3box-common\";\n\nconst qs = require(\"qs\");\n\n/**\n * 根据文章类型获取文章列表\n * @param type\n * @param params\n * @returns {AxiosPromise}\n */\nfunction get_posts_by_type(type, params) {\n    return $http({\n        method: \"GET\",\n        url: `${JX3BOX.__helperUrl}api/posts/${type}`,\n        headers: {Accept: \"application/prs.helper.v2+json\"},\n        params: params,\n    });\n}\n\nexport {get_posts_by_type};\n","<template>\n  <div class=\"m-publish-box\">\n    <!-- 头部 -->\n    <pubheader name=\"剑三小册\" :localDraft=\"false\">\n      <slot name=\"header\"></slot>\n    </pubheader>\n\n    <el-form label-position=\"left\" class=\"m-publish-collection\">\n      <!-- 💛 栏目字段 -->\n      <div class=\"m-publish-title\">\n        <el-divider content-position=\"left\">标题</el-divider>\n        <el-input v-model=\"collection.title\" placeholder=\"请输入剑三小册标题\" maxlength=\"20\" show-word-limit></el-input>\n      </div>\n\n      <el-row :gutter=\"30\">\n        <el-col :span=\"6\" class=\"m-publish-image\">\n          <el-divider content-position=\"left\">封面图</el-divider>\n          <post_banner :banner=\"collection.image\"/>\n        </el-col>\n        <el-col :span=\"18\">\n          <div class=\"m-publish-public\">\n            <el-divider content-position=\"left\">可见性</el-divider>\n            <el-radio v-model=\"collection.public\" :label=\"this.public.PUBLIC\">公开</el-radio>\n            <el-radio v-model=\"collection.public\" :label=\"this.public.PRIVATE\">私有</el-radio>\n          </div>\n\n          <div class=\"m-publish-tags\">\n            <el-divider content-position=\"left\">标签（选填）</el-divider>\n            <ul class=\"m-list-style\">\n              <li v-for=\"(t, key) in collection.tags\" :key=\"key\" class=\"m-tag\">\n                <span v-text=\"t\"></span>\n                <i class=\"el-icon-close\" @click=\"collection.tags.splice(key, 1)\"></i>\n              </li>\n            </ul>\n            <div class=\"m-tag-add\" v-if=\"collection.tags.length < 5\">\n              <el-input class=\"u-tag-add-value\" placeholder=\"请输入标签（最多为5个）\" v-model=\"tag\"></el-input>\n              <el-button class=\"u-tag-add\" @click=\"()=>{if(tag)collection.tags.push(tag);tag='';}\">\n                <i class=\"el-icon-plus\"></i>\n              </el-button>\n            </div>\n          </div>\n        </el-col>\n      </el-row>\n\n      <div class=\"m-publish-description\">\n        <el-divider content-position=\"left\" @click=\"show_description=!show_description\">描述（选填）</el-divider>\n        <span v-if=\"!show_description\" @click=\"show_description=true\" class=\"u-show\">▼ 展开</span>\n        <span v-if=\"show_description\" @click=\"show_description=false\" class=\"u-hide\">▲ 收起</span>\n        <Tinymce\n            v-show=\"show_description\"\n            v-model=\"collection.description\"\n            :attachmentEnable=\"true\"\n            :resourceEnable=\"true\"\n            :height=\"300\"\n        />\n      </div>\n\n      <div class=\"m-publish-posts\">\n        <el-divider content-position=\"left\">内容</el-divider>\n        <div class=\"u-posts-add\" @click=\"add_posts_item\">\n          <i class=\"el-icon-plus\"></i>\n          <span> 添加文章</span>\n        </div>\n        <draggable\n            class=\"m-list-style\"\n            tag=\"ul\"\n            v-if=\"collection.posts && collection.posts.length\"\n            :list=\"collection.posts\"\n            handle=\".u-move\"\n        >\n          <li v-for=\"(item, key) in collection.posts\" :key=\"key\" class=\"c-posts-item\">\n            <i class=\"u-move el-icon-more\"></i>\n            <i class=\"u-delete el-icon-close\" @click=\"collection.posts.splice(key, 1)\"></i>\n            <el-row class=\"m-posts-item\" :gutter=\"10\">\n              <el-col :span=\"4\">\n                <el-select class=\"u-item-key\" v-model=\"item.type\" placeholder=\"请选择文章类型\"\n                           @change=\"()=>{search_handle(null, item);item.url=item.title=''}\">\n                  <el-option v-for=\"(type, k) in source_types\" :label=\"type\" :key=\"k\" :value=\"k\"></el-option>\n                </el-select>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-select\n                    v-if=\"item.type !== 'custom'\"\n                    class=\"u-item-value\"\n                    v-model=\"item.id\"\n                    filterable\n                    remote\n                    placeholder=\"通过输入文章标题进行搜索\"\n                    :remote-method=\"(query)=>{search_handle(query, item)}\"\n                    @change=\"(post_id)=>{title_fill(post_id, item)}\"\n                >\n                  <template v-for=\"post in item.posts\">\n                    <el-option v-if=\"post.id && post.title\" :key=\"post.id\" :value=\"post.id\"\n                               :label=\"post.title\"></el-option>\n                  </template>\n                </el-select>\n                <el-input class=\"u-item-value\" placeholder=\"请输入URL链接\" v-else v-model=\"item.url\"></el-input>\n              </el-col>\n              <el-col :span=\"12\" v-if=\"item.url\">\n                <el-input v-model=\"item.title\" placeholder=\"请输入自定义标题\"></el-input>\n              </el-col>\n            </el-row>\n          </li>\n        </draggable>\n        <div v-else class=\"u-posts-items-empty\">暂无文章信息，请进行文章添加</div>\n      </div>\n\n      <el-form-item>\n        <el-button\n            class=\"u-publish\"\n            icon=\"el-icon-s-promotion\"\n            type=\"success\"\n            @click=\"submit\"\n            :loading=\"$store.state.processing\"\n        >提交剑三小册\n        </el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\n  const {__Root} = require(\"@jx3box/jx3box-common/js/jx3box.json\");\n  const {__postType, __otherType} = require(\"@jx3box/jx3box-common/js/jx3box\");\n  import Tinymce from '@jx3box/jx3box-editor/src/Tinymce'\n  import CollectionPublic from '@jx3box/jx3box-editor/service/enum/CollectionPublic'\n  import pubheader from \"@/components/publish/pubheader.vue\";\n  import post_banner from \"@/components/publish/post_banner.vue\";\n  import draggable from \"vuedraggable\";\n\n  // 本地依赖\n  import {get_collection, submit_collection} from \"../service/collection\";\n  import {get_posts_by_type} from \"../service/post\";\n\n  const qs = require(\"qs\");\n  const lodash = require(\"lodash\");\n\n  export default {\n    name: \"item\",\n    props: [],\n    data() {\n      // 文章类型加载\n      let source_types = Object.assign(__postType, __otherType);\n      source_types['custom'] = '自定义';\n      delete source_types['cj'];\n\n      return {\n        source_types: source_types,\n        public: CollectionPublic,\n        // 剑三小册主体\n        collection: {\n          id: \"\",\n          title: \"\",\n          public: \"\",\n          image: \"\",\n          description: \"\",\n          tags: [],\n          posts: [],\n        },\n        tag: '',\n        show_description: false,\n      };\n    },\n    mounted() {\n      if (!this.collection.posts.length) this.add_posts_item();\n\n      if (this.$route.params.collection_id) {\n        get_collection(this.$route.params.collection_id).then(\n          (res) => {\n            res = res.data;\n            if (res.code === 200) {\n              let collection = res.data.collection;\n              if (collection) {\n                for (let i in collection.posts) {\n                  let item = collection.posts[i];\n                  collection.posts[i].posts = item.type === 'custom' ? null : [{id: item.id, title: item.title}];\n                }\n                this.collection = collection;\n              } else {\n                this.$message({message: \"该剑三小册已被删除或无权限访问\", type: \"warning\"});\n              }\n            }\n          }\n        )\n      }\n    },\n    methods: {\n      // 帖子标题填充\n      title_fill(post_id, item) {\n        let post = item.posts[post_id];\n        item.title = post && post.title ? post.title : '';\n      },\n      add_posts_item() {\n        this.collection.posts.push({title: '', type: '', id: '', url: '', posts: null})\n      },\n      search_handle(queryString, item) {\n        if (queryString === null) item.id = queryString = '';\n        get_posts_by_type(item.type, {keyword: queryString}).then((res) => {\n          res = res.data;\n          if (res.code === 200) {\n            item.posts = res.data.posts;\n          }\n        });\n      },\n      submit: function () {\n        this.$confirm('确定提交剑三小册信息？', '提示', {type: 'info'}).then(() => {\n          let collection = JSON.parse(JSON.stringify(this.collection));\n\n          if (!collection.posts.length) {\n            this.$message({message: \"要添加剑三小册内文章哦\", type: \"warning\"});\n            return;\n          }\n\n          // 去除多余字段\n          for (let i in collection.posts) delete collection.posts[i].posts;\n          collection.posts = JSON.stringify(collection.posts);\n\n          this.$store.commit('startProcess');\n          submit_collection(collection).then((data) => {\n            data = data.data;\n            if (data.code === 200) {\n              this.$message({message: data.message, type: \"success\"});\n              location.href = `${__Root}collection/#/view/${data.data.collection.id}`;\n            } else {\n              this.$message({message: `${data.message}`, type: \"warning\"});\n            }\n          });\n        });\n      },\n    },\n    components: {\n      Tinymce,\n      draggable,\n      pubheader,\n      post_banner,\n    },\n  };\n</script>\n\n<style lang=\"less\">\n  @import \"../assets/css/publish/collection.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./collection.vue?vue&type=template&id=6add241c&\"\nimport script from \"./collection.vue?vue&type=script&lang=js&\"\nexport * from \"./collection.vue?vue&type=script&lang=js&\"\nimport style0 from \"./collection.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish-banner\"},[_c('el-alert',{staticClass:\"u-tip\",attrs:{\"title\":\"图片尺寸180*100像素，非必选，部分栏目不会展示海报，分享功能将使用该图作为预览图\",\"type\":\"info\",\"show-icon\":\"\"}}),_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":_vm.url,\"show-file-list\":false,\"on-success\":_vm.done,\"on-error\":_vm.fail,\"with-credentials\":\"\",\"accept\":\"image/jpg,image/jpeg,image/gif,image/png,image/bmp\"}},[(_vm.post_banner)?_c('img',{attrs:{\"src\":_vm._f(\"showBanner\")(_vm.post_banner)}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})]),_c('el-button',{staticClass:\"u-remove\",attrs:{\"type\":\"info\",\"size\":\"mini\",\"icon\":\"el-icon-circle-close\"},on:{\"click\":_vm.clearBanner}},[_vm._v(\"移除海报\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-publish-banner\">\n        <el-alert class=\"u-tip\" title=\"图片尺寸180*100像素，非必选，部分栏目不会展示海报，分享功能将使用该图作为预览图\" type=\"info\" show-icon> </el-alert>\n        <el-upload\n            class=\"avatar-uploader\"\n            :action=\"url\"\n            :show-file-list=\"false\"\n            :on-success=\"done\"\n            :on-error=\"fail\"\n            with-credentials\n            accept=\"image/jpg,image/jpeg,image/gif,image/png,image/bmp\"\n        >\n            <img v-if=\"post_banner\" :src=\"post_banner | showBanner\" />\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n        </el-upload>\n        <el-button class=\"u-remove\" type=\"info\" size=\"mini\" icon=\"el-icon-circle-close\" @click=\"clearBanner\">移除海报</el-button>\n    </div>\n</template>\n\n<script>\nimport { __server } from \"@jx3box/jx3box-common/js/jx3box.json\";\nimport { showMinibanner } from \"@jx3box/jx3box-common/js/utils\";\nconst API = __server + \"upload\";\n// const API = \"http://localhost:5160/\" + \"publish/upload\";\n\nexport default {\n    name: \"post_banner\",\n    props: [\"banner\"],\n    data() {\n        return {\n            post_banner: this.banner,\n            url: API,\n        };\n    },\n    methods: {\n        done(res, file) {\n            this.post_banner = res.data.list[0];\n            this.$store.commit(\"editBanner\", this.post_banner);\n        },\n        fail(err, file, fileList) {\n            try {\n                let response = JSON.parse(err.message);\n                this.$message.error(`[${response.code}]${response.msg}`);\n            } catch {\n                this.$message.error(\"网络请求异常\");\n            }\n        },\n        clearBanner : function (){\n            this.post_banner = ''\n            this.$store.commit(\"editBanner\", this.post_banner);\n        }\n    },\n    filters : {\n        showBanner : function (val){\n            return showMinibanner(val)\n        }\n    }\n};\n</script>\n\n<style lang=\"less\">\n.m-publish-banner {\n    .u-tip{\n        padding:5px 15px;\n    }\n    img {\n        max-width: 180px;\n    }\n    .avatar-uploader{\n        .mt(10px);\n    }\n    .avatar-uploader .el-upload {\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n    }\n    .avatar-uploader .el-upload:hover {\n        border-color: #409eff;\n    }\n    .avatar-uploader-icon {\n        font-size: 28px;\n        color: #8c939d;\n        width: 180px;\n        height: 100px;\n        line-height: 100px;\n        text-align: center;\n    }\n    .u-remove{\n        background-color: #c2c2c2;\n        border-color:#c2c2c2;\n        &:hover{\n            background-color: #fc3c3c;\n            border-color:#fc3c3c;\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./post_banner.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./post_banner.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./post_banner.vue?vue&type=template&id=37da0aa0&\"\nimport script from \"./post_banner.vue?vue&type=script&lang=js&\"\nexport * from \"./post_banner.vue?vue&type=script&lang=js&\"\nimport style0 from \"./post_banner.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./post_banner.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./post_banner.vue?vue&type=style&index=0&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}