{"version":3,"sources":["webpack:///./src/views/avatar.vue?421c","webpack:///./src/views/avatar.vue","webpack:///src/views/avatar.vue","webpack:///./src/views/avatar.vue?24d6","webpack:///./src/views/avatar.vue?e971"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_f","avatar","upload","_v","on","submit","reset","class","isVIP","frames","frame","$event","selectFrame","directives","name","rawName","value","expression","_l","item","key","desc","status","showFrame","_e","staticRenderFns","props","data","bak","uid","computed","user_avatar","user_avatar_frame","methods","formdata","uploadAvatar","message","type","title","updateAvatar","User","loadFrames","getFrames","init","getUserOverview","filters","showAvatar","showSmallAvatar","created","components","uc","component"],"mappings":"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","file":"js/chunk-7dceaaa0.eb2ed9d9.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=style&index=0&id=22e41d2a&prod&lang=less&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('uc',{staticClass:\"m-dashboard-avatar\"},[_c('div',{staticClass:\"m-profile-avatar\"},[_c('div',{staticClass:\"m-profile-avatar-primary\"},[_c('div',{staticClass:\"u-avatar\"},[_c('img',{staticClass:\"u-avatar u-avatar-l\",attrs:{\"src\":_vm._f(\"showAvatar\")(_vm.avatar)}})]),_c('el-upload',{staticClass:\"u-upload\",attrs:{\"drag\":\"\",\"accept\":\"image/png, image/gif, image/jpeg\",\"on-change\":_vm.upload,\"action\":\"upload/avatar\",\"auto-upload\":false}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\" 将文件拖到此处，或 \"),_c('em',[_vm._v(\"点击上传\")]),_c('br'),_c('span',{staticClass:\"u-tip\"},[_vm._v(\"只能上传jpg/png/gif文件\")])])]),_c('p',{staticClass:\"u-btng\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(\"确认\")]),_c('el-button',{on:{\"click\":_vm.reset}},[_vm._v(\"重置\")])],1)],1),_c('div',{staticClass:\"m-profile-avatar-frame\"},[_c('h3',{staticClass:\"u-title\"},[_vm._v(\" 自定义头像框 \"),_c('span',{staticClass:\"u-limit\",class:{ on: _vm.isVIP }},[_vm._v(\" ( \"),_c('i',{class:_vm.isVIP ? 'el-icon-unlock' : 'el-icon-lock'}),_vm._v(\"仅\"),_c('a',{attrs:{\"href\":\"/vip/premium?from=dashboard_avatar\",\"target\":\"_blank\"}},[_vm._v(\"高级/专业版\")]),_vm._v(\"账户适用 ) \")])]),(_vm.frames)?_c('div',{staticClass:\"u-list\"},[_c('li',{staticClass:\"u-item\",class:{ on: !_vm.frame },on:{\"click\":function($event){return _vm.selectFrame('')}}},[_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"无边框\",\"placement\":\"top\",\"open-delay\":200}},[_c('div',[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.frame),expression:\"!frame\"}],staticClass:\"u-pic\",attrs:{\"src\":_vm._f(\"showSmallAvatar\")(_vm.avatar)}}),_c('i',{staticClass:\"u-frame u-frame-none\"})])])],1),_vm._l((_vm.frames),function(item,name){return _c('li',{key:name,staticClass:\"u-item\",class:{ on: name == _vm.frame },on:{\"click\":function($event){return _vm.selectFrame(item)}}},[_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":item.desc,\"placement\":\"top\",\"open-delay\":300}},[_c('div',{class:{ 'u-blocked': !item.status }},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(name == _vm.frame),expression:\"name == frame\"}],staticClass:\"u-pic isCircle\",attrs:{\"src\":_vm._f(\"showSmallAvatar\")(_vm.avatar)}}),_c('i',{staticClass:\"u-frame\"},[_c('img',{attrs:{\"src\":_vm.showFrame(item.name)}})])])])],1)})],2):_vm._e(),_c('div',{staticClass:\"u-tip\"},[_c('i',{staticClass:\"el-icon-warning-outline\"}),_vm._v(\" 「限定头像框」仅在指定时间段可选择激活。 \")])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <uc class=\"m-dashboard-avatar\">\n        <div class=\"m-profile-avatar\">\n            <div class=\"m-profile-avatar-primary\">\n                <div class=\"u-avatar\">\n                    <img class=\"u-avatar u-avatar-l\" :src=\"avatar | showAvatar\" />\n                </div>\n                <el-upload class=\"u-upload\" drag accept=\"image/png, image/gif, image/jpeg\" :on-change=\"upload\" action=\"upload/avatar\" :auto-upload=\"false\">\n                    <i class=\"el-icon-upload\"></i>\n                    <div class=\"el-upload__text\">\n                        将文件拖到此处，或\n                        <em>点击上传</em>\n                        <br />\n                        <span class=\"u-tip\">只能上传jpg/png/gif文件</span>\n                    </div>\n                </el-upload>\n                <p class=\"u-btng\">\n                    <el-button type=\"primary\" @click=\"submit\">确认</el-button>\n                    <el-button @click=\"reset\">重置</el-button>\n                </p>\n            </div>\n            <div class=\"m-profile-avatar-frame\">\n                <h3 class=\"u-title\">\n                    自定义头像框\n                    <span class=\"u-limit\" :class=\"{ on: isVIP }\">\n                        ( <i :class=\"isVIP ? 'el-icon-unlock' : 'el-icon-lock'\"></i>仅<a href=\"/vip/premium?from=dashboard_avatar\" target=\"_blank\">高级/专业版</a>账户适用 )\n                    </span>\n                </h3>\n                <div class=\"u-list\" v-if=\"frames\">\n                    <li class=\"u-item\" :class=\"{ on: !frame }\" @click=\"selectFrame('')\">\n                        <el-tooltip class=\"item\" effect=\"dark\" content=\"无边框\" placement=\"top\" :open-delay=\"200\">\n                            <div>\n                                <img :src=\"avatar | showSmallAvatar\" v-show=\"!frame\" class=\"u-pic\" />\n                                <i class=\"u-frame u-frame-none\"></i>\n                            </div>\n                        </el-tooltip>\n                    </li>\n                    <li class=\"u-item\" :class=\"{ on: name == frame }\" v-for=\"(item, name) in frames\" :key=\"name\" @click=\"selectFrame(item)\">\n                        <el-tooltip class=\"item\" effect=\"dark\" :content=\"item.desc\" placement=\"top\" :open-delay=\"300\">\n                            <div :class=\"{ 'u-blocked': !item.status }\">\n                                <img :src=\"avatar | showSmallAvatar\" v-show=\"name == frame\" class=\"u-pic isCircle\" />\n                                <i class=\"u-frame\">\n                                    <img :src=\"showFrame(item.name)\" />\n                                </i>\n                            </div>\n                        </el-tooltip>\n                    </li>\n                </div>\n                <div class=\"u-tip\">\n                    <i class=\"el-icon-warning-outline\"></i>\n                    「限定头像框」仅在指定时间段可选择激活。\n                </div>\n            </div>\n        </div>\n    </uc>\n</template>\n\n<script>\nimport uc from \"@/components/uc.vue\";\nimport { updateAvatar, uploadAvatar, getFrames, getUserOverview } from \"@/service/profile\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { showAvatar, getThumbnail } from \"@jx3box/jx3box-common/js/utils\";\nimport frames from \"@jx3box/jx3box-common/data/user_avatar_frame.json\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nexport default {\n    name: \"avatar\",\n    props: [],\n    data: function() {\n        return {\n            // 备份\n            bak: \"\",\n            // 数据\n            avatar: \"\",\n            frame: \"\",\n            // VIP\n            isVIP: false,\n            uid: User.getInfo().uid,\n            // 头像框\n            frames,\n        };\n    },\n    computed: {\n        data: function() {\n            return {\n                user_avatar: this.avatar,\n                user_avatar_frame: this.frame,\n            };\n        },\n    },\n    methods: {\n        upload: function(file, fileList) {\n            let formdata = new FormData();\n            let filedata = file.raw;\n            formdata.append(\"avatar\", filedata);\n            uploadAvatar(formdata).then((res) => {\n                this.$message({\n                    message: \"上传成功\",\n                    type: \"success\",\n                });\n                this.avatar = res.data.data[0];\n            });\n        },\n        reset: function() {\n            this.avatar = this.bak;\n        },\n        submit: function() {\n            if (!this.isVIP) {\n                if (this.frame) {\n                    this.$notify({\n                        title: \"头像框未生效\",\n                        message: \"头像框仅高级/专业账号可用\",\n                        type: \"warning\",\n                    });\n                }\n                this.frame = \"\";\n            }\n            updateAvatar(this.data).then((res) => {\n                User.refresh(\"avatar\", this.avatar);\n                this.$message({\n                    message: \"头像更新成功\",\n                    type: \"success\",\n                });\n            });\n        },\n        loadFrames: function() {\n            getFrames().then((res) => {\n                this.frames = res.data;\n            });\n        },\n        showFrame: function(name) {\n            // if (process.env.NODE_ENV == \"development\") {\n            //     return `temp/avatar/${name}/${name}.svg`;\n            // }\n            return __imgPath + `avatar/images/${name}/${name}.svg`;\n        },\n        selectFrame: function(item) {\n            if (!item) {\n                this.frame = \"\";\n                return;\n            }\n            if (item.status) {\n                this.frame = item.name;\n            }\n        },\n        init: function() {\n            this.loadFrames();\n            User.isVIP().then((data) => {\n                this.isVIP = data;\n            });\n\n            this.avatar = this.bak = User.getInfo().avatar_origin;\n            getUserOverview(this.uid).then((res) => {\n                this.frame = res.data.data.user_avatar_frame || \"\";\n            });\n        },\n    },\n    filters: {\n        showAvatar: function(val) {\n            return showAvatar(val, 480,false);\n        },\n        showSmallAvatar: function(val) {\n            return showAvatar(val, 136,false);\n        },\n    },\n    created: function() {\n        this.init();\n    },\n    components: {\n        uc,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/profile/avatar.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./avatar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./avatar.vue?vue&type=template&id=22e41d2a&\"\nimport script from \"./avatar.vue?vue&type=script&lang=js&\"\nexport * from \"./avatar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./avatar.vue?vue&type=style&index=0&id=22e41d2a&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}