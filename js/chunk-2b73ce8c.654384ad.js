(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b73ce8c"],{"25f0":function(t,e,o){"use strict";var a=o("6eeb"),s=o("825a"),n=o("d039"),i=o("ad6d"),l="toString",c=RegExp.prototype,r=c[l],u=n((function(){return"/a/b"!=r.call({source:"a",flags:"b"})})),p=r.name!=l;(u||p)&&a(RegExp.prototype,l,(function(){var t=s(this),e=String(t.source),o=t.flags,a=String(void 0===o&&t instanceof RegExp&&!("flags"in c)?i.call(t):o);return"/"+e+"/"+a}),{unsafe:!0})},2784:function(t,e,o){"use strict";o("8ae2")},"461a":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"m-dashboard-publish-macro"},[t.loaded?o("boilerplate",{attrs:{name:t.name,type:t.type,post:t.post,meta:t.meta,extend:t.extend,infoEnable:!0,contentEnable:!0,markdownEnable:!1,excerptEnable:!1,tagEnable:!1,notifyEnable:!0,bannerEnable:!0,collectionEnable:!0,publish_text:"发布为公开",draft_text:"发布为私有"},on:{publish:t.toPublish,draft:t.toDraft}},[[o("el-form-item",{attrs:{label:"原创"}},[o("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.post.original,callback:function(e){t.$set(t.post,"original",e)},expression:"post.original"}})],1),o("el-form-item",{attrs:{label:"语言"}},[o("el-radio-group",{model:{value:t.post.post_meta.lang,callback:function(e){t.$set(t.post.post_meta,"lang",e)},expression:"post.post_meta.lang"}},[o("el-radio",{attrs:{label:"cn"}},[t._v("简体中文")]),o("el-radio",{attrs:{label:"tr"}},[t._v("繁體中文")])],1)],1),o("el-form-item",{attrs:{label:"版本"}},[o("el-radio-group",{model:{value:t.post.client,callback:function(e){t.$set(t.post,"client",e)},expression:"post.client"}},[o("el-radio",{attrs:{label:"std"}},[t._v("正式服")]),o("el-radio",{attrs:{label:"origin"}},[t._v("怀旧服")]),o("el-radio",{attrs:{label:"all"}},[t._v("全部")])],1)],1),o("el-form-item",{attrs:{label:"资料片"}},[o("el-select",{staticClass:"m-publish-zlp m-macro-zlp",attrs:{filterable:"",placeholder:"资料片"},model:{value:t.post.post_meta.zlp,callback:function(e){t.$set(t.post.post_meta,"zlp",e)},expression:"post.post_meta.zlp"}},t._l(t.options.zlps,(function(t){return o("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),o("el-form-item",{staticClass:"m-publish-xf m-macro-xf",attrs:{label:"心法"}},t._l(t.options.xfmap,(function(e,a){return o("el-radio",{key:a,attrs:{label:e.name},on:{change:t.changeSubtype},model:{value:t.post.post_subtype,callback:function(e){t.$set(t.post,"post_subtype",e)},expression:"post.post_subtype"}},[o("img",{staticClass:"u-pic",attrs:{src:t._f("xficon")(e.id),alt:e.name}}),o("span",{staticClass:"u-txt"},[t._v(t._s(e.name))])])})),1),o("el-divider",{attrs:{"content-position":"left"}},[t._v("宏")]),o("div",{staticClass:"m-macro-box"},[o("div",{staticClass:"m-macro-header"},[o("el-button",{staticClass:"m-macro-addbutton",attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:t.addMacro}},[t._v("添加宏")]),o("a",{staticClass:"m-macro-docs el-button el-button--primary is-plain el-button--small",attrs:{target:"_blank",href:"https://www.jx3box.com/tool/265/"}},[o("i",{staticClass:"el-icon-s-management"}),t._v(" 宏命令完整参考手册 ")]),o("a",{staticClass:"m-macro-help el-button el-button--success is-plain el-button--small",attrs:{href:"https://www.jx3box.com/tool/14671/",target:"_blank"}},[o("i",{staticClass:"el-icon-info"}),t._v(" 点击查看发布帮助 ")])],1),o("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":t.removeMacro},model:{value:t.activeMacroIndex,callback:function(e){t.activeMacroIndex=e},expression:"activeMacroIndex"}},t._l(t.post.post_meta.data,(function(e,a){return o("el-tab-pane",{key:a,attrs:{name:a+1+""}},[o("span",{attrs:{slot:"label"},slot:"label"},[o("img",{staticClass:"u-tabicon",attrs:{src:t.icon(e)}}),t._v(" "+t._s(a+1+"号位-"+e.name)+" ")]),o("div",{staticClass:"m-macro-cloud m-macro-item"},[o("h5",{staticClass:"u-title"},[t._v(" 云端宏图标/名称 "),o("a",{staticClass:"u-icon-links",attrs:{href:"/app/icons",target:"_blank"}},[o("i",{staticClass:"el-icon-question"}),t._v(" 图标大全 ")])]),o("div",{staticClass:"u-group"},[o("div",{staticClass:"u-subblock m-macro-icon"},[o("el-input",{attrs:{placeholder:"图标ID",minlength:1,maxlength:10,max:3e4,min:0},model:{value:e.icon,callback:function(o){t.$set(e,"icon",o)},expression:"item.icon"}},[o("template",{slot:"prepend"},[o("img",{staticClass:"u-icon",attrs:{src:t.icon(e)}})])],2)],1),o("div",{staticClass:"u-subblock m-macro-name"},[o("el-input",{attrs:{placeholder:"每个宏名称请使用自己名下唯一命名",minlength:1,maxlength:20,"show-word-limit":""},on:{change:function(o){return t.checkDataName(e)}},model:{value:e.name,callback:function(o){t.$set(e,"name",o)},expression:"item.name"}},[o("template",{slot:"prepend"},[o("b",{staticClass:"u-feed"},[t._v(" "+t._s(t.nickname)+"#"+t._s(e.name)+" ")])])],2)],1)])]),o("div",{staticClass:"m-macro-talent m-macro-item"},[o("h5",{staticClass:"u-title"},[t._v("奇穴方案")]),o("div",{staticClass:"m-macro-talent-simulator"},[o("div",{staticClass:"qx-container"})]),o("el-input",{attrs:{placeholder:"奇穴方案编码"},on:{change:function(o){return t.checkTalent(e)}},model:{value:e.talent,callback:function(o){t.$set(e,"talent",o)},expression:"item.talent"}},[o("template",{slot:"prepend"},[o("a",{staticClass:"u-get",attrs:{target:"_blank",href:"/app/talent"}},[o("i",{staticClass:"el-icon-warning"}),t._v(" 获取编码 ")])])],2)],1),o("div",{staticClass:"m-macro-macro"},[o("h5",{staticClass:"u-title"},[t._v(" 宏内容 "),o("a",{staticClass:"u-icon-links",attrs:{href:"/app/macroeditor",target:"_blank"}},[o("i",{staticClass:"el-icon-question"}),t._v(" 智能中文宏编辑器 ")])]),o("el-input",{attrs:{placeholder:"注释请写在说明中,勿写在宏内部",minlength:1,maxlength:128,"show-word-limit":"",type:"textarea",rows:12},model:{value:e.macro,callback:function(o){t.$set(e,"macro",o)},expression:"item.macro"}})],1),o("div",{staticClass:"m-macro-equip"},[o("h5",{staticClass:"u-title"},[t._v(" 配装方案 "),o("a",{staticClass:"u-icon-links",attrs:{href:"/tool/19309",target:"_blank"}},[o("i",{staticClass:"el-icon-question"}),t._v(" 魔盒清单使用指南 ")])]),o("el-input",{attrs:{placeholder:"配装方案编号"},model:{value:e.equip,callback:function(o){t.$set(e,"equip",o)},expression:"item.equip"}},[o("template",{slot:"prepend"},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.equip_type,callback:function(o){t.$set(e,"equip_type",o)},expression:"item.equip_type"}},t._l(t.options.equip_types,(function(t,e){return o("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)],2)],1),o("el-form-item",{staticClass:"m-macro-misc",attrs:{label:"其它"}},[o("el-row",[o("el-col",{staticClass:"u-speed",attrs:{span:8}},[o("el-input",{attrs:{placeholder:"填写推荐的急速阈值"},model:{value:e.speed,callback:function(o){t.$set(e,"speed",o)},expression:"item.speed"}},[o("template",{slot:"prepend"},[t._v("急速阈值")])],2)],1),o("el-col",{attrs:{span:8}})],1)],1),o("el-form-item",{staticClass:"m-macro-desc",attrs:{label:"说明"}},[o("el-input",{attrs:{type:"textarea",placeholder:"重要说明（会出现在宏第一行）"},model:{value:e.desc,callback:function(o){t.$set(e,"desc",o)},expression:"item.desc"}})],1),o("div",{staticClass:"m-macro-op"},[o("el-button",{staticClass:"u-macro-remove-fix",attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.removeMacro(a)}}},[t._v("移除本宏")])],1)],1)})),1)],1)]],2):t._e()],1)},s=[],n=(o("b0c0"),o("a434"),o("159b"),o("d3b7"),o("25f0"),o("2ef0")),i=o.n(n),l=o("bd13"),c=o("c9d2"),r=o("7c7e"),u=o("46d4"),p=o("d2b6"),d=o("65c2"),m=o("c202"),f=o("41cb"),h=o("fb92");function b(t,e){var o=g(t);return console.log("正在执行redis同步作业:",o),Object(f["e"])().post("/api/macro/publish",o)}function g(t){var e=t.author,o=t.ID,a={author:e,user_id:~~t.post_author||0,post_id:o,post_status:t.post_status,data:{},lang:t.post_meta.lang,original:t.original},s=u[t.post_subtype]["id"]+"";return t.post_meta.data.forEach((function(t,n){var i="";i+="【奇穴】";var l="";try{l=t.talent&&JSON.parse(t.talent),i+=l.sq}catch(c){console.log("奇穴编码解析失败",c)}i+="\n【最后更新于】",i+=Object(h["a"])(new Date),i+="\n【来源】JX3BOX",t.name||(t.name=Date.now()),a.data[t.name]={author:e,key:t.name,version:Date.now(),icon:~~t.icon||13,xf:s||0,data:t.macro,desc:i,about:d["__Root"]+"macro/"+o}})),a}var _=o("faf3"),v={zlp:p[0],lang:"cn",data:[{name:"",icon:13,talent:"",macro:"",speed:"",equip:"",equip_type:"jx3box",desc:""}]},k={name:"macro",props:[],data:function(){return{type:"macro",name:"云端宏",loaded:!1,options:{zlps:p,xfmap:u,equip_types:{jx3box:"魔盒清单"}},meta:{},post:{ID:"",post_subtype:"通用",post_title:"",post_content:"",post_meta:v,post_excerpt:"",post_mode:"tinymce",post_banner:"",post_status:"",post_collection:"",original:0,client:"std"},extend:{feedEnable:!1,followEnable:!1,tencentEnable:!1,weiboEnable:!1,tuilanEnable:!1},activeMacroIndex:"1",nickname:c["a"].getInfo().name}},computed:{},methods:{init:function(){var t=this;return this.doLoad(this).then((function(){Object(r["a"])(t.post.post_meta)&&(t.post.post_meta=v),console.log("Init Post:",t.post)}))},toPublish:function(){this.postData()},toDraft:function(){this.postData()},postData:function(){var t=this;this.check(),this.doPublish(this.build(),this,!1).then((function(e){b(e.data.data,t).then((function(o){t.finish(e.data.msg,e.data.data.ID)}))}))},finish:function(t,e){var o=this;this.$message({message:t,type:"success"}),setTimeout((function(){location.href="/"+o.type+"/"+e}),500)},build:function(){var t=this.$store.state;return t.post.meta_1=t.post.post_meta.zlp,t.post.meta_2=~~i.a.get(u[t.post.post_subtype],"id"),t.post.meta_4=t.post.post_meta.lang,t},addMacro:function(){if(this.post.post_meta.data.length>7)this.$alert("已经达到添加上限","消息",{confirmButtonText:"确定"});else{var t=this.post.post_meta.data.length+1+"";this.post.post_meta.data.push({name:"",icon:13,talent:"",macro:"",speed:"",equip:"",equip_type:"",desc:""}),this.activeMacroIndex=t}},removeMacro:function(t){var e=this;this.post.post_meta.data.length<2?this.$alert("必须保留1个宏","消息",{confirmButtonText:"确定"}):this.$alert("确定删除这个宏吗，删除后无法找回","消息",{confirmButtonText:"确定",callback:function(o){if("confirm"==o){var a=~~t-1;e.post.post_meta.data.splice(a,1),e.activeMacroIndex=a+""}}})},check:function(){this.post.post_title||(this.post.post_title=c["a"].getInfo().name+"的宏"),this.post.post_meta.data.forEach((function(t,e){t.name||(t.name="未标题-"+e)}))},checkDataName:function(t){var e=Object(l["a"])(t.name).removeSpace().kill().toString();e?this.$set(t,"name",e):this.$notify.error({title:"错误",message:"宏名称不允许包含特殊字符,不能为空"})},checkTalent:function(t){try{JSON.parse(t.talent)}catch(e){this.$notify.error({title:"错误",message:"奇穴编码格式错误"})}},icon:function(t){var e=isNaN(t.icon)?13:~~t.icon;return e=Math.max(0,Math.min(e,3e4)),this.$set(t,"icon",e),d["__iconPath"]+"icon/"+e+".png"},changeSubtype:function(){var t=u[this.post.post_subtype]["icon"];this.$set(this.post.post_meta.data[0],"icon",t)}},filters:{xficon:function(t){return d["__imgPath"]+"image/xf/"+t+".png"}},mounted:function(){var t=this;this.init(),Object(_["a"])().then((function(e){t.options.zlps=e.data}))},components:{boilerplate:m["a"]}},y=k,x=(o("2784"),o("2877")),C=Object(x["a"])(y,a,s,!1,null,null,null);e["default"]=C.exports},"46d4":function(t){t.exports=JSON.parse('{"冰心诀":{"name":"冰心诀","color":"#FF7DAD","id":10081,"icon":888,"force":5,"kungfuId":10,"school":4,"client":["all","std","origin"]},"云裳心经":{"name":"云裳心经","color":"#ffadcb","id":10080,"icon":887,"force":5,"kungfuId":9,"school":4,"client":["all","std","origin"]},"花间游":{"name":"花间游","color":"#BA9BE4","id":10021,"icon":406,"force":2,"kungfuId":5,"school":2,"client":["all","std","origin"]},"离经易道":{"name":"离经易道","color":"#d8c4ff","id":10028,"icon":412,"force":2,"kungfuId":7,"school":2,"client":["all","std","origin"]},"毒经":{"name":"毒经","color":"#4B9BFB","id":10175,"icon":2766,"force":6,"kungfuId":13,"school":9,"client":["all","std"]},"补天诀":{"name":"补天诀","color":"#7db8ff","id":10176,"icon":2767,"force":6,"kungfuId":14,"school":9,"client":["all","std"]},"莫问":{"name":"莫问","color":"#6DDFE2","id":10447,"icon":7071,"force":22,"kungfuId":22,"school":19,"client":["all","std"]},"相知":{"name":"相知","color":"#78f0f3","id":10448,"icon":7067,"force":22,"kungfuId":23,"school":19,"client":["all","std"]},"傲血战意":{"name":"傲血战意","color":"#EC4B2C","id":10026,"icon":633,"force":3,"kungfuId":6,"school":1,"client":["all","std","origin"]},"铁牢律":{"name":"铁牢律","color":"#d43618","id":10062,"icon":632,"force":3,"kungfuId":8,"school":1,"client":["all","std","origin"]},"易筋经":{"name":"易筋经","color":"#E6BC31","id":10003,"icon":425,"force":1,"kungfuId":2,"school":5,"client":["all","std","origin"]},"洗髓经":{"name":"洗髓经","color":"#b58f12","id":10002,"icon":429,"force":1,"kungfuId":1,"school":5,"client":["all","std","origin"]},"焚影圣诀":{"name":"焚影圣诀","color":"#f16040","id":10242,"icon":3865,"force":10,"kungfuId":17,"school":8,"client":["all","std"]},"明尊琉璃体":{"name":"明尊琉璃体","color":"#c55036","id":10243,"icon":3864,"force":10,"kungfuId":18,"school":8,"client":["all","std"]},"分山劲":{"name":"分山劲","color":"#6568ad","id":10390,"icon":6314,"force":21,"kungfuId":21,"school":18,"client":["all","std"]},"铁骨衣":{"name":"铁骨衣","color":"#4f5186","id":10389,"icon":6315,"force":21,"kungfuId":20,"school":18,"client":["all","std"]},"紫霞功":{"name":"紫霞功","color":"#37C0E2","id":10014,"icon":627,"force":4,"kungfuId":3,"school":3,"client":["all","std","origin"]},"太虚剑意":{"name":"太虚剑意","color":"#48d6f9","id":10015,"icon":619,"force":4,"kungfuId":4,"school":3,"client":["all","std","origin"]},"天罗诡道":{"name":"天罗诡道","color":"#90CC50","id":10225,"icon":3184,"force":7,"kungfuId":16,"school":10,"client":["all","std"]},"惊羽诀":{"name":"惊羽诀","color":"#a2e05f","id":10224,"icon":3165,"force":7,"kungfuId":15,"school":10,"client":["all","std"]},"问水诀":{"name":"问水诀","color":"#FDDD70","id":10144,"icon":2376,"force":8,"kungfuId":11,"school":6,"client":["all","std"]},"笑尘诀":{"name":"笑尘诀","color":"#D6A16F","id":10268,"icon":4610,"force":9,"kungfuId":19,"school":7,"client":["all","std"]},"北傲诀":{"name":"北傲诀","color":"#8D90D8","id":10464,"icon":8424,"force":23,"kungfuId":24,"school":20,"client":["all","std"]},"凌海诀":{"name":"凌海诀","color":"#94C7DC","id":10533,"icon":10709,"force":24,"kungfuId":25,"school":21,"client":["all","std"]},"隐龙诀":{"name":"隐龙诀","color":"#872F37","id":10585,"icon":12128,"force":25,"kungfuId":26,"school":22,"client":["all","std"]},"太玄经":{"name":"太玄经","color":"#b9c1ff","id":10615,"icon":13894,"force":211,"kungfuId":27,"school":23,"client":["all","std"]},"通用":{"name":"通用","color":"#c3c5c1","id":0,"icon":2589,"force":0,"kungfuId":0,"school":0,"client":["all","std","origin"]}}')},"7c7e":function(t,e,o){"use strict";o("a4d3"),o("e01a"),o("d3b7"),o("d28b"),o("3ca3"),o("ddb0");function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}o("b64b"),e["a"]=function(t){return!t||(!(!Array.isArray(t)||t.length)||"object"==a(t)&&!Object.keys(t).length)}},"8ae2":function(t,e,o){},b64b:function(t,e,o){var a=o("23e7"),s=o("7b0b"),n=o("df75"),i=o("d039"),l=i((function(){n(1)}));a({target:"Object",stat:!0,forced:l},{keys:function(t){return n(s(t))}})},bd13:function(t,e,o){"use strict";function a(t){var e=Object.prototype.toString.call(t);return e.match(/\[object (.*?)\]/)[1].toLowerCase()}o.d(e,"a",(function(){return i}));var s=a;class n{constructor(t){if("string"!==s(t))throw new Error("[Sterilizer::init] params should be string");this._symbols={"`":"`","~":"~","!":"!","@":"@","#":"#",$:"\\$","%":"%","^":"\\^","&":"&","*":"\\*","-":"\\-",_:"_","=":"=","+":"+","(":"\\(",")":"\\)","[":"\\[","]":"\\]","{":"\\{","}":"\\}","|":"\\|","\\":"\\\\","/":"/","?":"\\?",":":":",";":";","'":"'",'"':'"',">":">","<":"<",",":",",".":"\\."},this.symbols=Object.keys(this._symbols),this.regs=Object.values(this._symbols),this.str=t,this._str=t}toString(){return this._str}_detected(t){let e=s(t),o=["string","array","set"];if(!o.includes(e))throw new Error("[Sterilizer::remove] params should be string|array|set");return t}_sterilize(t){t=[...t].join("");let e=new RegExp(`[${t}]`,"gm");return this._str=this._str.replace(e,""),this}kill(t){let e=null;if(void 0==t)e=new Set(this.regs);else{this._detected(t),e=new Set;let o=new Set(t);for(let t of o)this.symbols.includes(t)&&e.add(this._symbols[t])}return this._sterilize(e)}live(t){this._detected(t);let e=new Set(this.regs);for(let o of t)this.symbols.includes(o)&&e.delete(this._symbols[o]);return this._sterilize(e)}safe(){return this.kill(["&","<",">",'"',"'","+",":","/","?","=","#","%"])}removeHSC(){return this.kill(["&","<",">",'"',"'"])}removeURL(){return this.kill(["+",":","/","?","=","&","#","%"])}removeSpace(){return this._str=this._str.replace(/\s/gm,""),this}remove(t,e){let o=new RegExp(""+t,"gm");return e=void 0!==e?e:"",this._str=this._str.replace(o,e),this}removeHTMLtag(){return this._str=this._str.replace(/<[^>]+>/gm,""),this}isDirty(t){return t?this.str.includes(t):this.symbols.some(t=>this.str.includes(t))}}function i(t){return new n(t)}},d2b6:function(t){t.exports=JSON.parse('["奉天证道","结庐在江湖","凌雪藏锋","怒海争锋","其它"]')},faf3:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var a=o("bc3a"),s=o.n(a),n=o("65c2");function i(){return s.a.get(n["__dataPath"]+"data/common/zlps.json")}},fb92:function(t,e,o){"use strict";o("99af");function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),l=o?"".concat(a).concat(e).concat(s(n)).concat(e).concat(s(i)):"".concat(a).concat(e).concat(n).concat(e).concat(i);return l}function s(t){return t<10?"0"+t:t}e["a"]=a}}]);
//# sourceMappingURL=chunk-2b73ce8c.654384ad.js.map