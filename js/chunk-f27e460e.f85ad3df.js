(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f27e460e"],{"33de":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-dashboard m-dashboard-work m-dashboard-msg"},[a("div",{staticClass:"m-dashboard-msg-header"},[t._m(0),a("el-button",{staticClass:"u-read-all",attrs:{type:"primary",size:"mini",disabled:!t.unread_total},on:{click:function(e){return t.read(null)}}},[a("i",{staticClass:"el-icon el-icon-check"}),a("span",{domProps:{textContent:t._s("全部设为已读")}})])],1),a("el-input",{staticClass:"m-dashboard-work-search",attrs:{placeholder:"请输入搜索内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changePage(1)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[a("template",{slot:"prepend"},[t._v("关键词")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.changePage(1)}},slot:"append"})],2),t.data.length?a("ul",{staticClass:"m-dashboard-box-list"},t._l(t.data,(function(e,n){return a("li",{directives:[{name:"show",rawName:"v-show",value:0==e.deleted,expression:"item.deleted == 0"}],key:n,class:{on:1==e.read}},[a("div",{staticClass:"u-primary"},[a("span",{staticClass:"u-content"},[1==e.read?a("span",{staticClass:"u-label u-hasChecked"},[t._v("已读")]):a("span",{staticClass:"u-label u-hasNotChecked"},[t._v("未读")]),a("span",{domProps:{innerHTML:t._s(e.content)}}),t.hasLink(e)?a("a",{staticClass:"u-msg-link",attrs:{href:t._f("msgLink")(e),target:"_blank"},on:{click:function(a){return t.read(e)}}},[a("i",{staticClass:"el-icon-link"}),t._v(" 点击查看 ")]):t._e()]),a("time",{staticClass:"u-time"},[a("i",{staticClass:"el-icon-phone-outline"}),t._v(" "+t._s(t.dateFormat(~~e.created))+" ")])]),a("el-button-group",{staticClass:"u-action"},[a("el-button",{attrs:{size:"mini",icon:"el-icon-check",title:"设为已读",disabled:1==e.read},on:{click:function(a){return t.read(e)}}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(a){return t.del(e)}}})],1)],1)})),0):a("el-alert",{staticClass:"m-dashboard-box-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),a("el-pagination",{staticClass:"m-dashboard-box-pages",attrs:{background:"","hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.changePage}})],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",{staticClass:"u-title"},[a("i",{staticClass:"el-icon-bell"}),t._v(" 我的消息 ")])}],r=(a("caad"),a("e9c4"),a("99af"),a("41cb")),i=a("4328"),o=a.n(i);function c(t){return Object(r["c"])().get("/api/messages?".concat(o.a.stringify(t)))}function d(t){var e={};return t&&(e.ids=t),Object(r["c"])().put("/api/messages/read",o.a.stringify(e))}function u(t){return Object(r["c"])().put("/api/messages/remove",o.a.stringify({ids:t}))}var l=a("e4f1"),p=a("85e4"),f=a("e762"),h=["namespace"],g={name:"msg",props:[],data:function(){return{keyword:"",type:"all",data:[],unread_total:0,total:1,page:1}},methods:{changePage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=e,c({where:{content:this.keyword},page:e}).then((function(e){t.unread_total=e.data.data.unread_count,t.total=e.data.data.total,t.data=e.data.data.messages}))},read:function(t){var e=this;d(t?[t.ID]:null).then((function(a){200===a.data.code?t?t.read=1:e.changePage(e.page):e.$notify.error({title:a.data.message})}))},del:function(t){var e=this;u([t.ID]).then((function(a){200===a.data.code?t.deleted=Math.round(new Date/1e3):e.$notify.error({title:a.data.message})}))},dateFormat:function(t){return Object(l["b"])(new Date(1e3*t))},hasLink:function(t){return!h.includes(t.source_type)&&!(!t.source_id||!t.source_type)}},filters:{msgLink:function(t){var e=t.source_id,a=t.source_type;if("birthday"==a)return"/author/birthday/".concat(t.user_id,"?code=")+f["a"].encode(e);if("sign"==a)return"/dashboard/#/cooperation";if("callback"==a){var n=encodeURIComponent(f["a"].encode(JSON.stringify(t)));return"/dashboard/#/".concat(t.type,"/").concat(t.subtype,"?info=").concat(n)}return"box_coin"==a?"/dashboard/#/boxcoin":Object(p["getLink"])(a,e)}},mounted:function(){this.changePage()}},m=g,b=(a("f7d0"),a("2877")),k=Object(b["a"])(m,n,s,!1,null,"0cc7b2d5",null);e["default"]=k.exports},6879:function(t,e,a){},e9c4:function(t,e,a){var n=a("23e7"),s=a("da84"),r=a("d066"),i=a("2ba4"),o=a("e330"),c=a("d039"),d=s.Array,u=r("JSON","stringify"),l=o(/./.exec),p=o("".charAt),f=o("".charCodeAt),h=o("".replace),g=o(1..toString),m=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,k=/^[\uDC00-\uDFFF]$/,y=function(t,e,a){var n=p(a,e-1),s=p(a,e+1);return l(b,t)&&!l(k,s)||l(k,t)&&!l(b,n)?"\\u"+g(f(t,0),16):t},v=c((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&n({target:"JSON",stat:!0,forced:v},{stringify:function(t,e,a){for(var n=0,s=arguments.length,r=d(s);n<s;n++)r[n]=arguments[n];var o=i(u,null,r);return"string"==typeof o?h(o,m,y):o}})},f7d0:function(t,e,a){"use strict";a("6879")}}]);
//# sourceMappingURL=chunk-f27e460e.f85ad3df.js.map