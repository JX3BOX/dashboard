{"version":3,"sources":["webpack:///./src/service/callback.js","webpack:///./src/views/callback/invitation_creators.vue?4613","webpack:///src/views/callback/invitation_creators.vue","webpack:///./src/views/callback/invitation_creators.vue?09ae","webpack:///./src/views/callback/invitation_creators.vue","webpack:///./src/views/callback/invitation_creators.vue?7921","webpack:///./src/utils/dateFormat.js"],"names":["getPost","post_id","$cms","get","getUser","user_id","isExistPostInvitation","quitUnionPost","delete","acceptPostInvitation","put","isExistKithInvitation","refuseKithInvitation","acceptKithInvitation","render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","_v","attrs","_f","userdata","user_avatar","data","_s","post_title","uid","display_name","info","updated","isNotExist","alreadyAccept","on","accept","confirmQuit","staticRenderFns","name","props","components","record","computed","Base64","id","post_link","watch","immediate","handler","methods","loadData","then","confirmButtonText","cancelButtonText","type","catch","quit","message","check","location","filters","postLink","authorLink","showAvatar","dateFormat","created","mounted","component","dt","separator","polished","year","getFullYear","month","getMonth","date","getDate","str","polish","val"],"mappings":"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","file":"js/chunk-742f405a.36c00630.js","sourcesContent":["import { $cms } from \"@jx3box/jx3box-common/js/https\";\n\nfunction getPost(post_id) {\n    return $cms().get(`/api/cms/post/${post_id}`);\n}\n\nfunction getUser(user_id) {\n    return $cms().get(`/api/cms/user/${user_id}/info`);\n}\n\n// 联合创作者\nfunction isExistPostInvitation(post_id) {\n    return $cms().get(`/api/cms/post/${post_id}/author/my`);\n}\n\nfunction quitUnionPost(post_id) {\n    return $cms().delete(`/api/cms/post/${post_id}/authors/quit`);\n}\n\nfunction acceptPostInvitation(post_id) {\n    return $cms().put(`/api/cms/post/${post_id}/author/my`);\n}\n\n// 亲友\nfunction isExistKithInvitation(user_id) {\n    return $cms().get(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nfunction refuseKithInvitation(user_id) {\n    return $cms().delete(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nfunction acceptKithInvitation(user_id) {\n    return $cms().put(`/api/cms/user/kith/${user_id}/invitation`);\n}\n\nexport { getPost, getUser, quitUnionPost, isExistPostInvitation, acceptPostInvitation, isExistKithInvitation, refuseKithInvitation, acceptKithInvitation };\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-callback m-invitation-creators\"},[_vm._m(0),_c('p',{staticClass:\"u-desc\"},[_vm._v(\"你收到了一条联合创作邀请。\")]),_c('div',{staticClass:\"u-post\"},[_c('div',{staticClass:\"u-post-avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"showAvatar\")(_vm.userdata.user_avatar)}})]),_c('div',{staticClass:\"u-post-info\"},[_c('a',{staticClass:\"u-post-title\",attrs:{\"href\":_vm._f(\"postLink\")(_vm.data),\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.data.post_title))]),_c('a',{staticClass:\"u-post-desc\",attrs:{\"href\":_vm._f(\"authorLink\")(_vm.uid),\"target\":\"_blank\"}},[_vm._v(\" @ \"),_c('b',[_vm._v(_vm._s(_vm.userdata.display_name))]),_c('time',{staticClass:\"u-post-time\"},[_vm._v(_vm._s(_vm._f(\"dateFormat\")(_vm.info.updated)))])])])]),_c('div',{staticClass:\"u-btns\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-check\",\"disabled\":_vm.isNotExist || _vm.alreadyAccept},on:{\"click\":_vm.accept}},[_vm._v(_vm._s(_vm.alreadyAccept ? \"已接受\" : \"接受\"))]),_c('el-button',{attrs:{\"type\":\"info\",\"icon\":\"el-icon-close\",\"disabled\":_vm.isNotExist},on:{\"click\":_vm.confirmQuit}},[_vm._v(_vm._s(_vm.alreadyAccept ? \"退出联合创作\" : \"拒绝\"))])],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"u-title\"},[_c('i',{staticClass:\"el-icon-message\"}),_vm._v(\" 邀请 \")])}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-callback m-invitation-creators\">\n        <h1 class=\"u-title\">\n            <i class=\"el-icon-message\"></i> 邀请\n        </h1>\n        <p class=\"u-desc\">你收到了一条联合创作邀请。</p>\n        <div class=\"u-post\">\n            <div class=\"u-post-avatar\">\n                <img :src=\"userdata.user_avatar | showAvatar\" />\n            </div>\n            <div class=\"u-post-info\">\n                <a class=\"u-post-title\" :href=\"data | postLink\" target=\"_blank\">{{data.post_title}}</a>\n                <a class=\"u-post-desc\" :href=\"uid | authorLink\" target=\"_blank\">\n                    @\n                    <b>{{userdata.display_name}}</b>\n                    <time class=\"u-post-time\">{{info.updated | dateFormat}}</time>\n                </a>\n            </div>\n        </div>\n        <div class=\"u-btns\">\n            <el-button\n                type=\"primary\"\n                icon=\"el-icon-check\"\n                :disabled=\"isNotExist || alreadyAccept\"\n                @click=\"accept\"\n            >{{ alreadyAccept ? \"已接受\" : \"接受\" }}</el-button>\n            <el-button type=\"info\" icon=\"el-icon-close\" @click=\"confirmQuit\" :disabled=\"isNotExist\">{{ alreadyAccept ? \"退出联合创作\" : \"拒绝\" }}</el-button>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { Base64 } from \"js-base64\";\nimport {\n    getPost,\n    getUser,\n    quitUnionPost,\n    isExistPostInvitation,\n    acceptPostInvitation,\n} from \"@/service/callback.js\";\nimport {\n    getLink,\n    showAvatar,\n    authorLink,\n} from \"@jx3box/jx3box-common/js/utils\";\nimport dateFormat from \"@/utils/dateFormat\";\nexport default {\n    name: \"CallbackCreators\",\n    props: [],\n    components: {},\n    data: function () {\n        return {\n            data: \"\",\n            userdata: \"\",\n            record: null,\n        };\n    },\n    computed: {\n        info: function () {\n            return JSON.parse(\n                Base64.decode(decodeURIComponent(this.$route.query.info))\n            );\n        },\n        id: function () {\n            return ~~this.info.source_id;\n        },\n        uid: function () {\n            return this.data?.post_author;\n        },\n        isNotExist: function () {\n            return !this.record;\n        },\n        alreadyAccept: function () {\n            return !!(this.record && this.record.status);\n        },\n        post_link: function () {\n            return getLink(this.data?.post_type, this.data?.ID);\n        },\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler: function (val) {\n                if (val) {\n                    this.loadData();\n                    this.check();\n                }\n            },\n        },\n    },\n    methods: {\n        loadData: function () {\n            getPost(this.id)\n                .then((res) => {\n                    this.data = res.data?.data;\n                })\n                .then(() => {\n                    getUser(this.uid).then((res) => {\n                        this.userdata = res.data?.data;\n                    });\n                });\n        },\n        confirmQuit: function() {\n            this.$confirm(\"确定退出联合创作吗？\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            })\n            .then(() => {\n                this.quit();\n            })\n            .catch(() => {});\n        },\n        quit: function () {\n            quitUnionPost(this.id).then(() => {\n                this.$message({\n                    message: \"操作成功\",\n                    type: \"success\",\n                });\n            });\n            this.$router.push(\"/msg\");\n        },\n        check: function () {\n            isExistPostInvitation(this.id).then((res) => {\n                this.record = res.data?.data;\n            });\n        },\n        accept: function () {\n            acceptPostInvitation(this.id).then((res) => {\n                this.$message({\n                    message: \"操作成功\",\n                    type: \"success\",\n                });\n                location.href = this.post_link;\n            });\n        },\n    },\n    filters: {\n        postLink: function (post) {\n            return getLink(post.post_type, post.ID);\n        },\n        authorLink,\n        showAvatar,\n        dateFormat: function (val) {\n            return dateFormat(new Date(~~val * 1000));\n        },\n    },\n    created: function () {},\n    mounted: function () {},\n};\n</script>\n\n<style scoped lang=\"less\">\n.m-invitation-creators {\n    padding: 100px 0;\n    max-width: 1280px;\n    .auto(x);\n    .u-title {\n        font-weight: 400;\n        i {\n            .fz(38px);\n            .y(-3px);\n        }\n        .x;\n        // color: @primary;\n    }\n    .u-desc {\n        .fz(24px);\n        .x;\n    }\n    .u-post {\n        display: flex;\n        border: 1px solid #ddd;\n        .r(6px);\n        max-width: 800px;\n        .auto(x);\n        background-color: @bg-light;\n    }\n    .u-post-avatar {\n        flex-shrink: 0;\n        img {\n            .size(68px);\n            padding: 10px;\n        }\n    }\n    .u-post-info {\n        padding: 10px;\n        flex-grow: 1;\n        overflow: hidden;\n    }\n    .u-post-title {\n        .fz(15px,2.5);\n        .db;\n        .bold;\n        &:hover {\n            text-decoration: underline;\n            color: @pink;\n        }\n        .nobreak;\n    }\n    .u-post-desc {\n        .fz(13px,2);\n        .db;\n        color: #555;\n        &:hover {\n            color: @pink;\n        }\n    }\n    .u-post-time {\n        .ml(10px);\n        color: #888 !important;\n    }\n    .u-btns {\n        .x;\n        .mt(20px);\n    }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_creators.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_creators.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./invitation_creators.vue?vue&type=template&id=62f4a8c0&scoped=true&\"\nimport script from \"./invitation_creators.vue?vue&type=script&lang=js&\"\nexport * from \"./invitation_creators.vue?vue&type=script&lang=js&\"\nimport style0 from \"./invitation_creators.vue?vue&type=style&index=0&id=62f4a8c0&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62f4a8c0\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./invitation_creators.vue?vue&type=style&index=0&id=62f4a8c0&scoped=true&lang=less&\"","/**\n * 简单的日期格式化\n *\n * @param {*} dt Date实例\n * @param {object} opt polished:是否补齐两位,separator:连接分隔符\n */\nfunction dateFormat(dt,separator='-',polished=true){\n    let year = dt.getFullYear()\n    let month = dt.getMonth() + 1\n    let date = dt.getDate()\n    let str = polished ? \n        `${year}${separator}${polish(month)}${separator}${polish(date)}` :\n        `${year}${separator}${month}${separator}${date}`\n    return str\n}\n\nfunction polish(val){\n    return val<10 ? ('0' + val) : val\n}\n\nexport default dateFormat\n"],"sourceRoot":""}