(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6637ad72"],{"02b8":function(t,e,n){"use strict";n("f680")},"13d5":function(t,e,n){"use strict";var a=n("23e7"),o=n("d58f").left,i=n("a640"),s=n("2d00"),r=n("605d"),c=!r&&s>79&&s<83,l=c||!i("reduce");a({target:"Array",proto:!0,forced:l},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},"1a2a":function(t,e,n){"use strict";var a=n("5530");function o(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if(a.isURLSearchParams(e))i=e.toString();else{var s=[];a.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(a.isArray(t)?e+="[]":t=[t],a.forEach(t,(function(t){a.isDate(t)?t=t.toISOString():a.isObject(t)&&(t=JSON.stringify(t)),s.push(o(e)+"="+o(t))})))})),i=s.join("&")}if(i){var r=t.indexOf("#");-1!==r&&(t=t.slice(0,r)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}},"23d5":function(t,e,n){"use strict";var a=n("81e3");t.exports=function(t,e,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?e(a("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},"25c3":function(t){t.exports=JSON.parse('["真不错，谢谢楼主#胜利#笨猪#胜利","辛苦了，感谢楼主的付出","谢谢楼主，很有用","剑三真好玩，魔盒真好用"]')},"26f2":function(t,e,n){"use strict";var a=n("6f6a"),o=n("d5ea");t.exports=function(t,e){return t&&!a(e)?o(t,e):e}},2705:function(t,e,n){t.exports=n.p+"img/up.bd872124.svg"},"2a5c":function(t,e,n){},"2ffb":function(t,e,n){},3766:function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),a=0;a<n.length;a++)n[a]=arguments[a];return t.apply(e,n)}}},"37c3":function(t){t.exports=JSON.parse('{"__Domain":"www.jx3box.com","__Origin":"origin.jx3box.com","__Root":"https://www.jx3box.com/","__OriginRoot":"https://origin.jx3box.com/","__Github":"https://github.jx3box.com/","__server":"https://server.jx3box.com/","__sso":"https://sso.jx3box.com/","__cms":"https://cms.jx3box.com/","__node":"https://node.jx3box.com/","__spider":"https://spider.jx3box.com/","__spider2":"https://spider2.jx3box.com/","__next":"https://next2.jx3box.com/","__pay":"https://pay.jx3box.com/","__team":"https://team.api.jx3box.com/","__lua":"https://lua.jx3box.com/","__down":"https://down.jx3box.com/","__dbm":"https://dbm.jx3box.com/","__helperUrl":"https://helper.jx3box.com/","__os":"https://os.jx3box.com/","__jx3":"https://xn--3-4g8a959k.com/","__cdn":"https://cdn.jx3box.com/","__ossRoot":"https://oss.jx3box.com/","__ossMirror":"https://cdn.jx3box.com/","__staticPath":{"origin":"https://oss.jx3box.com/static/","github":"https://jx3box.github.io/","jsdelivr":"https://cdn.jsdelivr.net/gh/JX3BOX/","mirror":"https://cdn.jx3box.com/static/"},"__dataPath":"https://data.jx3box.com/","__imgPath":"https://img.jx3box.com/","__iconPath":"https://icon.jx3box.com/","__clients":{"std":"重制","origin":"缘起","all":"双端"},"__postType":{"macro":"宏库","bps":"职业","pvp":"竞技","fb":"副本","tool":"工具","bbs":"茶馆","notice":"公告","jx3dat":"插件"},"__wikiType":{"achievement":"成就","item":"物品","knowledge":"通识","quest":"任务"},"__appType":{"face":"捏脸","pz":"配装","joke":"骚话","emotion":"表情","collection":"小册","item_plan":"清单","question":"题目","paper":"试卷","calendar":"日历","battle":"战斗"},"__gameType":{"pet":"宠物","adventure":"奇遇","furniture":"家具","horse":"坐骑","book":"书籍","exterior":"外观","reputation":"声望"},"__sourceType":{"cms_types":["macro","jx3dat","fb","bps","tool","bbs","notice","house","share","joke","emotion","feedback","collection","face"],"pvx_types":["pet","adventure","furniture","horse","book","exterior","reputation"],"wiki_types":["cj","achievement","item","item_plan","wiki","knowledge","quest"],"app_types":["pz","calendar","battle"],"exam_types":["question","paper"],"db_types":["skill","buff","npc","doodad"],"dbm_types":["vpk"],"team_types":["org","role","raid","apply"],"vip_types":["mall"]},"__visibleMap":{"0":"公开","1":"仅自己可见","2":"仅亲友可见","3":"密码可见","4":"付费可见","5":"粉丝可见"},"__userGroup":{"0":"游客","1":"待验证用户","8":"邮箱验证用户","16":"手机验证用户","32":"特约签约作者","64":"编辑","128":"管理员","256":"开发组","512":"超级管理"},"__userLevel":{"1":[0,600],"2":[600,900],"3":[900,1800],"4":[1800,3600],"5":[3600,7200],"6":[7200,999999]},"__userLevelColor":{"1":"#32d3c4","2":"#86c0fb","3":"#33d9ff","4":"#ffdb2a","5":"#ffa739","6":"#ff70b2","7":"#ff3399","8":"#f93c3c"},"__Links":{"account":{"login":"/account/login","register":"/account/register","email_verify":"/account/email_verify","login_callback":"/account/login_callback"},"dashboard":{"home":"/dashboard","msg":"/dashboard/msg","feed":"/dashboard/feed","fav":"/dashboard/fav","profile":"/dashboard/profile","connect":"/dashboard/connect","work":"/publish","publish":"/publish"}},"default_avatar":"https://cdn.jx3box.com/image/common/avatar.png","feedback":"https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=o8LHzsrN48nbkMHM243AzM4"}')},"3b94":function(t,e,n){"use strict";n("fc35")},"3c6a":function(t,e,n){},4437:function(t){t.exports=JSON.parse('{"e":{"1":"魔盒官网","2":"魔盒移动（小程序/APP）","3":"魔盒助手（客户端）","4":"剑三游戏客户端","5":"剑三游戏插件","6":"其它"},"d":{"1":"Bug异常","2":"建议","3":"举报","4":"其它"},"c":{"0":"待处理","1":"已指派","2":"已处理","3":"已结束"},"b":{"0":"#0366d6","1":"#fba524","2":"#49c10f","3":"#909399"},"a":{"status":[{"text":"待处理","value":0},{"text":"已指派","value":1},{"text":"已处理","value":2},{"text":"已结束","value":3}],"client":[{"text":"重制","value":"std"},{"text":"缘起","value":"origin"}]}}')},4596:function(t,e,n){"use strict";var a=n("5530");function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){a.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=o},5530:function(t,e,n){"use strict";var a=n("3766"),o=Object.prototype.toString;function i(t){return"[object Array]"===o.call(t)}function s(t){return"undefined"===typeof t}function r(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function c(t){return"[object ArrayBuffer]"===o.call(t)}function l(t){return"undefined"!==typeof FormData&&t instanceof FormData}function u(t){var e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function m(t){return"string"===typeof t}function p(t){return"number"===typeof t}function d(t){return null!==t&&"object"===typeof t}function f(t){if("[object Object]"!==o.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function h(t){return"[object Date]"===o.call(t)}function g(t){return"[object File]"===o.call(t)}function b(t){return"[object Blob]"===o.call(t)}function v(t){return"[object Function]"===o.call(t)}function _(t){return d(t)&&v(t.pipe)}function y(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams}function x(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function w(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function C(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),i(t))for(var n=0,a=t.length;n<a;n++)e.call(null,t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}function k(){var t={};function e(e,n){f(t[n])&&f(e)?t[n]=k(t[n],e):f(e)?t[n]=k({},e):i(e)?t[n]=e.slice():t[n]=e}for(var n=0,a=arguments.length;n<a;n++)C(arguments[n],e);return t}function L(t,e,n){return C(e,(function(e,o){t[o]=n&&"function"===typeof e?a(e,n):e})),t}function S(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}t.exports={isArray:i,isArrayBuffer:c,isBuffer:r,isFormData:l,isArrayBufferView:u,isString:m,isNumber:p,isObject:d,isPlainObject:f,isUndefined:s,isDate:h,isFile:g,isBlob:b,isFunction:v,isStream:_,isURLSearchParams:y,isStandardBrowserEnv:w,forEach:C,merge:k,extend:L,trim:x,stripBOM:S}},"592c":function(t,e,n){"use strict";var a=n("5530"),o=n("1a2a"),i=n("4596"),s=n("8ded"),r=n("d509");function c(t){this.defaults=t,this.interceptors={request:new i,response:new i}}c.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{},t.url=arguments[0]):t=t||{},t=r(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[s,void 0],n=Promise.resolve(t);this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));while(e.length)n=n.then(e.shift(),e.shift());return n},c.prototype.getUri=function(t){return t=r(this.defaults,t),o(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},a.forEach(["delete","get","head","options"],(function(t){c.prototype[t]=function(e,n){return this.request(r(n||{},{method:t,url:e}))}})),a.forEach(["post","put","patch"],(function(t){c.prototype[t]=function(e,n,a){return this.request(r(a||{},{method:t,url:e,data:n}))}})),t.exports=c},"64d4":function(t,e,n){"use strict";n("3c6a")},"66e6":function(t,e,n){t.exports=n.p+"img/github.b9f64033.svg"},"68b43":function(t,e,n){const{default_avatar:a,__sourceType:o,__postType:i,__wikiType:s,__appType:r,__gameType:c,__imgPath:l,__iconPath:u,__clients:m,__ossMirror:p}=n("37c3"),d=n("6d77"),f=n("1431");t.exports={resolveImagePath:function(t){return t&&t.length?(t=t.replace(/oss\.jx3box\.com/g,"cdn.jx3box.com"),t=t.replace(/http:/g,"https:"),t):""},checkImageLoad:function(t){t.length&&t.one("error",(function(){var t=$(this).attr("src"),e=t.replace(/cdn\.jx3box\.com/g,"oss.jx3box.com");$(this).attr("src",e)}))},showAvatar:function(t,e="s",n=!0){let o="";o=t?t.replace(/http:/g,"https:"):a;const i={s:"?x-oss-process=style/avatar_s",m:"?x-oss-process=style/avatar_m",l:"?x-oss-process=style/avatar_l"};if(i[e])o+=i[e];else{let t=`?x-oss-process=image/auto-orient,1/resize,m_fill,w_${e},h_${e}/quality,Q_100`;o+=t}return n&&(o=o.replace(/oss\.jx3box\.com/g,"cdn.jx3box.com")),o},showBanner:function(t,e="mini_banner",n=!0){return t?(t=t.replace(/http:/g,"https:"),n&&(t=t.replace(/oss\.jx3box\.com/g,"cdn.jx3box.com")),t+="?x-oss-process=style/"+e,t):""},getThumbnail:function(t,e=88,n=!0){return t?(t=t.replace(/http:/g,"https:"),n&&(t=t.replace(/oss\.jx3box\.com/g,"cdn.jx3box.com")),Array.isArray(e)?t+=`?x-oss-process=image/auto-orient,1/resize,m_fill,w_${e[0]},h_${e[1]}/quality,Q_100`:isNaN(e)?t+="?x-oss-process=style/"+e:t+=`?x-oss-process=image/auto-orient,1/resize,m_fill,w_${e},h_${e}/quality,Q_100`,t):""},iconLink(t,e="std"){if(!t||isNaN(parseInt(t))||-1==t)return l+"image/common/nullicon.png";{let n="origin"==e?"origin_icon":"icon";return`${u}${n}/${t}.png`}},getAppIcon(t,e=!1){return l+(e?"image/box-colorful/":"image/box/")+t+".svg"},editLink:function(t,e){return"/publish/#/"+t+"/"+e},publishLink:function(t){return"/publish/#/"+t},postLink:function(t,e){return"/"+t+"/"+e},getLink:function(t,e,n){if(e=e||"",o.cms_types.includes(t)||o.pvx_types.includes(t))return"/"+t+"/"+e;if(o.wiki_types.includes(t))return"item_plan"===t?"/item/plan_view/"+e:("achievement"===t&&(t="cj"),"wiki"===t&&(t="knowledge"),`/${t}/view/${e}`);if(o.app_types.includes(t))return`/${t}/view/${e}`;if(o.db_types.includes(t)){let a=`/app/database/?type=${t}&query=${e}`;return n&&(a+="&level="+n),a}if(o.dbm_types.includes(t))return`/dbm/${t}/${e}`;if(o.team_types.includes(t))return"/team/"+t+"/"+e;if("rank"==t){let t=e,a=n,o="";return o=e>6?`/jdt/${e}th/rank`:"/rank/race/#/"+t,a&&(o+="?aid="+a),o}return o.exam_types.includes(t)?"/exam/"+t+"/"+e:o.vip_types.includes(t)?"/vip/"+t+"/"+e:t&&e?"/"+t+"/"+e:"/"},authorLink:function(t){return"/author/"+t},tvLink:function(t,e){return d[t]+e},getRewrite:function(t){let e="",n=new URLSearchParams(location.search),a=!n.get(t);if(a){let t=location.pathname.slice(1).split("/");e=t[1]}else e=n.get(t);return e},getPID:function(){let t=new URLSearchParams(location.search),e=t.get("pid");return e&&!isNaN(e)?e:0},getAppID:function(){let t=location.pathname.slice(1).split("/");return t.length&&!isNaN(t[1])?t[1]:0},getAppType:function(){return location.pathname.slice(1).split("/")[0]},getQuery:function(t){let e=new URLSearchParams(location.search);return e.get(t)},getTypeLabel:function(t){let e=Object.assign({},i,s,r,c);return e[t]||"未知"},buildTarget:function(t=1025){return window.innerWidth<t?"_self":"_blank"},ts2str(t,e={polished:!0,separator:"-"}){let n=new Date(1e3*parseInt(t)),a=n.getFullYear(),o=n.getMonth()+1,i=n.getDate(),s=e.polished?`${a}${e.separator}${r(o)}${e.separator}${r(i)}`:`${a}${e.separator}${o}${e.separator}${i}`;return s;function r(t){return t<10?"0"+t:t}},jx3ClientType(){return location.hostname.includes("origin")?2:1},extractTextContent(t){if(!t||"string"!==typeof t)return[];let e=[];const n=t.replace(/<Text>(.*?)<\/text>/gimsy,"<span $1></span>");let a=f.load(`<div>${n}</div>`),o=a("span");if(!o.length)return[];for(let i of o)e.push(Object.assign({},i.attribs));return e},showSchoolIcon(t){return l+"image/school/"+t+".png"},showForceIcon(t){return l+"image/force/"+t+".png"},showMountIcon(t){return l+"image/xf/"+t+".png"},showClientLabel(t){return m[t]},getMedalLink(t,e){return`/rank/race/#/${t}/${e}`},convertUrlToProtocol(t){const e=/https?:\/\/([^/.]+)\.jx3box\.com\/(.*)/,n=t.match(e);if(n){const t=n[1],e=n[2],a=`${t}:/${e}`;return a}return t}}},"6ca6":function(t,e,n){"use strict";var a=n("5530");t.exports=a.isStandardBrowserEnv()?function(){return{write:function(t,e,n,o,i,s){var r=[];r.push(t+"="+encodeURIComponent(e)),a.isNumber(n)&&r.push("expires="+new Date(n).toGMTString()),a.isString(o)&&r.push("path="+o),a.isString(i)&&r.push("domain="+i),!0===s&&r.push("secure"),document.cookie=r.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"6d77":function(t){t.exports=JSON.parse('{"douyu":"https://www.douyu.com/","bilibili":"https://live.bilibili.com/","huya":"https://www.huya.com/"}')},"6f6a":function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},"703d":function(t,e,n){"use strict";n("2ffb")},"718e":function(t,e,n){"use strict";var a=n("5530");t.exports=function(t,e){a.forEach(t,(function(n,a){a!==e&&a.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[a])}))}},"7f06":function(t,e,n){"use strict";(function(e){var a=n("5530"),o=n("718e"),i={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!a.isUndefined(t)&&a.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function r(){var t;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e))&&(t=n("b293")),t}var c={adapter:r(),transformRequest:[function(t,e){return o(e,"Accept"),o(e,"Content-Type"),a.isFormData(t)||a.isArrayBuffer(t)||a.isBuffer(t)||a.isStream(t)||a.isFile(t)||a.isBlob(t)?t:a.isArrayBufferView(t)?t.buffer:a.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):a.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};a.forEach(["delete","get","head"],(function(t){c.headers[t]={}})),a.forEach(["post","put","patch"],(function(t){c.headers[t]=a.merge(i)})),t.exports=c}).call(this,n("4362"))},"819b":function(t,e,n){t.exports=n.p+"img/comment.2840ad61.svg"},"819f":function(t,e,n){"use strict";n("9150")},"81e3":function(t,e,n){"use strict";var a=n("9728");t.exports=function(t,e,n,o,i){var s=new Error(t);return a(s,e,n,o,i)}},8784:function(t,e,n){"use strict";n("fb28")},"8b41":function(t,e,n){"use strict";n("f12b")},"8ded":function(t,e,n){"use strict";var a=n("5530"),o=n("cfc9"),i=n("f448"),s=n("7f06");function r(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){r(t),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=a.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),a.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]}));var e=t.adapter||s.adapter;return e(t).then((function(e){return r(t),e.data=o(e.data,e.headers,t.transformResponse),e}),(function(e){return i(e)||(r(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},9150:function(t,e,n){},9728:function(t,e,n){"use strict";t.exports=function(t,e,n,a,o){return t.config=e,n&&(t.code=n),t.request=a,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},"9b31":function(t,e,n){"use strict";function a(t){this.message=t}a.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},a.prototype.__CANCEL__=!0,t.exports=a},a0c9:function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},a15b:function(t,e,n){"use strict";var a=n("23e7"),o=n("e330"),i=n("44ad"),s=n("fc6a"),r=n("a640"),c=o([].join),l=i!=Object,u=l||!r("join",",");a({target:"Array",proto:!0,forced:u},{join:function(t){return c(s(this),void 0===t?",":t)}})},a3d3:function(t,e,n){"use strict";var a=n("5530"),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,i,s={};return t?(a.forEach(t.split("\n"),(function(t){if(i=t.indexOf(":"),e=a.trim(t.substr(0,i)).toLowerCase(),n=a.trim(t.substr(i+1)),e){if(s[e]&&o.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},a50c:function(t,e,n){"use strict";n("2a5c")},a9fb0:function(t,e,n){"use strict";var a=n("5530");t.exports=a.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(t){var a=t;return e&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=o(window.location.href),function(e){var n=a.isString(e)?o(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},aa8d:function(t,e,n){t.exports=n.p+"img/uped.22abb620.svg"},aabf:function(t,e,n){"use strict";var a=n("5530"),o=n("3766"),i=n("592c"),s=n("d509"),r=n("7f06");function c(t){var e=new i(t),n=o(i.prototype.request,e);return a.extend(n,i.prototype,e),a.extend(n,e),n}var l=c(r);l.Axios=i,l.create=function(t){return c(s(l.defaults,t))},l.Cancel=n("9b31"),l.CancelToken=n("e403"),l.isCancel=n("f448"),l.all=function(t){return Promise.all(t)},l.spread=n("a0c9"),t.exports=l,t.exports.default=l},b293:function(t,e,n){"use strict";var a=n("5530"),o=n("23d5"),i=n("6ca6"),s=n("1a2a"),r=n("26f2"),c=n("a3d3"),l=n("a9fb0"),u=n("81e3");t.exports=function(t){return new Promise((function(e,n){var m=t.data,p=t.headers;a.isFormData(m)&&delete p["Content-Type"],(a.isBlob(m)||a.isFile(m))&&m.type&&delete p["Content-Type"];var d=new XMLHttpRequest;if(t.auth){var f=t.auth.username||"",h=unescape(encodeURIComponent(t.auth.password))||"";p.Authorization="Basic "+btoa(f+":"+h)}var g=r(t.baseURL,t.url);if(d.open(t.method.toUpperCase(),s(g,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var a="getAllResponseHeaders"in d?c(d.getAllResponseHeaders()):null,i=t.responseType&&"text"!==t.responseType?d.response:d.responseText,s={data:i,status:d.status,statusText:d.statusText,headers:a,config:t,request:d};o(e,n,s),d=null}},d.onabort=function(){d&&(n(u("Request aborted",t,"ECONNABORTED",d)),d=null)},d.onerror=function(){n(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(u(e,t,"ECONNABORTED",d)),d=null},a.isStandardBrowserEnv()){var b=(t.withCredentials||l(g))&&t.xsrfCookieName?i.read(t.xsrfCookieName):void 0;b&&(p[t.xsrfHeaderName]=b)}if("setRequestHeader"in d&&a.forEach(p,(function(t,e){"undefined"===typeof m&&"content-type"===e.toLowerCase()?delete p[e]:d.setRequestHeader(e,t)})),a.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),t.responseType)try{d.responseType=t.responseType}catch(v){if("json"!==t.responseType)throw v}"function"===typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){d&&(d.abort(),n(t),d=null)})),m||(m=null),d.send(m)}))}},b4fa:function(t,e,n){"use strict";n.d(e,"f",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"g",(function(){return l})),n.d(e,"e",(function(){return u}));var a=n("41cb");function o(t){return Object(a["d"])().post("/api/im-sure-leave-jx3box",{password:t})}function i(t){return Object(a["c"])().post("/api/miscfeedback",t)}function s(t){return Object(a["c"])().get("/api/miscfeedback",{params:t})}function r(t){return Object(a["c"])().get("/api/miscfeedback/my/list",{params:t})}function c(t){return Object(a["c"])().get("/api/miscfeedback/".concat(t))}function l(t,e){return Object(a["c"])().patch("/api/miscfeedback/".concat(t),e)}function u(){return Object(a["b"])().get("/api/cms/account/teammate").then((function(t){return t.data.data}))}},b8d3:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return t.data?e("div",{staticClass:"m-feed-single"},[e("main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-single-content"},[e("div",{staticClass:"m-type"},[e("span",{staticClass:"u-status",style:{backgroundColor:t.statusColors[t.data.status]}},[t._v(t._s(t.statusMap[t.data.status]))]),e("div",{staticClass:"u-type"},[e("span",{staticClass:"u-value"},[t._v(t._s(t.types[t.data.type]))]),e("span",{staticClass:"u-value"},[t._v(t._s(t.subtypes[t.data.subtype]))])]),t.isTeammate?e("el-button",{attrs:{size:"mini"},on:{click:t.showVisible}},[t._v("处理")]):t._e()],1),e("div",{staticClass:"m-block m-user"},[e("div",{staticClass:"u-subblock"},[e("span",{staticClass:"u-label"},[t._v("提交人：")]),e("a",{staticClass:"u-item u-user",attrs:{href:t.authorLink(t.data.user.id),target:"_blank"}},[e("img",{staticClass:"u-user-avatar",attrs:{src:t.showAvatar(t.data.user.avatar)}}),e("span",{staticClass:"u-user-name"},[t._v(t._s(t.data.user.display_name))])])]),e("span",{staticClass:"u-time u-subblock"},[t._v("提交时间："+t._s(t.formateTime(t.data.created_at)))])]),e("div",{staticClass:"m-block m-dev"},[e("div",{staticClass:"u-subblock"},[e("span",{staticClass:"u-label"},[t._v("分配至：")]),t.data.assign_user&&t.data.assign_user.length?e("div",{staticClass:"u-list u-list-assign"},t._l(t.data.assign_user,(function(n){return e("a",{key:n.id,staticClass:"u-item u-assign",attrs:{href:t.authorLink(n.id),target:"_blank"}},[e("img",{staticClass:"u-assign-avatar",attrs:{src:t.showAvatar(n.avatar)}}),e("span",{staticClass:"u-assign-name"},[t._v(t._s(n.display_name))])])})),0):e("div",{staticClass:"u-list u-list-assign"},[e("a",{staticClass:"u-item u-assign",attrs:{href:t.authorLink(1),target:"_blank"}},[e("img",{staticClass:"u-assign-avatar",attrs:{src:t.showAvatar("https://oss.jx3box.com/upload/avatar/2021/3/18/6568744.png")}}),e("span",{staticClass:"u-assign-name"},[t._v("JX3BOX")])])])]),e("div",{staticClass:"u-subblock"},[e("span",{staticClass:"u-label"},[t._v("关联仓库：")]),e("div",{staticClass:"u-list u-list-repo"},[t.data.repository?e("a",{staticClass:"u-repo u-item",attrs:{href:t.formateGithub(t.data.repository),target:"_blank"}},[e("img",{staticClass:"u-repo-icon",attrs:{src:n("66e6"),alt:""}}),e("span",{staticClass:"u-repo-name"},[t._v(t._s(t.data.repository))])]):e("div",{staticClass:"u-null"},[t._v("-")])])])]),t.data.refer?e("div",{staticClass:"m-block m-refer"},[e("div",{staticClass:"u-subblock"},[e("span",{staticClass:"u-label"},[t._v("来源：")]),e("a",{staticClass:"u-item u-user",attrs:{href:t.data.refer,target:"_blank"}},[t._v(" "+t._s(t.data.refer)+" ")])])]):t._e(),e("div",{staticClass:"m-content m-textarea"},[e("el-divider",{attrs:{"content-position":"left"}},[e("i",{staticClass:"el-icon-edit-outline"}),t._v(" 反馈内容")]),e("div",{staticClass:"u-detail"},[e("span",{domProps:{innerHTML:t._s(t.sanitizedHTML(t.data.content))}})])],1),e("div",{staticClass:"m-attachment m-textarea"},[e("el-divider",{attrs:{"content-position":"left"}},[e("i",{staticClass:"el-icon-picture-outline-round"}),t._v(" 附件截图")]),e("div",{staticClass:"u-detail"},t._l(t.data.images,(function(n,a){return e("div",{key:a,staticClass:"u-img"},[e("el-image",{attrs:{src:n,lazy:"","preview-src-list":t.data.images}})],1)})),0)],1),t.done?e("div",{staticClass:"m-reply"},[e("el-divider",{attrs:{"content-position":"left"}},[e("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 回复处理")]),e("Comment",{attrs:{id:t.id,category:"feedback",order:"desc"}})],1):t._e()]),e("el-dialog",{attrs:{visible:t.visible,title:"处理",width:"750px"},on:{"update:visible":function(e){t.visible=e}}},[e("el-form",{attrs:{model:t.formData,rules:t.rules,"label-position":"top"}},[e("el-form-item",{attrs:{label:"关联处理人"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择关联处理人",filterable:"",multiple:""},model:{value:t.formData.assign,callback:function(e){t.$set(t.formData,"assign",e)},expression:"formData.assign"}},t._l(t.teammates,(function(n){return e("el-option",{key:n.id,attrs:{label:n.teammate_info.display_name,value:n.user_id}},[e("div",{staticClass:"m-teammate"},[e("div",{staticClass:"m-user"},[e("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(n.teammate_info.user_avatar)}}),e("span",{staticClass:"u-name"},[t._v(t._s(n.teammate_info.display_name))]),e("span",{staticClass:"u-user-id"},[t._v("(ID: "+t._s(n.user_id)+")")])]),e("div",{staticClass:"m-duty"},[n.duty?e("span",{staticClass:"u-duty"},[t._v(t._s(t.formateDuty(n.duty))+" | ")]):t._e(),e("span",{staticClass:"u-remark"},[t._v(t._s(n.remark))])])])])})),1)],1),e("el-form-item",{attrs:{label:"仓库"}},[e("el-input",{attrs:{placeholder:"请输入仓库"},model:{value:t.formData.repository,callback:function(e){t.$set(t.formData,"repository",e)},expression:"formData.repository"}})],1),e("el-form-item",{attrs:{label:"状态"}},[e("el-radio-group",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[e("el-radio-button",{attrs:{label:0}},[t._v("待处理")]),e("el-radio-button",{attrs:{label:1}},[t._v("已指派")]),e("el-radio-button",{attrs:{label:2}},[t._v("已处理")]),e("el-radio-button",{attrs:{label:3}},[t._v("已结束")])],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)],1):t._e()},o=[],i=n("c7eb"),s=n("1da1"),r=(n("ac1f"),n("5319"),n("4de4"),n("d3b7"),n("caad"),n("13d5"),n("d81d"),n("c0c4")),c=n.n(r),l=n("b4fa"),u=n("8e44"),m=n("4437"),p=n("85e4"),d=n("c1df"),f=n.n(d),h=function(){var t=this,e=t._self._c;return e("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-comment"},[e("el-main",[e("CommentInputForm",{on:{submit:t.userSubmitInputForm}}),e("div",{staticClass:"c-comment-order"},[e("span",{staticClass:"u-label"},[t._v("排序模式：")]),e("el-radio-group",{attrs:{size:"mini"},on:{change:t.changeOrder},model:{value:t.isDesc,callback:function(e){t.isDesc=e},expression:"isDesc"}},[e("el-radio-button",{attrs:{label:"DESC"}},[t._v("最后靠前")]),e("el-radio-button",{attrs:{label:"ASC"}},[t._v("最早靠前")])],1),e("el-switch",{staticClass:"c-comment-order-likes",attrs:{"active-text":"点赞最多靠前"},on:{change:t.changeOrderByLikes},model:{value:t.orderByLikes,callback:function(e){t.orderByLikes=e},expression:"orderByLikes"}}),t.commentPower.is_author?e("el-switch",{staticClass:"c-comment-order-likes",attrs:{"active-text":"开启精选"},on:{change:t.changeWhiteList},model:{value:t.openWhiteList,callback:function(e){t.openWhiteList=e},expression:"openWhiteList"}}):t._e(),!t.commentPower.is_author&&t.openWhiteList?e("span",{staticClass:"c-comment-alert"},[e("i",{staticClass:"el-icon-info"}),t._v(" 本文章作者已开启评论精选 ")]):t._e()],1),t.isNormal?[t._l(t.commentList,(function(n){return e("div",{key:n.id,staticClass:"c-comment-list"},[e("CommentAvatar",{attrs:{"user-avatar":t._f("showAvatar")(n.avatar),"user-href":t._f("profileLink")(n.userId),username:n.displayName,avatarFrame:n.user_avatar_frame,withFrame:!0,avatarSize:48}}),e("CommentWithReply",{attrs:{"base-api":t.baseAPI,item:n,category:t.category,power:t.commentPower,"user-href":t._f("profileLink")(n.userId),username:n.displayName},on:{deleteComment:t.deleteComment,setTopComment:t.setTopComment,setStarComment:t.setStarComment,setWhiteComment:t.setWhiteComment,setLikeComment:t.setLikeComment}})],1)})),e("div",{staticClass:"c-comment-pages"},[t.commentList.length>5?e("CommentInputForm",{attrs:{isBottom:t.commentList.length>5},on:{submit:t.userSubmitInputForm}}):t._e(),e("div",{staticClass:"u-pages"},[e("el-pagination",{staticStyle:{"text-align":"right"},attrs:{background:"","hide-on-single-page":"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"prev, pager, next, total",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1)]:t._e()],2)],1)},g=[],b=(n("99af"),n("68b43")),v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-comment-avatar"},[e("a",{staticClass:"u-avatar",attrs:{href:t.userHref,target:"_blank"}},[e("el-avatar",{staticClass:"u-avatar-pic",attrs:{shape:"circle",size:t.avatarSize,src:t.userAvatar}}),t.avatarFrame?e("i",{staticClass:"u-avatar-frame",class:36==t.avatarSize?"xxs":"xs"},[e("img",{attrs:{src:t.frameUrl}})]):t._e()],1),e("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username))])],1)},_=[],y=n("37c3"),x={props:["avatarSize","userAvatar","userHref","username","avatarFrame","withFrame"],data:function(){return{}},computed:{frameUrl:function(){return y["__imgPath"]+"avatar/images/".concat(this.avatarFrame,"/").concat(this.avatarFrame,".svg")}},methods:{},mounted:function(){}},w=x,C=(n("3b94"),n("2877")),k=Object(C["a"])(w,v,_,!1,null,null,null),L=k.exports,S=function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"c-comment-box",attrs:{model:t.newComment}},[e("el-form-item",[e("el-input",{attrs:{rows:"3",type:"textarea",maxlength:t.maxLength,"show-word-limit":"",placeholder:"参与讨论...",id:t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}}),e("quickReply",{on:{reply:t.onQuickReply}})],1),t.showUploader?e("Uploader",{ref:"uploader",staticClass:"u-uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e(),e("div",{staticClass:"u-toolbar"},[e("el-button",{staticClass:"u-publish",attrs:{type:"primary",disabled:t.disableSubmitBtn},on:{click:t.onSubmit}},[t._v("发表评论")])],1)],1)],1)},j=[],R=(n("a15b"),function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{ref:"upload",attrs:{action:"https://cms.jx3box.com/api/cms/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:t.maxCount,accept:t.acceptedExtensions.reduce((function(t,e){return t+".".concat(e,",")}),""),multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[e("i",{staticClass:"el-icon-plus"}),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 最多上传 "+t._s(t.maxCount)+" 张 "+t._s(t.acceptedExtensions.join(" / ").toUpperCase())+" 格式图片，单张图片不能超过 "+t._s(t.maxSize/1024/1024)+" MB ")])]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)}),I=[],$={data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[],acceptedExtensions:["jpg","jpeg","png","gif"],maxCount:5,maxSize:2097152}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"最多上传 ".concat(this.maxCount," 张图片！"),type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,e){"ready"==t.status&&(t.size>this.maxSize?(this.$notify({title:"",message:"单张图片大小不能超过 ".concat(this.maxSize/1024/1024," MB！"),type:"error",duration:3e3,position:"bottom-right"}),e.pop()):this.fileList=e)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data),this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[])},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]}}},O=$,P=Object(C["a"])(O,R,I,!1,null,null,null),T=P.exports,U=n("c840"),A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-jx3box-reply"},[e("el-popover",{ref:"quickReply",attrs:{"visible-arrow":!0,placement:"top",trigger:"click","popper-class":"c-jx3box-reply-pop"}},[e("div",{staticClass:"c-jx3box-reply-pop__content"},[e("i",{staticClass:"el-icon-close u-close",on:{click:t.closePop}}),e("div",{staticClass:"u-title"},[t._v("快捷回复")]),e("div",{staticClass:"m-reply-list"},t._l(t.replyTemplate,(function(n,a){return e("div",{key:a,staticClass:"m-reply-list__item",on:{click:function(e){return t.reply(n)}}},[t._v(" "+t._s(n)+" ")])})),0)]),e("img",{staticClass:"u-reference",attrs:{slot:"reference",width:"24",height:"24",src:n("819b"),alt:"comment"},slot:"reference"})])],1)},E=[],F=n("25c3"),D={name:"QuickReply",data:function(){return{replyTemplate:F}},emits:["reply"],methods:{closePop:function(){this.$refs.quickReply&&this.$refs.quickReply.doClose()},reply:function(t){this.$emit("reply",t),this.closePop()}}},N=D,B=(n("819f"),Object(C["a"])(N,A,E,!1,null,null,null)),z=B.exports,q={name:"CommentInputForm",components:{Uploader:T,Emotion:U["a"],quickReply:z},props:{isBottom:{type:Boolean,default:!1}},mounted:function(){this.isBottom&&(this.inputId="textarea-bottom")},data:function(){return{maxLength:500,showUploader:!1,disableSubmitBtn:!1,newComment:{content:""},inputId:"textarea-top"}},methods:{onSubmit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},onQuickReply:function(t){this.$emit("submit",{content:t,attachmentList:[],is_template:1})},attachmentUploadFinish:function(t){this.$emit("submit",{content:this.newComment.content,attachmentList:t}),this.newComment={content:""},this.showUploader=!1,this.disableSubmitBtn=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){this.insertVariable(t)},insertVariable:function(t){var e=this;return Object(s["a"])(Object(i["a"])().mark((function n(){var a,o,s,r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=document.querySelector("#".concat(e.inputId)),o=t.key,!a.selectionStart&&0!==a.selectionStart){n.next=12;break}return s=a.selectionStart,r=a.selectionEnd,e.newComment.content=a.value.substring(0,s)+o+a.value.substring(r,a.value.length),n.next=8,e.$nextTick();case 8:a.focus(),a.setSelectionRange(r+o.length,r+o.length),n.next=13;break;case 12:e.newComment.content=o;case 13:case"end":return n.stop()}}),n)})))()}}},H=q,M=Object(C["a"])(H,S,j,!1,null,null,null),W=M.exports,J=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-comment-cmt"},[e("div",[e("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username||"人字榜800线无名小侠"))]),t.item.is_top?e("span",{staticClass:"u-mark u-top"},[e("i",{staticClass:"el-icon-download"}),t._v("置顶")]):t._e(),t.item.is_star?e("span",{staticClass:"u-mark u-star"},[e("i",{staticClass:"el-icon-star-off"}),t._v("精华")]):t._e()],1),e("CommentContent",{attrs:{date:t.item.commentDate,content:t.item.content,"comment-id":t.item.id,attachments:t._f("stringToArray")(t.item.attachments),"can-delete":t.power.allow||t.power.uid==t.item.userId,"can-set-top":t.power.is_author&&!t.item.is_top,"can-cancel-top":t.power.is_author&&t.item.is_top,"can-set-star":!t.item.is_star&&t.power.group>=64,"can-cancel-star":t.item.is_star&&t.power.group>=64,"can-add-white":!t.item.is_white&&1==t.power.is_white,"can-remove-white":t.item.is_white&&1==t.power.is_author,"is-like":1==t.item.is_likes,likes:~~t.item.likes},on:{addNewReply:t.addNewReply,deleteComment:t.deleteComment,setTopComment:t.setTopComment,setStarComment:t.setStarComment,setLikeComment:t.setLikeComment,setWhiteComment:t.setWhiteComment}}),e("ReplyList",{attrs:{data:t.replyList,pager:t.pager,power:t.power},on:{addNewReply:t.addNewReply,deleteReply:t.deleteReply,goto:t.gotoReplyListIndex,resetReply:t.resetReply,setLikeComment:t.setLikeReply}})],1)},V=[],X=function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-cmt"},[""!=t.content?e("div",{staticClass:"u-text",domProps:{innerHTML:t._s(t.formatContent(t.content))}}):t._e(),t.attachments.length?e("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(n){return e("el-image",{key:n,attrs:{src:t._f("showAttachment")(n),"preview-src-list":[t.showPreview(n)],lazy:""}})})),1):t._e(),e("div",{staticClass:"u-toolbar"},[t.currentUserHadLike?t._e():e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!0)}}},[e("img",{staticClass:"u-up",attrs:{src:n("2705"),alt:""}}),t._v("点赞"+t._s(t.likesFormat(t.hasLikeCount)))]),t.currentUserHadLike?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!1)}}},[e("img",{staticClass:"u-up",attrs:{src:n("aa8d"),alt:""}}),t._v("已赞"+t._s(t.likesFormat(t.hasLikeCount)))]):t._e(),e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-chat-round"},on:{click:function(e){t.showForm=!t.showForm}}},[t._v("回复")]),t.canDelete?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),t.canSetTop?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-top",size:"mini"},on:{click:function(e){return t.topComment(!0)}}},[t._v("置顶")]):t._e(),t.canCancelTop?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-top",size:"mini"},on:{click:function(e){return t.topComment(!1)}}},[t._v("取消置顶")]):t._e(),t.canSetStar?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-off",size:"mini"},on:{click:function(e){return t.starComment(!0)}}},[t._v("加精")]):t._e(),t.canCancelStar?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-on",size:"mini"},on:{click:function(e){return t.starComment(!1)}}},[t._v("取消加精")]):t._e(),t.canAddWhite?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-off",size:"mini"},on:{click:function(e){return t.setWhiteComment(!0)}}},[t._v("精选")]):t._e(),t.canRemoveWhite?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-on",size:"mini"},on:{click:function(e){return t.setWhiteComment(!1)}}},[t._v("取消精选")]):t._e(),e("time",{staticClass:"u-date"},[e("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1),t.showForm?e("el-form",{ref:"form",staticClass:"c-comment-subbox",attrs:{model:t.newComment}},[e("el-form-item",[e("el-input",{attrs:{type:"textarea",placeholder:"参与评论...",id:"id"+t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}})],1),e("el-form-item",[e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}})],1),t.showUploader?e("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submit()}}},[t._v("提交")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.showForm=!1}}},[t._v("收起")])],1)],1):t._e()],1)},Q=[],Y=n("506c");function G(t){return t.replace(/[<>"']/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;"}}))}function K(t){const e=new Y["a"](G(t));return e.code}function Z(t){return t>9?t:"0".concat(t)}var tt={props:["content","date","hasReply","canDelete","canSetTop","canCancelTop","isLike","likes","canSetStar","canCancelStar","attachments","commentId","canAddWhite","canRemoveWhite"],components:{Uploader:T,Emotion:U["a"]},data:function(){return{newComment:{content:""},showForm:!1,disableSubmitBtn:!1,showUploader:!1,inputId:"",previewList:[],currentUserHadLike:this.isLike,hasLikeCount:this.likes}},mounted:function(){this.commentId&&(this.inputId=this.commentId)},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(b["resolveImagePath"])(t)}))}},methods:{doLike:function(t){t!==this.currentUserHadLike&&(this.currentUserHadLike=t,this.hasLikeCount=t?this.hasLikeCount+1:this.hasLikeCount-1,this.$emit("setLikeComment",t))},topComment:function(t){this.$emit("setTopComment",t)},starComment:function(t){this.$emit("setStarComment",t)},setWhiteComment:function(t){this.$emit("setWhiteComment",t)},deleteComment:function(){var t=this;this.$confirm("确定删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("deleteComment")})).catch((function(){}))},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+Z(e.getMonth()+1)+"-"+Z(e.getDate())+" "+Z(e.getHours())+":"+Z(e.getMinutes())+":"+Z(e.getSeconds())},likesFormat:function(t){return t>0?t:""},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("addNewReply",{content:this.newComment.content,attachmentList:t}),this.showUploader=!1,this.newComment={content:""}},attachmentUplodError:function(){this.disableSubmitBtn=!1},submit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){},formatContent:K,handleEmotionSelected:function(t){var e=this;return Object(s["a"])(Object(i["a"])().mark((function n(){var a,o,s,r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=document.querySelector("#id".concat(e.inputId)),o=t.key,!a.selectionStart&&0!==a.selectionStart){n.next=12;break}return s=a.selectionStart,r=a.selectionEnd,e.newComment.content=a.value.substring(0,s)+o+a.value.substring(r,a.value.length),n.next=8,e.$nextTick();case 8:a.focus(),a.setSelectionRange(r+o.length,r+o.length),n.next=13;break;case 12:e.newComment.content=o;case 13:case"end":return n.stop()}}),n)})))()},showPreview:function(t){return Object(b["resolveImagePath"])(t)}},filters:{showAttachment:function(t){return Object(b["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}}},et=tt,nt=(n("64d4"),Object(C["a"])(et,X,Q,!1,null,null,null)),at=nt.exports,ot=function(){var t=this,e=t._self._c;return t.data.length?e("div",{staticClass:"c-comment-replylist"},[t._l(t.data,(function(n){return e("reply-item",{key:n.id,staticClass:"c-comment-reply",attrs:{reply:n,power:t.power},on:{deleteReply:t.deleteReply,addReply:t.addReply,setLikeComment:t.setLikeComment}})})),t.data.length>=3||t.showPager?e("el-row",[e("el-col",{attrs:{span:4}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showLess()}}},[t._v("收起")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.showPager,expression:"!showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showMore()}}},[t._v("查看更多")])],1),e("el-col",{staticClass:"c-comment-reply-pages",attrs:{span:20}},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{small:"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"total, prev, pager, next",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1):t._e()],2):t._e()},it=[],st=function(){var t=this,e=t._self._c;return e("el-row",[e("CommentAvatar",{attrs:{"user-avatar":t._f("showAvatar")(t.reply.avatar),"user-href":t._f("profileLink")(t.reply.userId),username:t.reply.displayName,avatarFrame:t.reply.user_avatar_frame,avatarSize:36}}),e("CommentContentSimple",{attrs:{"comment-id":t.reply.id,date:t.reply.commentDate,content:t.reply.content,attachments:t._f("stringToArray")(t.reply.attachments),"can-delete":t.power.allow||t.power.uid==t.reply.userId,"can-reply":t.power.uid!=t.reply.userId,"user-href":t._f("profileLink")(t.reply.replyForUID),"reply-for-username":t.reply.replyForUsername,"reply-for-user-id":t.reply.replyForUID,"is-like":1==t.reply.is_likes,likes:~~t.reply.likes},on:{delete:t.deleteReply,showReplyInput:function(e){t.showReplyForReplyFrom=!t.showReplyForReplyFrom},setLikeComment:t.setLikeComment}}),t.showReplyForReplyFrom?e("ReplyForReply",{attrs:{username:t.reply.displayName,"user-href":t._f("profileLink")(t.reply.userId),"current-id":t.reply.id},on:{hideForm:function(e){t.showReplyForReplyFrom=!1},doReply:t.doReply}}):t._e()],1)},rt=[],ct=function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-reply"},[e("div",{staticClass:"u-reply-content"},[0!=t.replyForUserId?e("span",{staticClass:"u-reply-label"},[t._v(" 回复 "),e("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("@"+t._s(t.replyForUsername))]),t._v(" : ")],1):t._e(),e("div",{staticClass:"u-reply-text",domProps:{innerHTML:t._s(t.formatContent(t.content))}})]),t.attachments.length?e("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(n){return e("el-image",{key:n,attrs:{src:t._f("showAttachment")(n),"preview-src-list":[t.showPreview(n)],lazy:""}})})),1):t._e(),e("div",{staticClass:"u-toolbar"},[t.currentUserHadLike?t._e():e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!0)}}},[e("img",{staticClass:"u-up",attrs:{src:n("2705"),alt:""}}),t._v("点赞"+t._s(t.likesFormat(t.hasLikeCount)))]),t.currentUserHadLike?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!1)}}},[e("img",{staticClass:"u-up",attrs:{src:n("aa8d"),alt:""}}),t._v("已赞"+t._s(t.likesFormat(t.hasLikeCount)))]):t._e(),t.canReply?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-chat-line-round",size:"mini"},on:{click:function(e){return t.showReplyForReplyInput()}}},[t._v("回复")]):t._e(),t.canDelete?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),e("time",{staticClass:"u-date"},[e("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1)])},lt=[];function ut(t){return t>9?t:"0".concat(t)}var mt={props:["commentId","content","attachments","date","hasReply","canDelete","canReply","isLike","likes","userHref","replyForUsername","replyForUserId"],data:function(){return{showInput:!1,currentUserHadLike:this.isLike,hasLikeCount:this.likes}},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(b["resolveImagePath"])(t)}))}},filters:{profileLink:function(t){return Object(b["authorLink"])(t)},showAttachment:function(t){return Object(b["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}},methods:{formatContent:K,getPList:function(t){return t.split("\n")},doLike:function(t){t!==this.currentUserHadLike&&(this.currentUserHadLike=t,this.hasLikeCount=t?this.hasLikeCount+1:this.hasLikeCount-1,this.$emit("setLikeComment",t))},deleteComment:function(){var t=this;this.$confirm("确定删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("delete",t.commentId)})).catch((function(){}))},likesFormat:function(t){return t>0?t:""},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+ut(e.getMonth()+1)+"-"+ut(e.getDate())+" "+ut(e.getHours())+":"+ut(e.getMinutes())+":"+ut(e.getSeconds())},showReplyForReplyInput:function(){this.$emit("showReplyInput")},previewImg:function(t){this.$hevueImgPreview({multiple:!0,nowImgIndex:t,imgList:this._attachments,controlBar:!1,clickMaskCLose:!0})},showPreview:function(t){return Object(b["resolveImagePath"])(t)}}},pt=mt,dt=(n("02b8"),Object(C["a"])(pt,ct,lt,!1,null,null,null)),ft=dt.exports,ht=function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"c-comment-subbox"},[e("div",{staticClass:"u-subbox-label"},[t._v(" 回复 "),e("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("＠"+t._s(t.username))]),t._v(" ： ")],1),e("el-form-item",[e("el-input",{attrs:{type:"textarea",id:"id"+t.inputId,placeholder:"输入回复..."},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),e("el-form-item",[e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}})],1),t.showUploader?e("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submintReply()}}},[t._v("提交")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.hideForm()}}},[t._v("收起")])],1)],1)},gt=[],bt={props:["username","userHref","currentId"],data:function(){return{content:"",showUploader:!1,disableSubmitBtn:!1,inputId:""}},components:{Uploader:T,Emotion:U["a"]},mounted:function(){this.currentId&&(this.inputId=this.currentId)},methods:{submintReply:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){this.$emit("hideForm")},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("doReply",{content:this.content,attachmentList:t}),this.content="",this.showUploader=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){var e=this;return Object(s["a"])(Object(i["a"])().mark((function n(){var a,o,s,r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=document.querySelector("#id".concat(e.inputId)),o=t.key,!a.selectionStart&&0!==a.selectionStart){n.next=12;break}return s=a.selectionStart,r=a.selectionEnd,e.content=a.value.substring(0,s)+o+a.value.substring(r,a.value.length),n.next=8,e.$nextTick();case 8:a.focus(),a.setSelectionRange(r+o.length,r+o.length),n.next=13;break;case 12:e.content=o;case 13:case"end":return n.stop()}}),n)})))()}}},vt=bt,_t=(n("703d"),Object(C["a"])(vt,ht,gt,!1,null,null,null)),yt=_t.exports,xt={props:["reply","power"],components:{CommentAvatar:L,CommentContentSimple:ft,ReplyForReply:yt},backReplyList:[],data:function(){return{showReplyForReplyFrom:!1}},filters:{profileLink:function(t){return Object(b["authorLink"])(t)},stringToArray:function(t){return t?JSON.parse(t):[]},showAvatar:function(t){return Object(b["showAvatar"])(t,84)}},methods:{deleteReply:function(t){this.$emit("deleteReply",t)},setLikeComment:function(t){this.$emit("setLikeComment",this.reply.id,t)},doReply:function(t){t.replyForUID=this.reply.userId,t.replyForCommentId=this.reply.id,this.$emit("addReply",t),this.showReplyForReplyFrom=!1}}},wt=xt,Ct=Object(C["a"])(wt,st,rt,!1,null,null,null),kt=Ct.exports,Lt={props:["data","power","pager"],components:{ReplyItem:kt},data:function(){return{showPager:!1}},filters:{profileLink:function(t){return Object(b["authorLink"])(t)}},methods:{showMore:function(){this.showPager=!0,this.$emit("goto",1)},showLess:function(){this.showPager=!1,this.$emit("resetReply")},handleCurrentChange:function(t){this.$emit("goto",t)},deleteReply:function(t){this.$emit("deleteReply",t)},setLikeComment:function(t,e){this.$emit("setLikeComment",t,e)},addReply:function(t){this.$emit("addNewReply",t)}}},St=Lt,jt=(n("a50c"),Object(C["a"])(St,ot,it,!1,null,null,null)),Rt=jt.exports,It=n("5c96");const $t=function(t,e){let n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};return At(t,e,n)};var Ot={};const Pt=function(t,e,n){if(Ot[t])if(Date.now()-Ot[t].lastest<6e4){if(Ot[t].count>=6)return It["Notification"].warning({title:"系统",message:"你单身多久了? 动作这么快, 系统处理不过来 ( T_T )",duration:3e3,position:"bottom-right"}),new Promise((t,e)=>{e()});Ot[t].count=Ot[t].count+1}else Date.now()-Ot[t].lastest>6e4&&(Ot[t]={lastest:Date.now(),count:0});else Ot[t]={lastest:Date.now(),count:0};let a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return At(t,e,a)},Tt=function(t,e,n){let a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return At(t,e,a)},Ut=function(t,e){let n={method:"DELETE"};return At(t,e,n)};function At(t,e,n){let a=y["__next"];if("/"==a[a.length-1]&&(a=a.substring(0,a.length-1)),t=a+t,t=t.replace("/api/","/api/next2/"),n.credentials="include",e){let n=[];Object.keys(e).forEach(t=>{n.push(t+"="+e[t])});let a=y["__next"];"/"==a[a.length-1]&&(a=a.substring(0,a.length-1)),t=t+"?"+n.join("&")}return fetch(t,n).then(t=>{switch(t.status){case 200:break;case 401:throw window.location.href=y["__Links"].account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 403:throw window.location.href=y["__Links"].account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 423:throw window.location.href=y["__Links"].account.email_verify+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 406:throw t.text().then(t=>{It["Notification"].warning({title:"系统",message:t||"提交内容不合法,请重新提交",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText);default:throw t.text().then(e=>{It["Notification"].error({title:"系统:"+t.statusText,message:e||"系统错误,请稍后重试!",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText)}let e=t.headers.get("Content-Type");switch(e=e&&e.split(";").shift(),e){case"application/json":return t.json().then(t=>t&&t.code>0&&""!=t.msg?(It["Notification"].warning({title:"提示",message:t.code+":"+t.msg,duration:3e3,position:"bottom-right"}),null):t);default:return t.text()}})}var Et={props:["item","baseApi","power","user-href","username"],components:{CommentContent:at,ReplyList:Rt},data:function(){return{replyList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0}}},filters:{stringToArray:function(t){return t?JSON.parse(t):[]}},created:function(){this.replyList=this.item.reply||[]},methods:{deleteComment:function(){this.$emit("deleteComment",this.item.id)},setTopComment:function(t){this.$emit("setTopComment",this.item.id,t)},setStarComment:function(t){this.$emit("setStarComment",this.item.id,t)},setLikeComment:function(t){this.$emit("setLikeComment",this.item.id,t)},setLikeReply:function(t,e){this.$emit("setLikeComment",t,e)},setWhiteComment:function(t){this.$emit("setWhiteComment",this.item.id,t)},addNewReply:function(t){var e=this;Pt("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},deleteReply:function(t){var e=this;Ut("".concat(this.baseApi,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},gotoReplyListIndex:function(t){this.loadReplyList(t,6)},loadReplyList:function(t,e){var n=this;$t("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply/page/").concat(t,"?pageSize=").concat(e)).then((function(a){1==t&&3==e&&(n.item.reply=a.data||[]),n.replyList=a.data||[],n.pager=a.page})).catch((function(){}))},resetReply:function(){this.loadReplyList(1,3)}}},Ft=Et,Dt=(n("c00b"),Object(C["a"])(Ft,J,V,!1,null,null,null)),Nt=Dt.exports,Bt=n("c97f"),zt=n.n(Bt),qt=n("2b0e");qt["default"].prototype.$notify=It["Notification"],qt["default"].prototype.$message=It["Message"],qt["default"].prototype.$alert=It["MessageBox"].alert;const Ht=new qt["default"];function Mt(t,e="message"){switch(e){case"message":Ht.$message.error(t);break;case"alert":Ht.$alert(t,"错误",{confirmButtonText:"确定"});break;case"notify":Ht.$notify.error({title:"错误",message:t});break;default:break}}function Wt(t){return console.log(t.response),Promise.reject(t)}function Jt(t,e){let n=e&&e.popType||"message";t["interceptors"]["response"].use((function(t){return t.data.code?(e&&e.mute||t.data.msg&&Mt(`[${t.data.code}]${t.data.msg}`,n),Promise.reject(t)):t}),(function(t){return e&&e.mute||Mt(`[${t.response.data.statusCode}]${t.response.data.message}`,n),Wt(t)}))}var Vt=n("f5d2");y["__server"],y["__cms"],y["__node"],y["__spider"],y["__pay"],y["__team"],y["__helperUrl"];function Xt(t){let e=t&&t.domain||y["__cms"],n={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"cms common request"},baseURL:e,headers:{}};const a=zt.a.create(n);return Jt(a,t),a}function Qt(t){return console.log(t.response),Promise.reject(t)}function Yt(t,e){t["interceptors"]["response"].use((function(t){return t.data.code?Promise.reject(t):t}),(function(t){return Qt(t)}))}function Gt(t,e){t["interceptors"]["response"].use((function(t){return t.data.code?Promise.reject(t):t}),(function(t){return Qt(t)}))}function Kt(t){let e=t&&t.domain||y.__cms,n={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"cms common request"},baseURL:e,headers:{}};const a=zt.a.create(n);return Gt(a,t),a}function Zt(t){let e=t&&t.domain||y.__next,n={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"next common request"},baseURL:e,headers:{}};const a=zt.a.create(n);return Yt(a,t),a}function te(t){let e=t&&Object.assign(t,{domain:y.__pay})||{domain:y.__pay};return Zt(e)}let{__Links:ee,default_avatar:ne,__server:ae,__userLevel:oe}=y,{tokenExpires:ie}=Vt;class se{constructor(){this.expires=ie,this.created_at=0,this.logged_in=!1,this.profile={},this.anonymous={uid:0,group:0,name:"未登录",status:0,bind_wx:0,avatar:Object(b["showAvatar"])(null,"s"),avatar_origin:ne},this.asset=""}check(){return this.isLogin()?(this.profile.uid=localStorage&&localStorage.getItem("uid"),this.profile.group=localStorage&&localStorage.getItem("group")||1,this.profile.token=localStorage&&localStorage.getItem("token"),this.profile.name=localStorage&&localStorage.getItem("name"),this.profile.status=localStorage&&localStorage.getItem("status"),this.profile.bind_wx=localStorage&&localStorage.getItem("bind_wx"),this.profile.avatar_origin=localStorage&&localStorage.getItem("avatar")||ne,this.profile.avatar=Object(b["showAvatar"])(this.profile.avatar_origin,"s")):this.profile=this.anonymous,this}refresh(t,e){return localStorage.setItem(t,e)}isLogin(){return this.created_at=localStorage.getItem("created_at")?localStorage.getItem("created_at"):-1/0,this.logged_in="true"==localStorage.getItem("logged_in"),this.logged_in&&Date.now()-this.created_at<this.expires}_save(t){localStorage.setItem("created_at",Date.now()),localStorage.setItem("logged_in",!0),localStorage.setItem("token",t.token),localStorage.setItem("uid",t.uid),localStorage.setItem("group",t.group),localStorage.setItem("name",t.name),localStorage.setItem("status",t.status),localStorage.setItem("bind_wx",t.bind_wx),localStorage.setItem("avatar",t.avatar)}update(t){return new Promise((e,n)=>{try{this._save(t),e(this)}catch(a){localStorage?(localStorage.clear(),this._save(t),e(value)):n(new Error("localStorage不可用"))}})}getInfo(){return this.check(),this.profile}destroy(){return Kt({domain:ae}).post("/account/logout").finally(()=>{localStorage.removeItem("created_at"),localStorage.setItem("logged_in","false"),localStorage.removeItem("token")})}toLogin(t){t=t?encodeURIComponent(t):encodeURIComponent(location.href),location.href=ee.account.login+"?redirect="+t}getToken(){return this.getInfo().token}getUUID(){return localStorage.getItem("device_id")}isEmailMember(){return this.getInfo().group>=8}isPhoneMember(){return this.getInfo().group>=16}isEditor(){return this.getInfo().group>=64}isAdmin(){return this.getInfo().group>=128}isDeveloper(){return this.getInfo().group>=256}isSuperAdmin(){return this.getInfo().group>=512}isSuperAuthor(){return this.isLogin()?Kt().get("/api/cms/user/is_super_author/"+this.getInfo().uid).then(t=>t.data.data):new Promise((t,e)=>{t(!1)})}hasBindwx(){return this.getInfo().bind_wx}_isVIP(t){let e=t.was_vip;if(e){let e=new Date(t.expire_date)-new Date>0;return e}return!1}_isPRO(t){let e=t.was_pro;if(e){let e=new Date(t.pro_expire_date)-new Date>0;return e}return!1}isVIP(){return this.asset?new Promise((t,e)=>{t(this._isPRO(this.asset)||this._isVIP(this.asset))}):this.getAsset().then(t=>this._isPRO(t)||this._isVIP(t))}isPRO(){return this.asset?new Promise((t,e)=>{t(this._isPRO(this.asset))}):this.getAsset().then(t=>this._isPRO(t))}getAsset(){return this.isLogin()?te().get("/api/vip/i").then(t=>{let e=t.data.data;return this.asset=e,e}):new Promise((t,e)=>{let n={was_vip:0,expire_date:"1970-02-02T16:00:00.000Z",total_day:0,was_pro:0,pro_expire_date:"1970-02-02T16:00:00.000Z",pro_total_day:0,rename_card_count:0,had_renamed:0,namespace_card_count:0,box_coin:0,points:0};this.asset=n,t(n)})}getLevel(t){for(let e in oe){let n=oe[e];if(t>=n[0]&&t<n[1])return~~e}}}var re=new se;const ce="cmt_order";async function le(){return re.isLogin()?Xt({mute:!0}).get("/api/cms/user/conf",{params:{key:ce}}).then(t=>t.data.data):new Promise(t=>{const e=localStorage.getItem(ce)||"DESC";t(e)})}async function ue(t){return re.isLogin()?Xt().put("/api/cms/user/conf",{val:t},{params:{key:ce}}).then(t=>t.data.data):new Promise(e=>{e(localStorage.setItem(ce,t))})}var me={name:"Comment",props:["id","category","normal","order"],components:{CommentAvatar:L,CommentWithReply:Nt,CommentInputForm:W},data:function(){return{baseAPI:"",commentPower:{allow:!1,uid:-1},commentList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0},isDesc:"DESC",orderByLikes:!1,openWhiteList:!1,loading:!1}},computed:{isNormal:function(){return void 0===this.normal||this.normal}},methods:{changeOrder:function(){this.reloadCommentList(this.pager.index),ue("ASC"===this.isDesc?"DESC":"ASC")},changeOrderByLikes:function(){this.reloadCommentList(this.pager.index)},changeWhiteList:function(){var t=this;Tt("".concat(this.baseAPI,"/meta/white-list/").concat(this.openWhiteList?"open":"close")).then((function(){t.commentPower.is_white=t.openWhiteList,t.reloadCommentList(t.pager.index)})).catch((function(){}))},setLikeComment:function(t,e){var n=e?"like":"unlike";Tt("".concat(this.baseAPI,"/comment/").concat(t,"/").concat(n)).then((function(){})).catch((function(){}))},setTopComment:function(t,e){var n=this,a=e?"set":"cancel";Tt("".concat(this.baseAPI,"/comment/").concat(t,"/top/").concat(a)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},setStarComment:function(t,e){var n=this,a=e?"set":"cancel";Tt("".concat(this.baseAPI,"/comment/").concat(t,"/star/").concat(a)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},setWhiteComment:function(t,e){var n=this,a=e?"add":"remove";Tt("".concat(this.baseAPI,"/comment/").concat(t,"/white-list/").concat(a)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},deleteComment:function(t){var e=this;Ut("".concat(this.baseAPI,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.reloadCommentList(e.pager.index)})).catch((function(){}))},reloadCommentList:function(t){var e=this;this.loading=!0;var n={};"DESC"===this.isDesc&&(n["desc"]=!0),n["orderby_likes"]=this.orderByLikes,$t("".concat(this.baseAPI,"/comment/page/").concat(t),n).then((function(t){e.commentList=t.data||[],e.pager=t.page})).catch((function(){})).finally((function(){e.loading=!1}))},handleCurrentChange:function(t){this.reloadCommentList(t)},userSubmitInputForm:function(t){var e=this;Pt("".concat(this.baseAPI,"/comment"),null,t).then((function(t){t&&~~t.code>0?e.$notify({title:"评论失败",message:t.msg||"",type:"error",duration:3e3,position:"bottom-right"}):(e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),1==e.pager.index&&e.reloadCommentList(e.pager.index))})).catch((function(){}))}},filters:{profileLink:function(t){return Object(b["authorLink"])(t)},showAvatar:function(t){return Object(b["showAvatar"])(t,144)}},created:function(){this.baseAPI="/api/comment/".concat(this.category,"/article/").concat(this.id)},mounted:function(){var t=this;le().then((function(e){t.isDesc=e})).then((function(){$t("".concat(t.baseAPI,"/i-am-author")).then((function(e){t.commentPower=e,t.openWhiteList=e.is_white})).catch((function(){}))})).finally((function(){t.reloadCommentList(1)}))}},pe=me,de=(n("8b41"),Object(C["a"])(pe,h,g,!1,null,null,null)),fe=de.exports,he={name:"FeedbackSingle",components:{Comment:fe},data:function(){return{data:"",loading:!1,types:m["e"],subtypes:m["d"],statusMap:m["c"],statusColors:m["b"],done:!1,visible:!1,formData:{assign:[],repository:"",status:0},rules:{},teammates:[]}},computed:{id:function(){return this.$route.params.id},isTeammate:function(){return this.$store.state.isTeammate}},watch:{id:{immediate:!0,handler:function(t){t&&this.getData()}}},mounted:function(){this.loadTeammates()},methods:{getData:function(){var t=this;return Object(s["a"])(Object(i["a"])().mark((function e(){var n,a,o,s,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(l["b"])(t.id);case 4:r=e.sent,t.data=r.data.data,t.data.content=t.data.content.replace(/\n/g,"<br>"),t.formData.repository=(null===(n=t.data)||void 0===n?void 0:n.repository)||"",t.formData.assign=(null===(a=t.data)||void 0===a||null===(o=a.assign)||void 0===o?void 0:o.filter((function(t){return t})))||[],t.formData.status=(null===(s=t.data)||void 0===s?void 0:s.status)||0,t.done=!0,e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),console.log(e.t0);case 16:return e.prev=16,t.loading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})))()},loadTeammates:function(){var t=this;return Object(s["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u["c"])();case 3:n=e.sent,t.teammates=n.data.data.filter((function(t){return t.group&&["mp","developer","designer"].includes(t.group)})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},back:function(){this.$router.go(-1)},authorLink:p["authorLink"],showAvatar:p["showAvatar"],formateTime:function(t){return f()(t).format("YYYY-MM-DD HH:mm:ss")},formateGithub:function(t){return"https://github.com/JX3BOX/".concat(t)},formateDuty:function(t){return t&&t.reduce((function(t,e){return t+" | "+e}))||""},confirm:function(){var t=this;Object(l["g"])(this.id,{assign:this.formData.assign.map((function(t){return t})),repository:this.formData.repository,status:this.formData.status}).then((function(e){t.$message.success("处理成功"),t.visible=!1,t.getData()})).catch((function(e){t.$message.error(e.message)}))},showVisible:function(){var t,e;this.formData.repository=this.data.repository,this.formData.assign=(null===(t=this.data)||void 0===t||null===(e=t.assign)||void 0===e?void 0:e.filter((function(t){return t})))||[],this.visible=!0},sanitizedHTML:function(t){return c.a.sanitize(t)}}},ge=he,be=(n("8784"),Object(C["a"])(ge,a,o,!1,null,null,null));e["default"]=be.exports},c00b:function(t,e,n){"use strict";n("e3b7")},c97f:function(t,e,n){t.exports=n("aabf")},cfc9:function(t,e,n){"use strict";var a=n("5530");t.exports=function(t,e,n){return a.forEach(n,(function(n){t=n(t,e)})),t}},d509:function(t,e,n){"use strict";var a=n("5530");t.exports=function(t,e){e=e||{};var n={},o=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],r=["validateStatus"];function c(t,e){return a.isPlainObject(t)&&a.isPlainObject(e)?a.merge(t,e):a.isPlainObject(e)?a.merge({},e):a.isArray(e)?e.slice():e}function l(o){a.isUndefined(e[o])?a.isUndefined(t[o])||(n[o]=c(void 0,t[o])):n[o]=c(t[o],e[o])}a.forEach(o,(function(t){a.isUndefined(e[t])||(n[t]=c(void 0,e[t]))})),a.forEach(i,l),a.forEach(s,(function(o){a.isUndefined(e[o])?a.isUndefined(t[o])||(n[o]=c(void 0,t[o])):n[o]=c(void 0,e[o])})),a.forEach(r,(function(a){a in e?n[a]=c(t[a],e[a]):a in t&&(n[a]=c(void 0,t[a]))}));var u=o.concat(i).concat(s).concat(r),m=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===u.indexOf(t)}));return a.forEach(m,l),n}},d58f:function(t,e,n){var a=n("59ed"),o=n("7b0b"),i=n("44ad"),s=n("07fa"),r=TypeError,c=function(t){return function(e,n,c,l){a(n);var u=o(e),m=i(u),p=s(u),d=t?p-1:0,f=t?-1:1;if(c<2)while(1){if(d in m){l=m[d],d+=f;break}if(d+=f,t?d<0:p<=d)throw r("Reduce of empty array with no initial value")}for(;t?d>=0:p>d;d+=f)d in m&&(l=n(l,m[d],d,u));return l}};t.exports={left:c(!1),right:c(!0)}},d5ea:function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},e3b7:function(t,e,n){},e403:function(t,e,n){"use strict";var a=n("9b31");function o(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new a(t),e(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t,e=new o((function(e){t=e}));return{token:e,cancel:t}},t.exports=o},f12b:function(t,e,n){},f448:function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},f5d2:function(t){t.exports=JSON.parse('{"accept":"image/jpeg,image/gif,image/png,image/bmp,text/plain,text/csv,text/jx3dat,text/dat,application/pdf,application/zip,application/rar,application/x-7z-compressed,application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/octet-stream,text/blueprint,text/blueprintx","ext":["jpg","gif","png","bmp","txt","csv","jx3dat","dat","pdf","zip","rar","7z","doc","docx","xls","xlsx","ttf","blueprint","blueprintx"],"sizeLimit":5242880,"tokenExpires":2592000000}')},f680:function(t,e,n){},fb28:function(t,e,n){},fc35:function(t,e,n){}}]);
//# sourceMappingURL=chunk-6637ad72.a60b68e1.js.map