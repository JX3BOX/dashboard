{"version":3,"sources":["webpack:///./src/utils/filters.js","webpack:///./src/service/role.js","webpack:///./src/components/role/roleform.vue?3a08","webpack:///./src/components/role/roleform.vue","webpack:///src/components/role/roleform.vue","webpack:///./src/components/role/roleform.vue?941c","webpack:///./src/components/role/roleform.vue?2b9e","webpack:///./src/views/role/EditRole.vue","webpack:///src/views/role/EditRole.vue","webpack:///./src/views/role/EditRole.vue?2b91","webpack:///./src/views/role/EditRole.vue?5b8f"],"names":["showBodyType","val","_bodyMap$val","bodyMap","label","showSchoolIcon","id","__imgPath","showSchoolName","school_id_map","getRoles","params","$team","get","unbindRole","getToken","noteRole","role_id","note","put","concat","createRole","data","post","updateRole","getRole","deleteRole","delete","starRole","unstarRole","getRoleBelongTeams","render","_vm","this","_c","_self","staticClass","ref","attrs","form","position","model","value","name","callback","$$v","$set","expression","on","setDefaultServer","server","_l","servers","key","mount","school_map","_f","_v","_s","body_type","body_map","building","submit","btn_txt","staticRenderFns","props","window","innerWidth","processing","prop","event","watch","newval","deep","handler","$emit","computed","methods","$alert","confirmButtonText","localStorage","setItem","filters","mounted","components","component","goBack","slot","ID","custom","uid","$route","loadData","_this","then","res","hasRight","User","getInfo","isSuperAdmin","$message","error","_this2","message","type","$router","push","finally","roleform"],"mappings":"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","file":"js/chunk-58efe3e4.54579687.js","sourcesContent":["import { bodyMap } from \"@jx3box/jx3box-facedat/assets/data/index.json\";\nfunction showBodyType(val) {\n    return bodyMap[val]?.label || \"未知\";\n}\n\nimport school_id_map from \"@jx3box/jx3box-data/data/xf/schoolid.json\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nfunction showSchoolIcon(val) {\n    let id = val || 0;\n    return __imgPath + \"image/school/\" + id + \".png\";\n}\n\nfunction showSchoolName(val) {\n    let id = val || 0;\n    return (id && school_id_map[id]) || \"未知\";\n}\n\nimport { showTime } from \"@jx3box/jx3box-common/js/moment.js\";\nimport { getThumbnail, authorLink, showAvatar } from \"@jx3box/jx3box-common/js/utils\";\n\nexport {\n    showBodyType,\n    showSchoolIcon,\n    showSchoolName,\n    showTime,\n    getThumbnail,\n    authorLink,\n    showAvatar\n};\n","import { $team} from '@jx3box/jx3box-common/js/https';\n\nfunction getRoles(params) {\n    return $team().get(\"/api/team/my-game-roles\", {\n        params: params,\n    });\n}\n\nfunction unbindRole(id) {\n    return $team().get(\"/api/team/role-unbind/\" + id);\n}\n\nfunction getToken() {\n    return $team().get(\"/api/team/role-bind-token\");\n}\n\nfunction noteRole(role_id, note) {\n    return $team().put(`/api/team/role-update-note/${role_id}`, {\n        note: note,\n    });\n}\n\nfunction createRole(data) {\n    return $team().post(\"/api/team/custom-role\", data);\n}\n\nfunction updateRole(role_id, data) {\n    return $team().put(`/api/team/custom-role/${role_id}`, data);\n}\n\nfunction getRole(role_id) {\n    return $team().get(`/api/team/custom-role/${role_id}`);\n}\n\nfunction deleteRole(role_id) {\n    return $team().delete(`/api/team/custom-role/${role_id}`);\n}\n\nfunction starRole(role_id){\n    return $team().put(`/api/team/role-priority/${role_id}/top`)\n}\nfunction unstarRole(role_id){\n    return $team().put(`/api/team/role-priority/${role_id}/untop`)\n}\n\nfunction getRoleBelongTeams(role_id) {\n    return $team().get(`/api/team/relation/role/${role_id}/teams`);\n}\n\nexport {\n    getRoles,\n    unbindRole,\n    getToken,\n    noteRole,\n    createRole,\n    updateRole,\n    getRole,\n    deleteRole,\n    starRole,\n    unstarRole,\n    getRoleBelongTeams,\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./roleform.vue?vue&type=style&index=0&id=d4df263e&prod&lang=less\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-role-form\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\",\"label-position\":_vm.position}},[_c('el-form-item',{attrs:{\"label\":\"角色名\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入角色名称\",\"show-word-limit\":\"\",\"minlength\":2,\"maxlength\":20},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"服务器\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择服务器\",\"filterable\":\"\"},on:{\"change\":_vm.setDefaultServer},model:{value:(_vm.form.server),callback:function ($$v) {_vm.$set(_vm.form, \"server\", $$v)},expression:\"form.server\"}},_vm._l((_vm.servers),function(server){return _c('el-option',{key:server,attrs:{\"label\":server,\"value\":server}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"门派\"}},[_c('el-radio-group',{attrs:{\"size\":\"medium\"},model:{value:(_vm.form.mount),callback:function ($$v) {_vm.$set(_vm.form, \"mount\", $$v)},expression:\"form.mount\"}},_vm._l((_vm.school_map),function(label,key){return _c('el-radio',{key:key,attrs:{\"label\":key,\"border\":\"\"}},[_c('img',{staticClass:\"u-icon-school\",attrs:{\"src\":_vm._f(\"showSchoolIcon\")(key)}}),_vm._v(\" \"+_vm._s(label)+\" \")])}),1)],1),_c('el-form-item',{attrs:{\"label\":\"体型\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择体型\"},model:{value:(_vm.form.body_type),callback:function ($$v) {_vm.$set(_vm.form, \"body_type\", $$v)},expression:\"form.body_type\"}},_vm._l((_vm.body_map),function(label,key){return _c('el-option',{key:key,attrs:{\"label\":label.label,\"value\":key}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"备注\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入备注信息\",\"show-word-limit\":\"\",\"minlength\":2,\"maxlength\":20},model:{value:(_vm.form.note),callback:function ($$v) {_vm.$set(_vm.form, \"note\", $$v)},expression:\"form.note\"}})],1),_c('el-form-item',[_c('el-button',{staticClass:\"u-btn\",attrs:{\"type\":\"primary\",\"disabled\":_vm.building},on:{\"click\":_vm.submit}},[_vm._v(_vm._s(_vm.btn_txt))])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-role-form\">\n        <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" :label-position=\"position\">\n            <el-form-item label=\"角色名\">\n                <el-input\n                    v-model=\"form.name\"\n                    placeholder=\"请输入角色名称\"\n                    show-word-limit\n                    :minlength=\"2\"\n                    :maxlength=\"20\"\n                ></el-input>\n            </el-form-item>\n            <el-form-item label=\"服务器\">\n                <el-select\n                    v-model=\"form.server\"\n                    placeholder=\"请选择服务器\"\n                    filterable\n                    @change=\"setDefaultServer\"\n                >\n                    <el-option\n                        v-for=\"server in servers\"\n                        :key=\"server\"\n                        :label=\"server\"\n                        :value=\"server\"\n                    ></el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label=\"门派\">\n                <el-radio-group v-model=\"form.mount\" size=\"medium\">\n                    <el-radio :label=\"key\" v-for=\"(label, key) in school_map\" :key=\"key\" border>\n                        <img class=\"u-icon-school\" :src=\"key | showSchoolIcon\" />\n                        {{ label }}\n                    </el-radio>\n                </el-radio-group>\n            </el-form-item>\n            <el-form-item label=\"体型\">\n                <el-select v-model=\"form.body_type\" placeholder=\"请选择体型\">\n                    <el-option\n                        v-for=\"(label, key) in body_map\"\n                        :key=\"key\"\n                        :label=\"label.label\"\n                        :value=\"key\"\n                    ></el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label=\"备注\">\n                <el-input\n                    v-model=\"form.note\"\n                    placeholder=\"请输入备注信息\"\n                    show-word-limit\n                    :minlength=\"2\"\n                    :maxlength=\"20\"\n                ></el-input>\n            </el-form-item>\n            <el-form-item>\n                <el-button\n                    class=\"u-btn\"\n                    type=\"primary\"\n                    @click=\"submit\"\n                    :disabled=\"building\"\n                >{{ btn_txt }}</el-button>\n            </el-form-item>\n        </el-form>\n    </div>\n</template>\n\n<script>\nimport servers from \"@jx3box/jx3box-data/data/server/server_list.json\";\nimport school_map from \"@jx3box/jx3box-data/data/xf/schoolid.json\";\nimport { bodyMap  } from \"@jx3box/jx3box-facedat/assets/data/index.json\";\nimport { showSchoolIcon } from \"@/utils/filters\"\nexport default {\n    props: [\"data\", \"btn_txt\", \"processing\"],\n    data: function () {\n        return {\n            position: window.innerWidth < 768 ? \"top\" : \"left\",\n            form: this.data || {\n                name: \"\",\n                server: \"\",\n                mount: \"0\",\n                body_type: \"1\",\n                note: \"\",\n            },\n            building: this.processing || false,\n\n            servers,\n            body_map : bodyMap,\n            school_map,\n        };\n    },\n    model: {\n        prop: \"data\",\n        event: \"update\",\n    },\n    watch: {\n        data: function (newval) {\n            this.form = newval;\n        },\n        form: {\n            deep: true,\n            handler: function (newval) {\n                this.$emit(\"update\", newval);\n            },\n        },\n        processing: function (val) {\n            this.building = val;\n        },\n    },\n    computed: {},\n    methods: {\n        submit: function () {\n            if (!this.form.name) {\n                this.$alert(\"角色名不能为空\", \"提醒\", {\n                    confirmButtonText: \"确定\",\n                });\n                return;\n            }\n\n            this.$emit(\"submit\");\n        },\n        setDefaultServer: function (val) {\n            // 下次新建角色时无需再选择服务器\n            localStorage &&\n                localStorage.setItem(\"team_role_default_server\", val);\n        },\n    },\n    filters: {\n        showSchoolIcon\n    },\n    mounted: function () {},\n    components: {},\n};\n</script>\n\n<style lang=\"less\">\n@import \"../../assets/css/role/roleform.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./roleform.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./roleform.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./roleform.vue?vue&type=template&id=d4df263e\"\nimport script from \"./roleform.vue?vue&type=script&lang=js\"\nexport * from \"./roleform.vue?vue&type=script&lang=js\"\nimport style0 from \"./roleform.vue?vue&type=style&index=0&id=d4df263e&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"v-role-add\"},[_c('h2',{staticClass:\"u-title\"},[_c('i',{staticClass:\"el-icon-setting\"}),_vm._v(\" 编辑角色 \"),_c('el-button',{staticClass:\"u-back\",attrs:{\"slot\":\"reference\",\"size\":\"mini\",\"plain\":\"\",\"icon\":\"el-icon-arrow-left\"},on:{\"click\":_vm.goBack},slot:\"reference\"},[_vm._v(\"返回\")])],1),_c('roleform',{attrs:{\"data\":_vm.form,\"btn_txt\":\"更新\",\"processing\":_vm.processing},on:{\"submit\":_vm.submit}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"v-role-add\">\n        <h2 class=\"u-title\">\n            <i class=\"el-icon-setting\"></i> 编辑角色\n            <el-button\n                slot=\"reference\"\n                class=\"u-back\"\n                size=\"mini\"\n                plain\n                icon=\"el-icon-arrow-left\"\n                @click=\"goBack\"\n            >返回</el-button>\n        </h2>\n        <roleform :data=\"form\" @submit=\"submit\" btn_txt=\"更新\" :processing=\"processing\" />\n    </div>\n</template>\n\n<script>\nimport roleform from \"@/components/role/roleform.vue\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { getRole, updateRole } from \"@/service/role.js\";\nexport default {\n    name: \"\",\n    props: [],\n    data: function () {\n        return {\n            form: {\n                ID: \"\",\n                name: \"\",\n                server: \"\",\n                mount: \"\",\n                body_type: \"\",\n                note: \"\",\n                custom: 1,\n                uid: \"\",\n            },\n            processing: false,\n        };\n    },\n    computed: {\n        id: function () {\n            return ~~this.$route.params.id;\n        },\n    },\n    methods: {\n        loadData: function () {\n            getRole(this.id).then((res) => {\n                let hasRight =\n                    res.data.data.uid == User.getInfo().uid ||\n                    User.isSuperAdmin();\n                if (!hasRight) {\n                    this.$message.error(\"没有操作权限\");\n                    return;\n                } else {\n                    this.form = res.data.data;\n                }\n            });\n        },\n        submit: function () {\n            // 如果是绑定的角色不能改\n            if (!this.form.custom) {\n                this.$message.error(\"绑定角色不允许篡改\");\n                return;\n            }\n            this.processing = true;\n            updateRole(this.id, this.form)\n                .then((res) => {\n                    this.$message({\n                        message: \"更新成功\",\n                        type: \"success\",\n                    });\n                    this.$router.push(\"/role\");\n                })\n                .finally(() => {\n                    this.processing = false;\n                });\n        },\n        goBack : function (){\n            this.$router.push('/role')\n            // this.$router.go(-1)\n        }\n    },\n    mounted: function () {\n        this.loadData();\n    },\n    components: {\n        roleform,\n    },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./EditRole.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./EditRole.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EditRole.vue?vue&type=template&id=60cb96e9\"\nimport script from \"./EditRole.vue?vue&type=script&lang=js\"\nexport * from \"./EditRole.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}