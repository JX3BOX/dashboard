{"version":3,"sources":["webpack:///./src/service/profile.js","webpack:///./src/views/frame.vue","webpack:///src/views/frame.vue","webpack:///./src/views/frame.vue?4b23","webpack:///./src/views/frame.vue?ba97","webpack:///./src/service/decoration.js","webpack:///./src/views/frame.vue?4519"],"names":["getProfile","$cms","get","updateProfile","data","put","updateAvatar","uploadAvatar","post","getFrames","url","__imgPath","axios","getUserOverview","uid","concat","params","__no_cache","updatePassword","checkEmailAvailable","email","sendBindEmail","sendVerifyEmail","code","app","checkOAuth","unbindOAuth","type","popType","delete","getWechatQrcode","unbindWechat","render","_vm","this","_c","_self","staticClass","attrs","tabList","scopedSlots","_u","key","fn","_v","proxy","showAvatar","avatar","frame","frameUrl","_e","_l","frameList","item","i","slot","_s","desc","postscript","class","setClass","on","$event","setAvatar","name","updateAvatarFrame","reset","staticRenderFns","props","themeTab","User","getInfo","framebak","framesBak","avatar_origin","frames","avatars","decoration","computed","methods","dataProcessing","val","receive","isHave","using","_this","user_avatar_frame","then","res","$message","message","map","setDecoration","receiveFrame","_this2","loadDecoration","list","find","e","load","_this3","_this4","getDecoration","typeArr","arr","filter","indexOf","formattingData","group_key","forEach","push","decorationAather","_this$decoration$key","length","_this5","firstRes","twoRes","threeRes","Object","keys","_objectSpread","mounted","components","uc","component","getDecorationJson","Date","now","getEmotion","__dataPath","user_id","getHonor","getUserHonors","$next","mute","setHonor","honor_id","cancelHonor","getUserMedals","getMedals"],"mappings":"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","file":"js/chunk-58f746f2.ac2a0855.js","sourcesContent":["import { $cms, $_https } from \"@jx3box/jx3box-common/js/https.js\";\n\nimport axios from \"axios\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\n// 1.资料\n// -------------------------------\nfunction getProfile() {\n    return $cms().get(\"/api/cms/user/my/profile\");\n}\nfunction updateProfile(data) {\n    return $cms().put(\"/api/cms/user/my/profile\", data);\n}\n\n// 2.头像\n// -------------------------------\nfunction updateAvatar(data) {\n    return $cms().put(\"/api/cms/user/my/avatar\", data);\n}\nfunction uploadAvatar(data) {\n    return $cms().post(\"/api/cms/upload/avatar\", data);\n}\nfunction getFrames() {\n    // let url = process.env.NODE_ENV == 'development'?'/temp/user_avatar_frame.json':(__imgPath + \"avatar/index.json\")\n    let url = __imgPath + \"avatar/index.json\";\n    return axios.get(url);\n}\nfunction getUserOverview(uid) {\n    return $cms().get(`/api/cms/user/${uid}/info`, {\n        params: {\n            __no_cache: 1,\n        },\n    });\n}\n\n// 3.密码\n// -------------------------------\n// 发送验证码\nfunction sendVerifyCode(data) {\n    return $cms().post(\"/api/cms/user/account/email/forgot-password\", data, {\n        app: \"jx3box\",\n    });\n}\n// 重设密码\nfunction updatePassword(data) {\n    return $cms().put(\"/api/cms/user/my/password\", data);\n}\n\n// 4.邮箱\n// -------------------------------\nfunction checkEmailAvailable(email) {\n    return $cms().get(\"/api/cms/user/account/email/valid\", {\n        params: {\n            email\n        }\n    });\n}\n\nfunction sendBindEmail(data) {\n    return $cms().post(\"/api/cms/user/account/email/bind\", data);\n}\n\nfunction sendVerifyEmail(code) {\n    return $cms().put(\"/api/cms/user/account/email/verify\", {\n        code,\n    }, { app: 'jx3box' });\n}\n\n// 5.互联\nfunction checkOAuth() {\n    return $cms().get(\"/api/cms/account/oauth/status\");\n}\n\nfunction unbindOAuth(type) {\n    return $cms({\n        popType: \"alert\",\n    }).delete(`/api/cms/account/oauth/unbind/${type}`);\n}\n\n// 6.微信\n// 获取微信二维码\nfunction getWechatQrcode() {\n    return $cms().get(`/api/cms/wechat/mp/bind`);\n}\n\n// 解除绑定\nfunction unbindWechat() {\n    return $cms().get(`/api/cms/wechat/mp/unbind`);\n}\n\nexport {\n    updateProfile,\n    getProfile,\n    updateAvatar,\n    updatePassword,\n    sendVerifyEmail,\n    checkEmailAvailable,\n    sendBindEmail,\n    unbindOAuth,\n    checkOAuth,\n    uploadAvatar,\n    getFrames,\n    getUserOverview,\n    getWechatQrcode,\n    unbindWechat,\n    sendVerifyCode\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('uc',{staticClass:\"m-dashboard-frame m-dashboard-skin\",attrs:{\"icon\":\"el-icon-brush\",\"title\":\"主题装扮\",\"tab-list\":_vm.tabList},scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('a',{staticClass:\"u-link el-button el-button--default el-button--mini is-round is-plain\",attrs:{\"href\":\"/vip/mall?category=virtual\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-shopping-cart-2\"}),_vm._v(\" 前往获取装扮\")])]},proxy:true}])},[_c('div',{staticClass:\"m-frame\"},[_c('div',{staticClass:\"m-frame-left\"},[_c('a',{staticClass:\"u-btn el-button el-button--default el-button--mini is-plain\",attrs:{\"href\":\"/dashboard/avatar\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-picture-outline-round\"}),_vm._v(\" 修改头像\")]),_c('div',{staticClass:\"u-avatar-box\"},[_c('div',{staticClass:\"u-avatar\"},[_c('img',{staticClass:\"u-avatar-pic\",attrs:{\"src\":_vm.showAvatar(_vm.avatar)}}),(_vm.frame)?_c('i',{staticClass:\"u-avatar-frame\"},[_c('img',{attrs:{\"src\":_vm.frameUrl(_vm.frame)}})]):_vm._e()])])]),_c('div',{staticClass:\"m-frame-right\"},[_c('div',{staticClass:\"u-theme\"},[_c('div',{staticClass:\"u-frame-list\"},[_c('div',{staticClass:\"u-title\"},[_c('span',{staticClass:\"u-name\"},[_c('i',{staticClass:\"el-icon-collection-tag\"}),_vm._v(\"头像框\")]),_c('a',{staticClass:\"u-buy\",attrs:{\"href\":`/vip/mall?category=virtual&sub_category=avatar`,\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-shopping-cart-2\"}),_vm._v(\" 前往获取\")])]),_c('div',{staticClass:\"u-frame-item\"},_vm._l((_vm.frameList),function(item,i){return _c('div',{key:i,staticClass:\"u-picbox\"},[_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"placement\":\"top\",\"open-delay\":200}},[_c('div',{attrs:{\"slot\":\"content\"},slot:\"content\"},[_vm._v(_vm._s(item.desc)),_c('br'),_vm._v(_vm._s(item.postscript))]),_c('div',{staticClass:\"u-pic\",class:_vm.setClass(item),on:{\"click\":function($event){return _vm.setAvatar(item)}}},[(item.name)?_c('el-image',{attrs:{\"src\":_vm.frameUrl(item.name),\"fit\":\"contain\"}}):_c('div',{staticClass:\"u-noFrame\"})],1)])],1)}),0)])])])]),_c('div',{staticClass:\"m-btn\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.updateAvatarFrame}},[_vm._v(\"确认\")]),_c('el-button',{on:{\"click\":_vm.reset}},[_vm._v(\"清除所有装扮\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <uc class=\"m-dashboard-frame m-dashboard-skin\" icon=\"el-icon-brush\" title=\"主题装扮\" :tab-list=\"tabList\">\n        <template #header>\n            <a\n                class=\"u-link el-button el-button--default el-button--mini is-round is-plain\"\n                href=\"/vip/mall?category=virtual\"\n                target=\"_blank\"\n                ><i class=\"el-icon-shopping-cart-2\"></i> 前往获取装扮</a\n            >\n        </template>\n        <div class=\"m-frame\">\n            <!-- 左右两侧 -->\n            <div class=\"m-frame-left\">\n                <a\n                    class=\"u-btn el-button el-button--default el-button--mini is-plain\"\n                    href=\"/dashboard/avatar\"\n                    target=\"_blank\"\n                    ><i class=\"el-icon-picture-outline-round\"></i> 修改头像</a\n                >\n                <div class=\"u-avatar-box\">\n                    <div class=\"u-avatar\">\n                        <img :src=\"showAvatar(avatar)\" class=\"u-avatar-pic\" />\n                        <i class=\"u-avatar-frame\" v-if=\"frame\">\n                            <img :src=\"frameUrl(frame)\" />\n                        </i>\n                    </div>\n                </div>\n            </div>\n            <div class=\"m-frame-right\">\n                <!-- <div class=\"u-no-theme\" :class=\"decorationActivate==null?'select':''\" @click=\"noSet\">不设置主题</div> -->\n                <!-- 主题渲染列表 -->\n                <div class=\"u-theme\">\n                    <div class=\"u-frame-list\">\n                        <div class=\"u-title\">\n                            <span class=\"u-name\"><i class=\"el-icon-collection-tag\"></i>头像框</span>\n                            <a class=\"u-buy\" :href=\"`/vip/mall?category=virtual&sub_category=avatar`\" target=\"_blank\"\n                                ><i class=\"el-icon-shopping-cart-2\"></i> 前往获取</a\n                            >\n                        </div>\n                        <div class=\"u-frame-item\">\n                            <div class=\"u-picbox\" v-for=\"(item, i) in frameList\" :key=\"i\">\n                                <el-tooltip effect=\"dark\" placement=\"top\" :open-delay=\"200\">\n                                    <div slot=\"content\">{{ item.desc }}<br />{{ item.postscript }}</div>\n                                    <div class=\"u-pic\" :class=\"setClass(item)\" @click=\"setAvatar(item)\">\n                                        <el-image :src=\"frameUrl(item.name)\" fit=\"contain\" v-if=\"item.name\" />\n                                        <div v-else class=\"u-noFrame\"></div>\n                                    </div>\n                                </el-tooltip>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"m-btn\">\n            <el-button type=\"primary\" @click=\"updateAvatarFrame\">确认</el-button>\n            <el-button @click=\"reset\">清除所有装扮</el-button>\n        </div>\n    </uc>\n</template>\n\n<script>\nimport uc from \"@/components/uc.vue\";\nimport { themeTab } from \"@/assets/data/tabs.json\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { showAvatar } from \"@jx3box/jx3box-common/js/utils\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport { getFrames, getUserOverview } from \"@/service/profile\";\nimport { updateAvatarFrame, getDecoration, receive, setDecoration } from \"@/service/decoration\";\nexport default {\n    name: \"frame\",\n    props: [],\n    data: function () {\n        return {\n            tabList: themeTab,\n            uid: User.getInfo().uid,\n            frameList: [],\n            //头像框备份\n            framebak: \"\",\n            framesBak: {},\n            // 数据\n            avatar: User.getInfo().avatar_origin,\n            frame: null,\n            frames: {}, //远程json\n            avatars: [], //头像筛选\n            decoration: null, //装扮筛选用于判断是否符合领取条件\n        };\n    },\n    computed: {},\n    methods: {\n        reset() {\n            this.frame = this.framebak;\n            this.frames = this.framesBak;\n            this.dataProcessing();\n        },\n        frameUrl: function (name) {\n            if (!name) return;\n            return __imgPath + `avatar/images/${name}/${name}.svg`;\n        },\n        showAvatar: function (val) {\n            return showAvatar(val, 200 * 3);\n        },\n        setClass(item) {\n            if (item.decoration && item.receive) return \"receive\";\n            if (!item.isHave) return \"noHave\";\n            if (item.using) return \"select\";\n        },\n        updateAvatarFrame() {\n            updateAvatarFrame({ user_avatar_frame: this.frame }).then((res) => {\n                this.$message({\n                    message: \"头像框更新成功\",\n                    type: \"success\",\n                });\n                const params = this.frameList.map((item) => {\n                    return { val: item.name, using: item.using, type: \"avatar\" };\n                });\n                setDecoration(params);\n            });\n        },\n        receiveFrame(type) {\n            receive(this.uid, type).then((data) => {\n                this.$message({\n                    message: \"领取成功\",\n                    type: \"success\",\n                });\n                this.loadDecoration();\n            });\n        },\n        setAvatar(item) {\n            //如果receive则走领取\n            if (item.decoration && item.receive) {\n                //先走领取完事重载状态\n                this.receiveFrame(item.name);\n                return;\n            }\n            if (!item.isHave) return;\n            let list = this.frameList;\n            let find = list.find((e) => e.using == 1);\n            if (find) find.using = 0;\n            item.using == 1 ? (item.using = 0) : (item.using = 1);\n            this.frame = item.name;\n        },\n        load: function () {\n            getUserOverview(this.uid).then((res) => {\n                this.frame = res.data.data.user_avatar_frame || \"\";\n                this.framebak = res.data.data.user_avatar_frame || \"\";\n            });\n            getFrames().then((res) => {\n                this.frames = res.data;\n                this.framesBak = res.data;\n                this.loadDecoration();\n            });\n        },\n        loadDecoration() {\n            getDecoration().then((data) => {\n                let res = data.data.data;\n                let typeArr = [\"atcard\", \"homebg\", \"sidebar\", \"calendar\"];\n                let arr = res.filter((item) => item.type != \"\" && typeArr.indexOf(item.type) != -1);\n                this.decoration = this.formattingData(arr, \"val\");\n                this.avatars = res.filter((e) => e.type == \"avatar\");\n                this.dataProcessing();\n            });\n        },\n        formattingData(arr, group_key) {\n            let map = {};\n            arr.forEach((item, i) => {\n                if (!map[item[group_key]]) {\n                    map[item[group_key]] = [item];\n                } else {\n                    map[item[group_key]].push(item);\n                }\n            });\n            return map;\n        },\n        //装扮收集判断\n        decorationAather(key) {\n            let typeArr = [\"atcard\", \"homebg\", \"sidebar\", \"calendar\"];\n            let arr = this.decoration[key]?.filter((item) => item.type != \"\" && typeArr.indexOf(item.type) != -1);\n            if (arr?.length >= 4) return true;\n            return false;\n        },\n        dataProcessing() {\n            let avatars = this.avatars || [],\n                frames = this.frames,\n                firstRes = [{ desc: \"无边框\", name: \"\", val: \"\", isHave: 1, using: 1 }],\n                twoRes = [],\n                threeRes = [];\n            Object.keys(frames).forEach((key, i) => {\n                let item = { ...frames[key], ...{ isHave: 0, using: 0, receive: false } };\n                let find = avatars.find((e) => e.val == key);\n                if (find) {\n                    item.using = find.using;\n                    item.isHave = 1;\n                    if (item.using) {\n                        firstRes[0].using = 0;\n                    }\n                } else {\n                    if (item.decoration) {\n                        item.receive = this.decorationAather(item.name);\n                    }\n                }\n\n                if (item.isHave) {\n                    firstRes.push(item);\n                } else if (item.decoration) {\n                    twoRes.push(item);\n                } else {\n                    threeRes.push(item);\n                }\n            });\n            this.frameList = [...firstRes, ...twoRes, ...threeRes];\n        },\n    },\n    mounted: function () {\n        this.load();\n    },\n    components: {\n        uc,\n    },\n};\n</script>\n<style lang=\"less\">\n@import \"../assets/css/frame.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./frame.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./frame.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./frame.vue?vue&type=template&id=551a22ac\"\nimport script from \"./frame.vue?vue&type=script&lang=js\"\nexport * from \"./frame.vue?vue&type=script&lang=js\"\nimport style0 from \"./frame.vue?vue&type=style&index=0&id=551a22ac&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { $cms, $next } from \"@jx3box/jx3box-common/js/https.js\";\nimport axios from \"axios\";\nimport { __imgPath, __dataPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\nfunction getDecoration(params) {\n    return $cms().get(`/api/cms/user/decoration`, {\n        params,\n    });\n}\n\nfunction setDecoration(data) {\n    return $cms().post(`/api/cms/user/decoration`, data);\n}\n\nfunction getDecorationJson() {\n    let url = __imgPath + `decoration/index.json?${Date.now()}`;\n    return axios.get(url);\n}\n\nfunction getEmotion() {\n    return axios.get(`${__dataPath}emotion/output/catalog.json?${Date.now()}`);\n}\n\nfunction receive(user_id, val) {\n    return $cms().post(`/api/cms/user/decoration/check-suit/${user_id}/${val}/for/avatar`);\n}\n\nfunction updateAvatarFrame(data) {\n    return $cms().put(\"/api/cms/user/my/avatar-frame\", data);\n}\n\nfunction getHonor() {\n    // return axios.get(`${__imgPath}decoration/honor.json?${Date.now()}`);\n    return $cms().get(\"/api/cms/user/config/honor\");\n}\n\nfunction getUserHonors(uid) {\n    return $next({ mute: true })\n        .get(\"/api/next2/user/\" + uid + \"/honors\")\n        .then((res) => {\n            return res.data.data;\n        });\n}\nfunction setHonor(honor_id) {\n    return $cms().put(`/api/cms/user/honor/use/${honor_id}`);\n}\nfunction cancelHonor() {\n    return $cms().delete(`/api/cms/user/honor/use`);\n}\n\n// 获取用户勋章\nfunction getUserMedals(uid) {\n    return $next({ mute: true }).get(\"/api/next2/user/\" + uid + \"/medals\");\n}\n\n// 获取所有勋章\nfunction getMedals(params) {\n    return $cms().get(\"/api/cms/config/medal\", {params});\n}\nexport {\n    getDecoration,\n    setDecoration,\n    getDecorationJson,\n    getEmotion,\n    receive,\n    updateAvatarFrame,\n    getHonor,\n    getUserHonors,\n    setHonor,\n    cancelHonor,\n    getUserMedals,\n    getMedals,\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./frame.vue?vue&type=style&index=0&id=551a22ac&prod&lang=less\""],"sourceRoot":""}